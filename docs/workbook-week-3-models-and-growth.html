<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Appendix D Workbook Week 3: Models and Growth | Model Your World: Introduction to Modeling and Simulation</title>
  <meta name="description" content="A textbook companion to the Univeristy of Washington QSci 497 class" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Appendix D Workbook Week 3: Models and Growth | Model Your World: Introduction to Modeling and Simulation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A textbook companion to the Univeristy of Washington QSci 497 class" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Appendix D Workbook Week 3: Models and Growth | Model Your World: Introduction to Modeling and Simulation" />
  
  <meta name="twitter:description" content="A textbook companion to the Univeristy of Washington QSci 497 class" />
  

<meta name="author" content="Gaj Sivandran" />


<meta name="date" content="2025-10-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="workbook-week-2-llms.html"/>
<link rel="next" href="prob-workbook.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Q SCI 497</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#teaching-team-introductions-gaj-sivandran"><i class="fa fa-check"></i><b>1.1</b> Teaching Team Introductions Gaj Sivandran</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-highlights"><i class="fa fa-check"></i><b>1.2</b> Course Highlights</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#what-are-the-learning-outcomes"><i class="fa fa-check"></i><b>1.3</b> What are the learning outcomes</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#notes-and-textbooks"><i class="fa fa-check"></i><b>1.4</b> Notes and Textbooks</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#course-topics"><i class="fa fa-check"></i><b>1.5</b> Course Topics</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#classroom-etiquette"><i class="fa fa-check"></i><b>1.6</b> Classroom Etiquette</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#assessment"><i class="fa fa-check"></i><b>1.7</b> Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html"><i class="fa fa-check"></i><b>2</b> Week 1: What is Modeling?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#what-we-will-be-doing-this-week"><i class="fa fa-check"></i><b>2.1</b> What we will be doing this week</a></li>
<li class="chapter" data-level="2.2" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#learning-objectives"><i class="fa fa-check"></i><b>2.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.3" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#do-watch-listen-read-student-preparation-for-the-week"><i class="fa fa-check"></i><b>2.3</b> Do, Watch, Listen, Read: Student Preparation For The Week</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#download-and-install-rstudio"><i class="fa fa-check"></i><b>2.3.1</b> Download and Install RStudio</a></li>
<li class="chapter" data-level="2.3.2" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#do-this-tutorial"><i class="fa fa-check"></i><b>2.3.2</b> Do this tutorial</a></li>
<li class="chapter" data-level="2.3.3" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#min-read"><i class="fa fa-check"></i><b>2.3.3</b> 5min Read</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#lets-build-a-model-of-learning"><i class="fa fa-check"></i><b>2.4</b> Let’s Build a Model of Learning</a></li>
<li class="chapter" data-level="2.5" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#what-is-systems-thinking-and-simulation"><i class="fa fa-check"></i><b>2.5</b> What Is Systems Thinking and Simulation?</a></li>
<li class="chapter" data-level="2.6" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#abstractionand-why-is-it-so-hard"><i class="fa fa-check"></i><b>2.6</b> Abstraction—and Why Is It So Hard?</a></li>
<li class="chapter" data-level="2.7" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#the-problem-solving-process"><i class="fa fa-check"></i><b>2.7</b> The Problem-Solving Process</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#define-the-problem"><i class="fa fa-check"></i><b>2.7.1</b> Define the Problem</a></li>
<li class="chapter" data-level="2.7.2" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#simplify-and-abstract"><i class="fa fa-check"></i><b>2.7.2</b> Simplify and Abstract</a></li>
<li class="chapter" data-level="2.7.3" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#build-a-conceptual-or-mathematical-model"><i class="fa fa-check"></i><b>2.7.3</b> Build a Conceptual or Mathematical Model</a></li>
<li class="chapter" data-level="2.7.4" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#simulate-and-explore"><i class="fa fa-check"></i><b>2.7.4</b> Simulate and Explore</a></li>
<li class="chapter" data-level="2.7.5" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#evaluate-and-refine"><i class="fa fa-check"></i><b>2.7.5</b> Evaluate and Refine</a></li>
<li class="chapter" data-level="2.7.6" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#communicate"><i class="fa fa-check"></i><b>2.7.6</b> Communicate</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#intro-to-prompt-engineering"><i class="fa fa-check"></i><b>2.8</b> Intro to Prompt Engineering</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="week-1-what-is-modeling.html"><a href="week-1-what-is-modeling.html#why-this-matters"><i class="fa fa-check"></i><b>2.8.1</b> Why This Matters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html"><i class="fa fa-check"></i><b>3</b> Week 2: LLMs and Modeling Support</a>
<ul>
<li class="chapter" data-level="3.1" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#learning-goals"><i class="fa fa-check"></i><b>3.1</b> Learning Goals</a></li>
<li class="chapter" data-level="3.2" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#do-watch-listen-read-student-preparation-for-the-week-1"><i class="fa fa-check"></i><b>3.2</b> Do, Watch, Listen, Read: Student Preparation for the Week</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#do"><i class="fa fa-check"></i><b>3.2.1</b> Do</a></li>
<li class="chapter" data-level="3.2.2" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#watch-video-for-discussion"><i class="fa fa-check"></i><b>3.2.2</b> Watch: Video for Discussion</a></li>
<li class="chapter" data-level="3.2.3" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#read-reading-for-discussion"><i class="fa fa-check"></i><b>3.2.3</b> Read: Reading for Discussion</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#introduction-to-llms-in-modeling-mon"><i class="fa fa-check"></i><b>3.3</b> Introduction to LLMs in Modeling (Mon)</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#what-are-llms"><i class="fa fa-check"></i><b>3.3.1</b> What Are LLMs?</a></li>
<li class="chapter" data-level="3.3.2" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#a-brief-history"><i class="fa fa-check"></i><b>3.3.2</b> A Brief History</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#capabilities-and-limits-of-llms"><i class="fa fa-check"></i><b>3.4</b> Capabilities and Limits of LLMs</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#capabilities"><i class="fa fa-check"></i><b>3.4.1</b> Capabilities</a></li>
<li class="chapter" data-level="3.4.2" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#limits"><i class="fa fa-check"></i><b>3.4.2</b> Limits</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#llms-in-environmental-modeling-workflows"><i class="fa fa-check"></i><b>3.5</b> LLMs in Environmental Modeling Workflows</a></li>
<li class="chapter" data-level="3.6" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#prompt-engineering-for-model-development-tue-wed"><i class="fa fa-check"></i><b>3.6</b> Prompt Engineering for Model Development (Tue &amp; Wed)</a></li>
<li class="chapter" data-level="3.7" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#learning-goals-1"><i class="fa fa-check"></i><b>3.7</b> Learning goals</a></li>
<li class="chapter" data-level="3.8" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#principles-of-effective-prompts-clarity-context-constraints"><i class="fa fa-check"></i><b>3.8</b> Principles of effective prompts: clarity, context, constraints</a></li>
<li class="chapter" data-level="3.9" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#prompt-types-zero-shot-few-shot-role-based-with-modeling-examples"><i class="fa fa-check"></i><b>3.9</b> Prompt types: zero-shot, few-shot, role-based (with modeling examples)</a></li>
<li class="chapter" data-level="3.10" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#iterative-refinement-and-debugging-prompts-the-lei-loop"><i class="fa fa-check"></i><b>3.10</b> Iterative refinement and debugging prompts (the LEI loop)</a></li>
<li class="chapter" data-level="3.11" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#ade-prompt-library-activity"><i class="fa fa-check"></i><b>3.11</b> ADE Prompt Library &amp; Activity</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#what-youll-build-at-a-glance"><i class="fa fa-check"></i><b>3.11.1</b> What you’ll build (at a glance)</a></li>
<li class="chapter" data-level="3.11.2" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#spec-code"><i class="fa fa-check"></i><b>3.11.2</b> Spec → Code</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#critical-reflection-when-to-use-ai-tools"><i class="fa fa-check"></i><b>3.12</b> Critical Reflection: When to Use AI Tools</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#benefits"><i class="fa fa-check"></i><b>3.12.1</b> Benefits</a></li>
<li class="chapter" data-level="3.12.2" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#risks-and-limits"><i class="fa fa-check"></i><b>3.12.2</b> Risks and Limits</a></li>
<li class="chapter" data-level="3.12.3" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#guidelines-for-responsible-use-in-environmental-science"><i class="fa fa-check"></i><b>3.12.3</b> Guidelines for Responsible Use in Environmental Science</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#reproducibility-documentation-and-troubleshooting-fri"><i class="fa fa-check"></i><b>3.13</b> Reproducibility, Documentation, and Troubleshooting (Fri)</a></li>
<li class="chapter" data-level="3.14" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#first-model---ade"><i class="fa fa-check"></i><b>3.14</b> First Model - ADE</a>
<ul>
<li class="chapter" data-level="3.14.1" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#general-form"><i class="fa fa-check"></i><b>3.14.1</b> General Form</a></li>
<li class="chapter" data-level="3.14.2" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#term-by-term-meaning"><i class="fa fa-check"></i><b>3.14.2</b> Term-by-Term Meaning</a></li>
<li class="chapter" data-level="3.14.3" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#assumptions-behind-the-ade"><i class="fa fa-check"></i><b>3.14.3</b> Assumptions Behind the ADE</a></li>
<li class="chapter" data-level="3.14.4" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#applications-in-environmental-science"><i class="fa fa-check"></i><b>3.14.4</b> Applications in Environmental Science</a></li>
<li class="chapter" data-level="3.14.5" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#analytical-solutions"><i class="fa fa-check"></i><b>3.14.5</b> Analytical Solutions</a></li>
<li class="chapter" data-level="3.14.6" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#numerical-solutions"><i class="fa fa-check"></i><b>3.14.6</b> Numerical Solutions</a></li>
<li class="chapter" data-level="3.14.7" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#key-dimensionless-numbers"><i class="fa fa-check"></i><b>3.14.7</b> Key Dimensionless Numbers</a></li>
<li class="chapter" data-level="3.14.8" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#visualization-1"><i class="fa fa-check"></i><b>3.14.8</b> Visualization</a></li>
<li class="chapter" data-level="3.14.9" data-path="week-2-llms-and-modeling-support.html"><a href="week-2-llms-and-modeling-support.html#reflection-questions"><i class="fa fa-check"></i><b>3.14.9</b> Reflection Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html"><i class="fa fa-check"></i><b>4</b> Week 3: Mathematical Models – Parameters, Functions, and Growth</a>
<ul>
<li class="chapter" data-level="4.1" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#what-is-a-mathematical-model"><i class="fa fa-check"></i><b>4.1.1</b> What is a Mathematical Model?</a></li>
<li class="chapter" data-level="4.1.2" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#why-models-matter-in-environmental-science"><i class="fa fa-check"></i><b>4.1.2</b> Why Models Matter in Environmental Science</a></li>
<li class="chapter" data-level="4.1.3" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#the-balance-between-simplification-and-realism"><i class="fa fa-check"></i><b>4.1.3</b> The Balance Between Simplification and Realism</a></li>
<li class="chapter" data-level="4.1.4" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#example-population-growth"><i class="fa fa-check"></i><b>4.1.4</b> Example: Population Growth</a></li>
<li class="chapter" data-level="4.1.5" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#the-modeling-cycle"><i class="fa fa-check"></i><b>4.1.5</b> The Modeling Cycle</a></li>
<li class="chapter" data-level="4.1.6" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#choosing-the-right-level-of-detail"><i class="fa fa-check"></i><b>4.1.6</b> Choosing the Right Level of Detail</a></li>
<li class="chapter" data-level="4.1.7" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#summary"><i class="fa fa-check"></i><b>4.1.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#components-of-a-mathematical-model"><i class="fa fa-check"></i><b>4.2</b> Components of a Mathematical Model</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#variables"><i class="fa fa-check"></i><b>4.2.1</b> Variables</a></li>
<li class="chapter" data-level="4.2.2" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#parameters"><i class="fa fa-check"></i><b>4.2.2</b> Parameters</a></li>
<li class="chapter" data-level="4.2.3" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#functions"><i class="fa fa-check"></i><b>4.2.3</b> Functions</a></li>
<li class="chapter" data-level="4.2.4" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#initial-conditions"><i class="fa fa-check"></i><b>4.2.4</b> Initial Conditions</a></li>
<li class="chapter" data-level="4.2.5" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#boundary-conditions"><i class="fa fa-check"></i><b>4.2.5</b> Boundary Conditions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#types-of-mathematical-models"><i class="fa fa-check"></i><b>4.3</b> Types of Mathematical Models</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#conceptual-models"><i class="fa fa-check"></i><b>4.3.1</b> Conceptual Models</a></li>
<li class="chapter" data-level="4.3.2" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#empirical-models"><i class="fa fa-check"></i><b>4.3.2</b> Empirical Models</a></li>
<li class="chapter" data-level="4.3.3" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#mechanistic-models"><i class="fa fa-check"></i><b>4.3.3</b> Mechanistic Models</a></li>
<li class="chapter" data-level="4.3.4" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#physically-based-models"><i class="fa fa-check"></i><b>4.3.4</b> Physically Based Models</a></li>
<li class="chapter" data-level="4.3.5" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#statistically-based-models"><i class="fa fa-check"></i><b>4.3.5</b> Statistically Based Models</a></li>
<li class="chapter" data-level="4.3.6" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#hybrid-models"><i class="fa fa-check"></i><b>4.3.6</b> Hybrid Models</a></li>
<li class="chapter" data-level="4.3.7" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#probability-based-models"><i class="fa fa-check"></i><b>4.3.7</b> Probability-Based Models</a></li>
<li class="chapter" data-level="4.3.8" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#discrete-vs-continuous-models"><i class="fa fa-check"></i><b>4.3.8</b> Discrete vs Continuous Models</a></li>
<li class="chapter" data-level="4.3.9" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#summary-1"><i class="fa fa-check"></i><b>4.3.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#growth-models"><i class="fa fa-check"></i><b>4.4</b> Growth Models</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#linear-growth"><i class="fa fa-check"></i><b>4.4.1</b> Linear Growth</a></li>
<li class="chapter" data-level="4.4.2" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#exponential-growth"><i class="fa fa-check"></i><b>4.4.2</b> Exponential Growth</a></li>
<li class="chapter" data-level="4.4.3" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#logistic-growth"><i class="fa fa-check"></i><b>4.4.3</b> Logistic Growth</a></li>
<li class="chapter" data-level="4.4.4" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#decay-models"><i class="fa fa-check"></i><b>4.4.4</b> Decay Models</a></li>
<li class="chapter" data-level="4.4.5" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#piecewise-threshold-models"><i class="fa fa-check"></i><b>4.4.5</b> Piecewise / Threshold Models</a></li>
<li class="chapter" data-level="4.4.6" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#putting-it-all-together"><i class="fa fa-check"></i><b>4.4.6</b> Putting It All Together</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#parameters-in-growth-models"><i class="fa fa-check"></i><b>4.5</b> Parameters in Growth Models</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#the-role-of-parameters"><i class="fa fa-check"></i><b>4.5.1</b> The Role of Parameters</a></li>
<li class="chapter" data-level="4.5.2" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#sensitivity-analysis"><i class="fa fa-check"></i><b>4.5.2</b> Sensitivity Analysis</a></li>
<li class="chapter" data-level="4.5.3" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#visualization-with-parameter-sweeps"><i class="fa fa-check"></i><b>4.5.3</b> Visualization with Parameter Sweeps</a></li>
<li class="chapter" data-level="4.5.4" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#comparing-competing-species"><i class="fa fa-check"></i><b>4.5.4</b> Comparing Competing Species</a></li>
<li class="chapter" data-level="4.5.5" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#summary-2"><i class="fa fa-check"></i><b>4.5.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#fitting-models-to-data"><i class="fa fa-check"></i><b>4.6</b> Fitting Models to Data</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#from-observations-to-parameters"><i class="fa fa-check"></i><b>4.6.1</b> From Observations to Parameters</a></li>
<li class="chapter" data-level="4.6.2" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#methods-of-parameter-estimation"><i class="fa fa-check"></i><b>4.6.2</b> Methods of Parameter Estimation</a></li>
<li class="chapter" data-level="4.6.3" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#uncertainty-and-error"><i class="fa fa-check"></i><b>4.6.3</b> Uncertainty and Error</a></li>
<li class="chapter" data-level="4.6.4" data-path="week-3-mathematical-models-parameters-functions-and-growth.html"><a href="week-3-mathematical-models-parameters-functions-and-growth.html#summary-3"><i class="fa fa-check"></i><b>4.6.4</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><i class="fa fa-check"></i><b>5</b> Probabilistic Modeling: Embracing Uncertainty in Environmental Systems</a>
<ul>
<li class="chapter" data-level="5.1" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#introduction-why-probabilities-matter"><i class="fa fa-check"></i><b>5.1</b> Introduction: Why Probabilities Matter</a></li>
<li class="chapter" data-level="5.2" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#sources-of-uncertainty"><i class="fa fa-check"></i><b>5.2</b> Sources of Uncertainty</a></li>
<li class="chapter" data-level="5.3" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#primer-probability-pdfs-and-cdfs"><i class="fa fa-check"></i><b>5.3</b> Primer: Probability, PDFs, and CDFs</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#probability-basics"><i class="fa fa-check"></i><b>5.3.1</b> Probability Basics</a></li>
<li class="chapter" data-level="5.3.2" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#probability-density-function-pdf"><i class="fa fa-check"></i><b>5.3.2</b> Probability Density Function (PDF)</a></li>
<li class="chapter" data-level="5.3.3" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#cumulative-distribution-function-cdf"><i class="fa fa-check"></i><b>5.3.3</b> Cumulative Distribution Function (CDF)</a></li>
<li class="chapter" data-level="5.3.4" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#discrete-vs-continuous-distributions"><i class="fa fa-check"></i><b>5.3.4</b> Discrete vs Continuous Distributions</a></li>
<li class="chapter" data-level="5.3.5" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#moments-mean-variance-and-shape"><i class="fa fa-check"></i><b>5.3.5</b> Moments: Mean, Variance, and Shape</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#visualizing-probability-distributions"><i class="fa fa-check"></i><b>5.4</b> Visualizing Probability Distributions</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#normal-gaussian"><i class="fa fa-check"></i><b>5.4.1</b> Normal (Gaussian)</a></li>
<li class="chapter" data-level="5.4.2" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#lognormal"><i class="fa fa-check"></i><b>5.4.2</b> Lognormal</a></li>
<li class="chapter" data-level="5.4.3" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#gamma"><i class="fa fa-check"></i><b>5.4.3</b> Gamma</a></li>
<li class="chapter" data-level="5.4.4" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#exponential"><i class="fa fa-check"></i><b>5.4.4</b> Exponential</a></li>
<li class="chapter" data-level="5.4.5" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#weibull"><i class="fa fa-check"></i><b>5.4.5</b> Weibull</a></li>
<li class="chapter" data-level="5.4.6" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#poisson-discrete-counts"><i class="fa fa-check"></i><b>5.4.6</b> Poisson (Discrete Counts)</a></li>
<li class="chapter" data-level="5.4.7" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#gumbel-extreme-value-type-i-emphasizing-fat-tails"><i class="fa fa-check"></i><b>5.4.7</b> Gumbel (Extreme Value Type I): Emphasizing Fat Tails</a></li>
<li class="chapter" data-level="5.4.8" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#quick-guidance-on-when-to-use-which"><i class="fa fa-check"></i><b>5.4.8</b> Quick guidance on <strong>when to use which</strong></a></li>
<li class="chapter" data-level="5.4.9" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#from-probability-to-modeling"><i class="fa fa-check"></i><b>5.4.9</b> From Probability to Modeling</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#representing-uncertainty-with-probability-distributions"><i class="fa fa-check"></i><b>5.5</b> Representing Uncertainty with Probability Distributions</a></li>
<li class="chapter" data-level="5.6" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#deterministic-vs-stochastic-models"><i class="fa fa-check"></i><b>5.6</b> Deterministic vs Stochastic Models</a></li>
<li class="chapter" data-level="5.7" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#monte-carlo-simulation"><i class="fa fa-check"></i><b>5.7</b> Monte Carlo Simulation</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#how-it-works"><i class="fa fa-check"></i><b>5.7.1</b> <strong>How it works</strong></a></li>
<li class="chapter" data-level="5.7.2" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#example-simulating-casino-winnings"><i class="fa fa-check"></i><b>5.7.2</b> <strong>Example: Simulating Casino Winnings</strong></a></li>
<li class="chapter" data-level="5.7.3" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#monte-carlo-in-action"><i class="fa fa-check"></i><b>5.7.3</b> <strong>Monte Carlo in action</strong></a></li>
<li class="chapter" data-level="5.7.4" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#takeaway"><i class="fa fa-check"></i><b>5.7.4</b> <strong>Takeaway</strong></a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#markov-and-transition-models"><i class="fa fa-check"></i><b>5.8</b> Markov and Transition Models</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#core-pieces"><i class="fa fa-check"></i><b>5.8.1</b> <strong>Core Pieces</strong></a></li>
<li class="chapter" data-level="5.8.2" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#example-transition-matrix-annual"><i class="fa fa-check"></i><b>5.8.2</b> <strong>Example Transition Matrix (Annual)</strong></a></li>
<li class="chapter" data-level="5.8.3" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#from-whats-next-to-where-does-it-settle"><i class="fa fa-check"></i><b>5.8.3</b> <strong>From “What’s Next?” to “Where Does It Settle?”</strong></a></li>
<li class="chapter" data-level="5.8.4" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#reading-the-matrix-like-an-ecologist-or-planner"><i class="fa fa-check"></i><b>5.8.4</b> <strong>Reading the Matrix Like an Ecologist or Planner</strong></a></li>
<li class="chapter" data-level="5.8.5" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#special-structures"><i class="fa fa-check"></i><b>5.8.5</b> <strong>Special Structures</strong></a></li>
<li class="chapter" data-level="5.8.6" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#estimating-transition-matrices"><i class="fa fa-check"></i><b>5.8.6</b> <strong>Estimating Transition Matrices</strong></a></li>
<li class="chapter" data-level="5.8.7" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#what-markov-models-answer-well"><i class="fa fa-check"></i><b>5.8.7</b> <strong>What Markov Models Answer Well</strong></a></li>
<li class="chapter" data-level="5.8.8" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#environmental-applications"><i class="fa fa-check"></i><b>5.8.8</b> <strong>Environmental Applications</strong></a></li>
<li class="chapter" data-level="5.8.9" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#common-pitfalls-and-fixes"><i class="fa fa-check"></i><b>5.8.9</b> <strong>Common Pitfalls and Fixes</strong></a></li>
<li class="chapter" data-level="5.8.10" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#mini-worked-example"><i class="fa fa-check"></i><b>5.8.10</b> <strong>Mini Worked Example</strong></a></li>
<li class="chapter" data-level="5.8.11" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#key-takeaway"><i class="fa fa-check"></i><b>5.8.11</b> <strong>Key Takeaway</strong></a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#communicating-probabilistic-results"><i class="fa fa-check"></i><b>5.9</b> Communicating Probabilistic Results</a></li>
<li class="chapter" data-level="5.10" data-path="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html"><a href="probabilistic-modeling-embracing-uncertainty-in-environmental-systems.html#summary-and-reflection"><i class="fa fa-check"></i><b>5.10</b> Summary and Reflection</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="app-wk1.html"><a href="app-wk1.html"><i class="fa fa-check"></i><b>A</b> Project Week 1 – The ‘why’ and the ‘what’</a></li>
<li class="chapter" data-level="B" data-path="workbook-week-1-what-is-modeling.html"><a href="workbook-week-1-what-is-modeling.html"><i class="fa fa-check"></i><b>B</b> Workbook Week 1: What is Modeling?</a></li>
<li class="chapter" data-level="C" data-path="workbook-week-2-llms.html"><a href="workbook-week-2-llms.html"><i class="fa fa-check"></i><b>C</b> Workbook Week 2: LLMs</a>
<ul>
<li class="chapter" data-level="C.1" data-path="workbook-week-2-llms.html"><a href="workbook-week-2-llms.html#how-to-build-complixity-into-a-problem"><i class="fa fa-check"></i><b>C.1</b> How to Build Complixity into a Problem</a></li>
<li class="chapter" data-level="C.2" data-path="workbook-week-2-llms.html"><a href="workbook-week-2-llms.html#llms-and-modeling-support"><i class="fa fa-check"></i><b>C.2</b> LLMs and Modeling Support</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="workbook-week-2-llms.html"><a href="workbook-week-2-llms.html#learning-objectives-1"><i class="fa fa-check"></i><b>C.2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="C.2.2" data-path="workbook-week-2-llms.html"><a href="workbook-week-2-llms.html#coding-warmup"><i class="fa fa-check"></i><b>C.2.2</b> Coding warmup</a></li>
<li class="chapter" data-level="C.2.3" data-path="workbook-week-2-llms.html"><a href="workbook-week-2-llms.html#what-is-a-large-language-model"><i class="fa fa-check"></i><b>C.2.3</b> What is a Large Language Model</a></li>
<li class="chapter" data-level="C.2.4" data-path="workbook-week-2-llms.html"><a href="workbook-week-2-llms.html#pros-and-cons-of-high-parameter-models"><i class="fa fa-check"></i><b>C.2.4</b> Pros and Cons of High-Parameter Models</a></li>
<li class="chapter" data-level="C.2.5" data-path="workbook-week-2-llms.html"><a href="workbook-week-2-llms.html#parameters-in-large-language-models-llms"><i class="fa fa-check"></i><b>C.2.5</b> Parameters in Large Language Models (LLMs)</a></li>
<li class="chapter" data-level="C.2.6" data-path="workbook-week-2-llms.html"><a href="workbook-week-2-llms.html#capabilities-and-limits-of-llms-1"><i class="fa fa-check"></i><b>C.2.6</b> Capabilities and Limits of LLMs</a></li>
<li class="chapter" data-level="C.2.7" data-path="workbook-week-2-llms.html"><a href="workbook-week-2-llms.html#llms-in-environmental-modeling-workflows-1"><i class="fa fa-check"></i><b>C.2.7</b> LLMs in environmental modeling workflows</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="workbook-week-2-llms.html"><a href="workbook-week-2-llms.html#friday-discussion---ai-society-the-environment"><i class="fa fa-check"></i><b>C.3</b> Friday Discussion - AI, Society &amp; the Environment</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html"><i class="fa fa-check"></i><b>D</b> Workbook Week 3: Models and Growth</a>
<ul>
<li class="chapter" data-level="D.1" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#learning-goals-2"><i class="fa fa-check"></i><b>D.1</b> Learning Goals</a></li>
<li class="chapter" data-level="D.2" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#lab-building-your-own-population-model"><i class="fa fa-check"></i><b>D.2</b> Lab: Building Your Own Population Model</a>
<ul>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#overview"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#task-1-load-and-explore-the-data"><i class="fa fa-check"></i>Task 1 – Load and Explore the Data</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#task-2-build-a-conceptual-model"><i class="fa fa-check"></i>Task 2 – Build a Conceptual Model</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#task-3-start-simple-linear-growth-model"><i class="fa fa-check"></i>Task 3 – Start Simple: Linear Growth Model</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#task-4-extend-to-logistic-growth"><i class="fa fa-check"></i>Task 4 – Extend to Logistic Growth</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#task-5-fit-the-logistic-model"><i class="fa fa-check"></i>Task 5 – Fit the Logistic Model</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#task-6-introduce-harvesting"><i class="fa fa-check"></i>Task 6 – Introduce Harvesting</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#task-7-parameter-sensitivity-sweep-analysis"><i class="fa fa-check"></i>Task 7 – Parameter Sensitivity (Sweep Analysis)</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#task-8-adding-environmental-variability"><i class="fa fa-check"></i>Task 8 – Adding Environmental Variability</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#readme-interactive-linear-fit-cod-population-shiny"><i class="fa fa-check"></i><b>D.3</b> Readme: Interactive Linear Fit — Cod Population (Shiny)</a>
<ul>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#what-this-app-does"><i class="fa fa-check"></i>What this app does</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#why-this-is-useful"><i class="fa fa-check"></i>Why this is useful</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#requirements"><i class="fa fa-check"></i>Requirements</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#file-structure"><i class="fa fa-check"></i>File structure</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#expected-csv-schema"><i class="fa fa-check"></i>Expected CSV schema</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#how-to-run"><i class="fa fa-check"></i>How to run</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#app-controls-outputs"><i class="fa fa-check"></i>App controls &amp; outputs</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#under-the-hood-key-functions"><i class="fa fa-check"></i>Under the hood (key functions)</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#customization-tips"><i class="fa fa-check"></i>Customization tips</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#troubleshooting"><i class="fa fa-check"></i>Troubleshooting</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#source-code"><i class="fa fa-check"></i>Source Code</a></li>
</ul></li>
<li class="chapter" data-level="D.4" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#readme-interactive-logistic-fit-cod-population-shiny"><i class="fa fa-check"></i><b>D.4</b> Readme: Interactive Logistic Fit — Cod Population (Shiny)</a>
<ul>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#what-this-app-does-1"><i class="fa fa-check"></i>What this app does</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#why-this-is-useful-1"><i class="fa fa-check"></i>Why this is useful</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#requirements-1"><i class="fa fa-check"></i>Requirements</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#file-structure-1"><i class="fa fa-check"></i>File structure</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#expected-csv-schema-1"><i class="fa fa-check"></i>Expected CSV schema</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#how-to-run-1"><i class="fa fa-check"></i>How to run</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#app-controls-outputs-1"><i class="fa fa-check"></i>App controls &amp; outputs</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#under-the-hood-key-functions-1"><i class="fa fa-check"></i>Under the hood (key functions)</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#customization-tips-1"><i class="fa fa-check"></i>Customization tips</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#troubleshooting-1"><i class="fa fa-check"></i>Troubleshooting</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#source-code-1"><i class="fa fa-check"></i>Source Code</a></li>
</ul></li>
<li class="chapter" data-level="D.5" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#readme-logistic-growth-with-constant-harvesting-delayed-start-cod-population-shiny"><i class="fa fa-check"></i><b>D.5</b> Readme: Logistic Growth with Constant Harvesting &amp; Delayed Start — Cod Population (Shiny)</a>
<ul>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#what-this-app-does-2"><i class="fa fa-check"></i>What this app does</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#why-this-is-useful-2"><i class="fa fa-check"></i>Why this is useful</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#requirements-2"><i class="fa fa-check"></i>Requirements</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#file-structure-2"><i class="fa fa-check"></i>File structure</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#expected-csv-schema-2"><i class="fa fa-check"></i>Expected CSV schema</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#how-to-run-2"><i class="fa fa-check"></i>How to run</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#app-controls-outputs-2"><i class="fa fa-check"></i>App controls &amp; outputs</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#under-the-hood-key-functions-2"><i class="fa fa-check"></i>Under the hood (key functions)</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#customization-tips-2"><i class="fa fa-check"></i>Customization tips</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#troubleshooting-2"><i class="fa fa-check"></i>Troubleshooting</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#source-code-2"><i class="fa fa-check"></i>Source Code</a></li>
</ul></li>
<li class="chapter" data-level="D.6" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#readme-logistic-with-harvesting-stochastic-bad-year-shocks-cod-population-shiny"><i class="fa fa-check"></i><b>D.6</b> Readme: Logistic with Harvesting &amp; Stochastic Bad-Year Shocks — Cod Population (Shiny)</a>
<ul>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#what-this-app-does-3"><i class="fa fa-check"></i>What this app does</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#why-this-is-useful-3"><i class="fa fa-check"></i>Why this is useful</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#requirements-3"><i class="fa fa-check"></i>Requirements</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#file-structure-3"><i class="fa fa-check"></i>File structure</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#expected-csv-schema-3"><i class="fa fa-check"></i>Expected CSV schema</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#how-to-run-3"><i class="fa fa-check"></i>How to run</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#app-controls-outputs-3"><i class="fa fa-check"></i>App controls &amp; outputs</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#under-the-hood-key-functions-3"><i class="fa fa-check"></i>Under the hood (key functions)</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#customization-tips-3"><i class="fa fa-check"></i>Customization tips</a></li>
<li class="chapter" data-level="" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#troubleshooting-3"><i class="fa fa-check"></i>Troubleshooting</a></li>
<li class="chapter" data-level="D.6.1" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#source-code-3"><i class="fa fa-check"></i><b>D.6.1</b> Source Code</a></li>
</ul></li>
<li class="chapter" data-level="D.7" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#understanding-the-central-limit-theorem"><i class="fa fa-check"></i><b>D.7</b> Understanding the Central Limit Theorem</a>
<ul>
<li class="chapter" data-level="D.7.1" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#why-we-care"><i class="fa fa-check"></i><b>D.7.1</b> Why We Care</a></li>
<li class="chapter" data-level="D.7.2" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#start-with-a-simple-example"><i class="fa fa-check"></i><b>D.7.2</b> Start with a Simple Example</a></li>
<li class="chapter" data-level="D.7.3" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#the-central-limit-theorem-plain-language-version"><i class="fa fa-check"></i><b>D.7.3</b> The Central Limit Theorem (Plain-Language Version)</a></li>
<li class="chapter" data-level="D.7.4" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#why-it-happens"><i class="fa fa-check"></i><b>D.7.4</b> Why It Happens</a></li>
<li class="chapter" data-level="D.7.5" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#what-you-saw-in-the-app"><i class="fa fa-check"></i><b>D.7.5</b> What You Saw in the App</a></li>
<li class="chapter" data-level="D.7.6" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#real-world-meaning"><i class="fa fa-check"></i><b>D.7.6</b> Real-World Meaning</a></li>
<li class="chapter" data-level="D.7.7" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#key-takeaways"><i class="fa fa-check"></i><b>D.7.7</b> Key Takeaways</a></li>
<li class="chapter" data-level="D.7.8" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#quick-reflection"><i class="fa fa-check"></i><b>D.7.8</b> Quick Reflection</a></li>
<li class="chapter" data-level="D.7.9" data-path="workbook-week-3-models-and-growth.html"><a href="workbook-week-3-models-and-growth.html#in-a-sentence"><i class="fa fa-check"></i><b>D.7.9</b> 🧠 In a Sentence</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="E" data-path="prob-workbook.html"><a href="prob-workbook.html"><i class="fa fa-check"></i><b>E</b> Prob Workbook</a>
<ul>
<li class="chapter" data-level="E.1" data-path="prob-workbook.html"><a href="prob-workbook.html#learning-goals-3"><i class="fa fa-check"></i><b>E.1</b> Learning Goals</a></li>
<li class="chapter" data-level="E.2" data-path="prob-workbook.html"><a href="prob-workbook.html#run-the-tree-height-demo-app"><i class="fa fa-check"></i><b>E.2</b> Run the Tree Height Demo App</a></li>
<li class="chapter" data-level="E.3" data-path="prob-workbook.html"><a href="prob-workbook.html#lab-3-exploring-noaa-climate-data"><i class="fa fa-check"></i><b>E.3</b> Lab 3: Exploring NOAA Climate Data</a>
<ul>
<li class="chapter" data-level="" data-path="prob-workbook.html"><a href="prob-workbook.html#step-1-download-data"><i class="fa fa-check"></i>Step 1: Download Data</a></li>
<li class="chapter" data-level="" data-path="prob-workbook.html"><a href="prob-workbook.html#step-2-read-the-documentation"><i class="fa fa-check"></i>Step 2: Read the Documentation</a></li>
<li class="chapter" data-level="" data-path="prob-workbook.html"><a href="prob-workbook.html#step-3-raw-data-exploration---daily"><i class="fa fa-check"></i>Step 3: Raw data exploration - Daily</a></li>
<li class="chapter" data-level="" data-path="prob-workbook.html"><a href="prob-workbook.html#step-4-raw-data-exploration---annual"><i class="fa fa-check"></i>Step 4: Raw data exploration - Annual</a></li>
<li class="chapter" data-level="" data-path="prob-workbook.html"><a href="prob-workbook.html#step-5-raw-data-exploration---monthly"><i class="fa fa-check"></i>Step 5: Raw data exploration - Monthly</a></li>
<li class="chapter" data-level="" data-path="prob-workbook.html"><a href="prob-workbook.html#step-6-conceptual-modelling-of-rainfall"><i class="fa fa-check"></i>Step 6: Conceptual Modelling of Rainfall</a></li>
</ul></li>
<li class="chapter" data-level="E.4" data-path="prob-workbook.html"><a href="prob-workbook.html#lab-4-guided-activity-exploring-rainfall-variability-and-simulation"><i class="fa fa-check"></i><b>E.4</b> Lab 4: 🌧️ Guided Activity: Exploring Rainfall Variability and Simulation</a>
<ul>
<li class="chapter" data-level="E.4.1" data-path="prob-workbook.html"><a href="prob-workbook.html#exploring-the-data"><i class="fa fa-check"></i><b>E.4.1</b> Exploring the Data</a></li>
<li class="chapter" data-level="" data-path="prob-workbook.html"><a href="prob-workbook.html#fitting-statistical-distributions"><i class="fa fa-check"></i>Fitting Statistical Distributions</a></li>
<li class="chapter" data-level="" data-path="prob-workbook.html"><a href="prob-workbook.html#simulation-and-model-evaluation"><i class="fa fa-check"></i>Simulation and Model Evaluation</a></li>
<li class="chapter" data-level="" data-path="prob-workbook.html"><a href="prob-workbook.html#optional-extensions-for-advanced-exploration"><i class="fa fa-check"></i>Optional Extensions (for advanced exploration)</a></li>
<li class="chapter" data-level="" data-path="prob-workbook.html"><a href="prob-workbook.html#wrap-up-reflection"><i class="fa fa-check"></i>Wrap-Up Reflection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html"><i class="fa fa-check"></i><b>F</b> Tutorial: Getting Started with RStudio</a>
<ul>
<li class="chapter" data-level="F.1" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#what-is-rstudio"><i class="fa fa-check"></i><b>F.1</b> What is RStudio?</a></li>
<li class="chapter" data-level="F.2" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#the-rstudio-interface"><i class="fa fa-check"></i><b>F.2</b> The RStudio Interface</a></li>
<li class="chapter" data-level="F.3" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#running-code"><i class="fa fa-check"></i><b>F.3</b> Running Code</a></li>
<li class="chapter" data-level="F.4" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#projects-in-rstudio"><i class="fa fa-check"></i><b>F.4</b> Projects in RStudio</a></li>
<li class="chapter" data-level="F.5" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#working-with-packages"><i class="fa fa-check"></i><b>F.5</b> Working with Packages</a></li>
<li class="chapter" data-level="F.6" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#writing-and-saving-scripts"><i class="fa fa-check"></i><b>F.6</b> Writing and Saving Scripts</a>
<ul>
<li class="chapter" data-level="F.6.1" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#r-scripts-.r-files"><i class="fa fa-check"></i><b>F.6.1</b> R Scripts (<code>.R</code> files)</a></li>
<li class="chapter" data-level="F.6.2" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#rmarkdown-.rmd-files"><i class="fa fa-check"></i><b>F.6.2</b> RMarkdown (<code>.Rmd</code> files)</a></li>
</ul></li>
<li class="chapter" data-level="F.7" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#plotting-example"><i class="fa fa-check"></i><b>F.7</b> Plotting Example</a>
<ul>
<li class="chapter" data-level="F.7.1" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#example-1-simple-scatter-plot"><i class="fa fa-check"></i><b>F.7.1</b> Example 1: Simple Scatter Plot</a></li>
<li class="chapter" data-level="F.7.2" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#example-2-using-a-built-in-dataset-cars"><i class="fa fa-check"></i><b>F.7.2</b> Example 2: Using a Built-In Dataset (<code>cars</code>)</a></li>
<li class="chapter" data-level="F.7.3" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#example-3-adding-a-trend-line"><i class="fa fa-check"></i><b>F.7.3</b> Example 3: Adding a Trend Line</a></li>
</ul></li>
<li class="chapter" data-level="F.8" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#data-visualization-tutorial"><i class="fa fa-check"></i><b>F.8</b> Data Visualization Tutorial</a></li>
<li class="chapter" data-level="F.9" data-path="tutorial-getting-started-with-rstudio.html"><a href="tutorial-getting-started-with-rstudio.html#prompting-and-building-a-complex-simulation-model---roulette"><i class="fa fa-check"></i><b>F.9</b> Prompting and Building a Complex Simulation Model - Roulette</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Your World: Introduction to Modeling and Simulation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="workbook-week-3-models-and-growth" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Appendix D</span> Workbook Week 3: Models and Growth<a href="workbook-week-3-models-and-growth.html#workbook-week-3-models-and-growth" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-2" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">D.1</span> Learning Goals<a href="workbook-week-3-models-and-growth.html#learning-goals-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, you’ll build both <strong>conceptual understanding</strong> and <strong>practical modeling skills</strong>.<br />
By the end, you should be able to:</p>
<ol style="list-style-type: decimal">
<li><strong>Explain the structure of a mathematical model</strong>
<ul>
<li>Identify <strong>variables</strong>, <strong>parameters</strong>, <strong>functions</strong>, <strong>initial conditions</strong>, and <strong>boundary conditions</strong> in an environmental system.</li>
</ul></li>
<li><strong>Construct a conceptual model</strong>
<ul>
<li>Create a <strong>diagram or influence map</strong> showing the main components and feedbacks in a system (e.g., a fishery, carbon cycle, or pollutant pathway).<br />
</li>
<li>Translate that conceptual model into a quantitative form—an equation or simulation—that captures its essential dynamics.</li>
</ul></li>
<li><strong>Simulate system behavior</strong>
<ul>
<li>Work directly with a provided R model (linear, exponential, or logistic) to explore how changes in parameters such as the growth rate (<span class="math inline">\(r\)</span>) or carrying capacity (<span class="math inline">\(K\)</span>) affect system outcomes.</li>
</ul></li>
<li><strong>Fit models to data</strong>
<ul>
<li>Use observational data (e.g., cod fishery population time series) to estimate parameters, visualize model fits, and interpret model accuracy (RMSE, residuals).</li>
</ul></li>
<li><strong>Interpret model parameters ecologically</strong>
<ul>
<li>Describe what each parameter represents in real terms—e.g., how <span class="math inline">\(r\)</span> relates to reproduction or how <span class="math inline">\(K\)</span> reflects habitat limits.</li>
</ul></li>
<li><strong>Explore uncertainty and sensitivity</strong>
<ul>
<li>Conduct <strong>parameter sweeps</strong> and “what-if” simulations to see which assumptions most influence model predictions.</li>
</ul></li>
<li><strong>Evaluate models as decision tools</strong>
<ul>
<li>Use the logistic-harvest model to test management scenarios (e.g., sustainable vs. overharvest conditions).<br />
</li>
<li>Discuss the implications of stochasticity (“bad years”) for population resilience.</li>
</ul></li>
<li><strong>Reflect on the modeling process</strong>
<ul>
<li>Compare your conceptual model with the mathematical one and explain what each form helps you understand.<br />
</li>
<li>Articulate how model simplicity versus realism affects insight and decision-making.</li>
</ul></li>
</ol>
<hr />
<blockquote>
<p>💡 <strong>Purpose of this section:</strong><br />
You’ll not only learn how to <em>fit and simulate models</em>, but also how to <em>think like a modeler</em>—starting from a conceptual diagram of a system, translating it into equations, running simulations, and interpreting what the results tell us about environmental processes and management trade-offs.</p>
</blockquote>
<div class="promptbox">
<p><strong>Working Definitions</strong></p>
<p>In your own words define the following</p>
<ul>
<li><p>Variable
<br><br><br><br></p></li>
<li><p>Parameter
<br><br><br><br></p></li>
<li><p>Function
<br><br><br><br></p></li>
<li><p>Initial Condition
<br><br><br><br></p></li>
<li><p>Boundary Condition
<br><br><br><br></p></li>
</ul>
</div>
<div class="promptbox">
<p><strong>Activity: Build a Conceptual Model — “Water Levels in Lake Washington”</strong></p>
<p><strong>🎯 Purpose</strong>: To practice thinking like a modeler by building a <strong>conceptual model</strong> of water balance in Lake Washington. You’ll identify the main <strong>inputs</strong>, <strong>outputs</strong>, <strong>controls</strong>, and <strong>feedbacks</strong> that determine how lake levels rise and fall — just as we do in environmental modeling.</p>
<hr />
<p><strong>🌊 Background</strong>: Lake Washington’s water level is managed through the <strong>Hiram M. Chittenden (Ballard) Locks</strong>, which connect the lake to Puget Sound. Its level fluctuates with <strong>precipitation</strong>, <strong>river inflow</strong>, <strong>groundwater exchange</strong>, <strong>evaporation</strong>, and <strong>controlled outflow</strong> to the Locks. In summer, levels are lowered to protect dock structures and fish migration; in winter, levels rise naturally with rainfall. In short — Lake Washington is a dynamic system influenced by <strong>climate, management, and human use</strong>.</p>
<hr />
<p><strong>🧠 Part 1: Brainstorm the System</strong>: In small groups, sketch a <strong>conceptual model</strong> (boxes and arrows) of Lake Washington’s water balance.</p>
<ul>
<li><p><strong>Stocks (state variables):</strong><br />
<br><br><br><br><br></p></li>
<li><p><strong>Inflows:</strong><br />
<br><br><br><br><br></p></li>
<li><p><strong>Outflows:</strong><br />
<br><br><br><br><br></p></li>
<li><p><strong>Drivers and Controls:</strong><br />
<br><br><br><br><br></p></li>
</ul>
<hr />
<p><strong>🔄 Part 2: Identify Feedbacks</strong></p>
<ul>
<li><p><strong>Positive feedbacks</strong> (reinforcing):<br />
<br><br><br><br><br></p></li>
<li><p><strong>Negative feedbacks</strong> (stabilizing):<br />
<br><br><br><br><br></p></li>
</ul>
<p>Label feedbacks with (+) or (–) arrows in your diagram.</p>
<hr />
<p><strong>🧩 Part 3: Translate to a Quantitative Model </strong></p>
<p>Now imagine you had to model lake level <span class="math inline">\(L(t)\)</span> mathematically.</p>
<ul>
<li>Try an write a <strong>functional relationship</strong> for the system.</li>
<li>Identify your output variable and its relation to the input variables</li>
</ul>
<hr />
<p><strong>💬 Part 4: Reflect</strong><br />
</p>
<p>Discuss as a group:</p>
<ol style="list-style-type: decimal">
<li>Which factors are <strong>natural</strong> and which are <strong>human-controlled</strong>?<br />
</li>
<li>How might <strong>climate change</strong> affect this system?<br />
</li>
<li>How could your conceptual model inform <strong>management decisions</strong> about flood control, salmon passage, or recreation?<br />
</li>
<li>If you were to create a simulation model of this system - what kind of model category would it fall into?</li>
<li>If you were to simulate this system in R, what assumptions would you need to make?
<br><br><br><br><br><br><br><br><br><br></li>
</ol>
<hr />
<blockquote>
<p>💡 <strong>Takeaway:</strong><br />
Conceptual models help simplify complex systems like Lake Washington into a few key relationships.<br />
Before we ever write an equation or a line of code, conceptual modeling helps us clarify what processes matter — and how they interact.</p>
</blockquote>
</div>
<div class="promptbox">
<p><strong>Introduction to Curve Fitting</strong></p>
<p>In science and engineering, we often collect data that show a clear trend — but rarely follow a perfect mathematical formula. <strong>Curve fitting</strong> is the process of finding a mathematical function that best describes the relationship between variables in a dataset.</p>
<p>By fitting a curve, we can:</p>
<ul>
<li><strong>Summarize</strong> complex data with a simple equation.<br />
</li>
<li><strong>Estimate</strong> values between or beyond measured points (interpolation and extrapolation).<br />
</li>
<li><strong>Compare</strong> theoretical models to real-world observations.<br />
</li>
<li><strong>Identify</strong> patterns that reveal underlying processes — for example, exponential population growth, logistic saturation, or seasonal oscillations.</li>
</ul>
<p>Curve fitting bridges the gap between data and models. It allows us to test hypotheses (“Does this population follow logistic growth?”), estimate parameters (like growth rate or carrying capacity), and assess how well our chosen model represents reality.<br />
<strong>How Fitting Is Achieved</strong></p>
<p>Curve fitting involves adjusting the parameters of a chosen mathematical model so that it best matches the observed data. The goal is to minimize the <strong>difference</strong> between the model’s predicted values and the actual data points — these differences are called <strong>residuals</strong>.</p>
<p>The most common method is <strong>least squares fitting</strong>, which minimizes the sum of the squared residuals. For a dataset with observed values <span class="math inline">\(y_i\)</span> and model predictions <span class="math inline">\(\hat{y}_i\)</span>, the <strong>sum of squared errors (SSE)</strong> is:</p>
<p><span class="math display">\[
SSE = \sum_{i=1}^{n} (y_i - \hat{y}_i)^2
\]</span></p>
<p>The fitting process adjusts model parameters (such as slope, intercept, or growth rate) to make this SSE as small as possible.</p>
<p>A related measure is the <strong>Root Mean Square Error (RMSE)</strong>, which provides an interpretable measure of average error in the same units as the data:</p>
<p><span class="math display">\[
RMSE = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2}
\]</span></p>
<p>While the least squares method minimizes the total squared error, the RMSE summarizes how far, on average, the predictions are from the observed data. Lower RMSE values indicate a better fit.</p>
<p>In practice, curve fitting tools in R, Python, or MATLAB use numerical optimization algorithms to minimize SSE or RMSE automatically, allowing us to identify the parameters that best describe the observed trend.</p>
</div>
<div class="promptbox">
<p><strong>Curve Fitting Example - CO2</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="workbook-week-3-models-and-growth.html#cb1-1" tabindex="-1"></a><span class="co"># Load data, skipping metadata lines that start with &#39;#&#39;</span></span>
<span id="cb1-2"><a href="workbook-week-3-models-and-growth.html#cb1-2" tabindex="-1"></a>co2_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;Models/data/co2_data.txt&quot;</span>,</span>
<span id="cb1-3"><a href="workbook-week-3-models-and-growth.html#cb1-3" tabindex="-1"></a>                       <span class="at">header =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-4"><a href="workbook-week-3-models-and-growth.html#cb1-4" tabindex="-1"></a>                       <span class="at">comment.char =</span> <span class="st">&quot;#&quot;</span>,</span>
<span id="cb1-5"><a href="workbook-week-3-models-and-growth.html#cb1-5" tabindex="-1"></a>                       <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;DecimalDate&quot;</span>, </span>
<span id="cb1-6"><a href="workbook-week-3-models-and-growth.html#cb1-6" tabindex="-1"></a>                                     <span class="st">&quot;CO2_Monthly&quot;</span>, <span class="st">&quot;CO2_Deseason&quot;</span>, </span>
<span id="cb1-7"><a href="workbook-week-3-models-and-growth.html#cb1-7" tabindex="-1"></a>                                     <span class="st">&quot;NumDays&quot;</span>, <span class="st">&quot;StdDev&quot;</span>, <span class="st">&quot;Uncertainty&quot;</span>))</span>
<span id="cb1-8"><a href="workbook-week-3-models-and-growth.html#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="workbook-week-3-models-and-growth.html#cb1-9" tabindex="-1"></a><span class="co"># Check the first few rows</span></span>
<span id="cb1-10"><a href="workbook-week-3-models-and-growth.html#cb1-10" tabindex="-1"></a><span class="fu">head</span>(co2_data)</span></code></pre></div>
<pre><code>##   Year Month DecimalDate CO2_Monthly CO2_Deseason NumDays StdDev Uncertainty
## 1 1958     3    1958.203      315.71       314.44      -1  -9.99       -0.99
## 2 1958     4    1958.288      317.45       315.16      -1  -9.99       -0.99
## 3 1958     5    1958.370      317.51       314.69      -1  -9.99       -0.99
## 4 1958     6    1958.455      317.27       315.15      -1  -9.99       -0.99
## 5 1958     7    1958.537      315.87       315.20      -1  -9.99       -0.99
## 6 1958     8    1958.622      314.93       316.21      -1  -9.99       -0.99</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="workbook-week-3-models-and-growth.html#cb3-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="workbook-week-3-models-and-growth.html#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="workbook-week-3-models-and-growth.html#cb3-3" tabindex="-1"></a><span class="fu">ggplot</span>(co2_data, <span class="fu">aes</span>(<span class="at">x =</span> DecimalDate, <span class="at">y =</span> CO2_Monthly)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="workbook-week-3-models-and-growth.html#cb3-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="workbook-week-3-models-and-growth.html#cb3-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mauna Loa C02 Record&quot;</span>,</span>
<span id="cb3-6"><a href="workbook-week-3-models-and-growth.html#cb3-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb3-7"><a href="workbook-week-3-models-and-growth.html#cb3-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="st">&quot;CO&quot;</span>[<span class="dv">2</span>]<span class="sc">*</span><span class="st">&quot; concentration (ppm)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb3-8"><a href="workbook-week-3-models-and-growth.html#cb3-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div class="promptbox">
<p><strong>Fit a linear model By Eye</strong></p>
<ul>
<li>Open and run curve_fit_co2_1.R</li>
<li>Try to fit a trend line?</li>
<li>What would make this task easier?
<br><br><br><br><br><br><br></li>
</ul>
</div>
<div class="promptbox">
<p><strong>Fit a linear model By Eye Using Residuals</strong></p>
<ul>
<li>Open and run curve_fit_co2_2.R</li>
<li>How do the residuals help?</li>
<li>What are you aiming for?
<br><br><br><br><br><br><br></li>
</ul>
</div>
<div class="promptbox">
<p><strong>Fit a linear model to a Subset of the Data</strong></p>
<ul>
<li>Open and run curve_fit_co2_3.R</li>
<li>This app includes a magic butting that fits the parameters for you.</li>
<li>Play around, see if you can fit a line to the last 10 years</li>
<li>What is happening to the residuals?</li>
<li>Ideas on how to fix this?</li>
</ul>
<p><br><br><br><br><br><br><br></p>
</div>
<div class="promptbox">
<p><strong>Fit an exponential model to a Subset of the Data</strong></p>
<ul>
<li>Open and run curve_fit_co2_4.R</li>
<li>Play around, see if you can fit a model to the last 10 years</li>
<li>What is happening to the residuals?</li>
<li>Ideas on how to fix this?</li>
</ul>
<p><br><br><br><br><br><br><br></p>
</div>
<div class="promptbox">
<p><strong>Fit an complex model</strong></p>
<ul>
<li>Open and run curve_fit_co2_5.R</li>
</ul>
<p>We’ve been layering complexity onto this model</p>
<p>Adding a sinusoid is a modeling trick - given the residuals have a sinusoidal shape, that gives us a hint that whatever we are ‘missing’ in our model could be represented as a sinusoid.</p>
<p>Play around
<br><br><br><br><br><br><br></p>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/t0dXjmoA0dw?si=UI1L7pU5iHEP6tqJ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
</iframe>
</div>
<div id="lab-building-your-own-population-model" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">D.2</span> Lab: Building Your Own Population Model<a href="workbook-week-3-models-and-growth.html#lab-building-your-own-population-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="overview" class="section level3 unnumbered hasAnchor">
<h3>Overview<a href="workbook-week-3-models-and-growth.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this lab, you will build, test, and refine population models using real or simulated ecological data.<br />
By the end, you should be able to:</p>
<ul>
<li>Load and visualize population data<br />
</li>
<li>Construct a conceptual model of population dynamics<br />
</li>
<li>Fit and compare different population growth models<br />
</li>
<li>Interpret model parameters in ecological terms<br />
</li>
<li>Extend models to include harvesting and environmental variability</li>
</ul>
<hr />
</div>
<div id="task-1-load-and-explore-the-data" class="section level3 unnumbered hasAnchor">
<h3>Task 1 – Load and Explore the Data<a href="workbook-week-3-models-and-growth.html#task-1-load-and-explore-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load the dataset into R and create a simple plot to visualize the population through time.<br />
Look for general patterns (growth, plateaus, declines, disturbances) and write down your observations.</p>
<div class="promptbox">
<p><strong>Reflection:</strong><br />
What trends do you see?</p>
<p><br><br><br><br><br><br><br><br><br><br><br></p>
</div>
<hr />
</div>
<div id="task-2-build-a-conceptual-model" class="section level3 unnumbered hasAnchor">
<h3>Task 2 – Build a Conceptual Model<a href="workbook-week-3-models-and-growth.html#task-2-build-a-conceptual-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Draw a <strong>conceptual diagram</strong> (no equations yet).<br />
Use boxes for key variables and arrows for relationships or feedbacks.</p>
<div class="promptbox">
<p><strong>Reflection:</strong></p>
<ul>
<li>What controls population growth?<br />
</li>
<li>What limits it?<br />
</li>
<li>What external factors could influence it?</li>
</ul>
<p><br><br><br><br><br><br><br><br><br><br><br></p>
</div>
<hr />
</div>
<div id="task-3-start-simple-linear-growth-model" class="section level3 unnumbered hasAnchor">
<h3>Task 3 – Start Simple: Linear Growth Model<a href="workbook-week-3-models-and-growth.html#task-3-start-simple-linear-growth-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write <strong>pseudo code</strong> to fit a <em>linear growth model</em> to the data.<br />
Use a <strong>stepwise prompting strategy</strong> — begin with a basic line, then add complexity:</p>
<ol style="list-style-type: decimal">
<li>Add interactive sliders to adjust parameters.<br />
</li>
<li>Add diagnostic metrics (e.g., RMSE) to assess fit quality.<br />
</li>
<li>Allow model fitting to subsets of the data.</li>
</ol>
<div class="promptbox">
<p><strong>Reflection:</strong></p>
<ul>
<li>Why start with a linear model?<br />
</li>
<li>Are there time periods where the population appears roughly linear?<br />
</li>
<li>What questions could you answer with a linear model?</li>
</ul>
<p><br><br><br><br><br><br><br><br><br><br><br></p>
</div>
<hr />
</div>
<div id="task-4-extend-to-logistic-growth" class="section level3 unnumbered hasAnchor">
<h3>Task 4 – Extend to Logistic Growth<a href="workbook-week-3-models-and-growth.html#task-4-extend-to-logistic-growth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Replace the linear model with a <strong>logistic model</strong>:</p>
<p><span class="math display">\[
P(t) = \frac{K}{1 + A e^{-r t}}
\]</span></p>
<p>Before coding, analyze this function <strong>analytically</strong>:</p>
<ul>
<li>What happens as each parameter (<span class="math inline">\(A\)</span>, <span class="math inline">\(K\)</span>, <span class="math inline">\(r\)</span>) becomes small, large, or negative?<br />
</li>
<li>What are reasonable ecological constraints on these parameters?<br />
</li>
<li>What does each parameter represent in real-world terms?</li>
</ul>
<div class="promptbox">
<p><strong>Reflection:</strong><br />
Summarize your reasoning and expectations before testing numerically.</p>
<p><br><br><br><br><br><br><br><br><br><br><br></p>
</div>
<hr />
</div>
<div id="task-5-fit-the-logistic-model" class="section level3 unnumbered hasAnchor">
<h3>Task 5 – Fit the Logistic Model<a href="workbook-week-3-models-and-growth.html#task-5-fit-the-logistic-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using the same stepwise prompting strategy, implement and test the logistic model numerically.</p>
<ul>
<li>Compare numerical results to your analytical expectations.<br />
</li>
<li>Add plot features (e.g., equilibrium lines, shaded regions) to support your interpretation.</li>
</ul>
<div class="promptbox">
<p><strong>Reflection:</strong><br />
Did your results confirm your intuition?<br />
How could you visualize uncertainty or residuals?</p>
<p><br><br><br><br><br><br><br><br><br><br><br></p>
</div>
<hr />
</div>
<div id="task-6-introduce-harvesting" class="section level3 unnumbered hasAnchor">
<h3>Task 6 – Introduce Harvesting<a href="workbook-week-3-models-and-growth.html#task-6-introduce-harvesting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Scenario:</strong><br />
This species of fish was overfished in the 1970s. In the 1980s, fishing was banned to allow recovery.</p>
<p>Modify your logistic model to include a <strong>harvesting term</strong>.<br />
Explore how harvesting rate affects long-term equilibrium and recovery trajectories.</p>
<div class="promptbox">
<p><strong>Reflection:</strong><br />
- How does equilibrium population change with harvesting rate <span class="math inline">\(H\)</span>?<br />
- What happens if you extrapolate beyond your data?</p>
<p><br><br><br><br><br><br><br><br><br><br><br></p>
</div>
<hr />
</div>
<div id="task-7-parameter-sensitivity-sweep-analysis" class="section level3 unnumbered hasAnchor">
<h3>Task 7 – Parameter Sensitivity (Sweep Analysis)<a href="workbook-week-3-models-and-growth.html#task-7-parameter-sensitivity-sweep-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write pseudo code to explore parameter sensitivity using loops.</p>
<p>Create visualizations showing:</p>
<ul>
<li>Equilibrium population vs. harvesting rate<br />
</li>
<li>Sensitivity of population recovery to historical or future harvests</li>
</ul>
<p>Be creative—surface plots, contour maps, or animations are all valid.</p>
<div class="promptbox">
<p><strong>Reflection:</strong><br />
What parameters is the system most sensitive to?<br />
What management implications might this have?</p>
<p><br><br><br><br><br><br><br><br><br><br><br></p>
</div>
<hr />
</div>
<div id="task-8-adding-environmental-variability" class="section level3 unnumbered hasAnchor">
<h3>Task 8 – Adding Environmental Variability<a href="workbook-week-3-models-and-growth.html#task-8-adding-environmental-variability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now lets question one of our model assumptions:<br />
Is <span class="math inline">\(r\)</span> (the intrinsic growth rate) really constant?</p>
<p>Create pseudo code that allows <span class="math inline">\(r\)</span> to vary between <strong>good years</strong> and <strong>bad years</strong>:</p>
<ul>
<li>In a <em>good year</em>, <span class="math inline">\(r\)</span> stays the same.<br />
</li>
<li>In a <em>bad year</em>, <span class="math inline">\(r\)</span> is scaled by a factor between 0 and 1.</li>
</ul>
<p>Add sliders to adjust:
- The frequency of bad years<br />
- The scaling factor for <span class="math inline">\(r\)</span></p>
<div class="promptbox">
<p><strong>Reflection:</strong><br />
- How does stochasticity affect population resilience?<br />
- How could models like this support adaptive management or conservation policy?</p>
<p><br><br><br><br><br><br><br><br><br><br><br></p>
</div>
</div>
</div>
<div id="readme-interactive-linear-fit-cod-population-shiny" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">D.3</span> Readme: Interactive Linear Fit — Cod Population (Shiny)<a href="workbook-week-3-models-and-growth.html#readme-interactive-linear-fit-cod-population-shiny" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section introduces the <strong>Interactive Linear Model App</strong> designed to explore the <strong>Cod population dataset</strong>.<br />
The accompanying README and source code provide an overview of the app’s structure and highlight the key code components that power its functionality, including data loading, model fitting, and visualization.</p>
<p>An interactive Shiny app for <strong>tuning a linear model by eye</strong> and comparing it to the <strong>ordinary least squares (OLS)</strong> best fit using <strong>RMSE</strong> as the reference metric.<br />
All displayed values and sliders use <strong>3 significant figures</strong>.</p>
<hr />
<div id="what-this-app-does" class="section level3 unnumbered hasAnchor">
<h3>What this app does<a href="workbook-week-3-models-and-growth.html#what-this-app-does" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Loads a cod population time series (<code>Year</code>, <code>Pop</code>) and creates a centered time variable<br />
<span class="math inline">\(t = \text{Year} - \min(\text{Year})\)</span></li>
<li>Lets users interactively adjust a <strong>linear model</strong>:<br />
<span class="math inline">\(\text{Pop}(t) = a + b \cdot t\)</span></li>
<li>Shows your equation and <strong>RMSE</strong> in real time and overlays the <strong>OLS (min-RMSE) line</strong> as a dashed reference</li>
<li>Includes a <strong>“Snap to OLS”</strong> button to set sliders to the best-fit coefficients</li>
<li>If <code>data/cod_timeseries.csv</code> is missing, the app will fall back to <strong>synthetic demo data</strong> (noted in the UI)</li>
</ul>
<hr />
</div>
<div id="why-this-is-useful" class="section level3 unnumbered hasAnchor">
<h3>Why this is useful<a href="workbook-week-3-models-and-growth.html#why-this-is-useful" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Builds intuition for <strong>model form</strong>, <strong>slope/intercept interpretation</strong>, and <strong>error metrics</strong> (RMSE)<br />
</li>
<li>Demonstrates the value of <strong>centering time</strong> (numerical stability, interpretability)<br />
</li>
<li>Encourages hands-on exploration before relying on automated fitting</li>
</ul>
<hr />
</div>
<div id="requirements" class="section level3 unnumbered hasAnchor">
<h3>Requirements<a href="workbook-week-3-models-and-growth.html#requirements" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>R (≥ 4.2 recommended)</li>
<li>Packages: <code>shiny</code>, <code>tidyverse</code> (specifically <code>readr</code>, <code>dplyr</code>, and <code>ggplot2</code>)</li>
</ul>
<p>Install once:</p>
<pre class="(r,eval=false)"><code>install.packages(c(&quot;shiny&quot;, &quot;tidyverse&quot;))</code></pre>
<hr />
</div>
<div id="file-structure" class="section level3 unnumbered hasAnchor">
<h3>File structure<a href="workbook-week-3-models-and-growth.html#file-structure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre class="(r,eval=false)"><code>#your-project/
#├─ app.R
#└─ data/
#   └─ cod_timeseries.csv   # Your dataset (optional; app falls back if missing)</code></pre>
<hr />
</div>
<div id="expected-csv-schema" class="section level3 unnumbered hasAnchor">
<h3>Expected CSV schema<a href="workbook-week-3-models-and-growth.html#expected-csv-schema" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Required columns:</strong> <code>Year</code>, <code>Pop</code></li>
<li><strong>Example (header + 5 rows):</strong></li>
</ul>
<p><strong>csv</strong></p>
<p>Year,Pop<br />
1960,2.31<br />
1961,2.45<br />
1962,2.38<br />
1963,2.52<br />
1964,2.60<br />
</p>
<blockquote>
<p><strong>Note:</strong> Years don’t need to start at 0; the app internally creates <span class="math inline">\(t = \text{Year} - \min(\text{Year})\)</span>.</p>
</blockquote>
<hr />
</div>
<div id="how-to-run" class="section level3 unnumbered hasAnchor">
<h3>How to run<a href="workbook-week-3-models-and-growth.html#how-to-run" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From the project directory:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="workbook-week-3-models-and-growth.html#cb6-1" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runApp</span>(<span class="st">&quot;app.R&quot;</span>)</span></code></pre></div>
<p>Or open <code>app.R</code> in RStudio and click <strong>Run App</strong>.</p>
<hr />
</div>
<div id="app-controls-outputs" class="section level3 unnumbered hasAnchor">
<h3>App controls &amp; outputs<a href="workbook-week-3-models-and-growth.html#app-controls-outputs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Sliders:</strong>
<ul>
<li><strong>Intercept (a)</strong> – baseline population at the first observed year (since <span class="math inline">\(t = 0\)</span> there)</li>
<li><strong>Slope (b)</strong> – rate of change in population per year</li>
</ul></li>
<li><strong>Snap to OLS</strong> – sets <code>a</code>, <code>b</code> to the least-squares solution</li>
<li><strong>Equation &amp; RMSE (your line)</strong> – updates dynamically</li>
<li><strong>Equation &amp; RMSE (OLS)</strong> – fixed reference based on <code>lm(Pop ~ t)</code></li>
</ul>
<p><strong>Plot layers:</strong></p>
<ul>
<li>Points → observed data<br />
</li>
<li>Faint line → observed connection over time<br />
</li>
<li>Solid line → your current (a, b)<br />
</li>
<li>Dashed line → OLS reference line</li>
</ul>
<hr />
</div>
<div id="under-the-hood-key-functions" class="section level3 unnumbered hasAnchor">
<h3>Under the hood (key functions)<a href="workbook-week-3-models-and-growth.html#under-the-hood-key-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Data load:</strong></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="workbook-week-3-models-and-growth.html#cb7-1" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">&quot;data/cod_timeseries.csv&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="workbook-week-3-models-and-growth.html#cb7-2" tabindex="-1"></a>  <span class="fu">select</span>(Year, Pop) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="workbook-week-3-models-and-growth.html#cb7-3" tabindex="-1"></a>  <span class="fu">arrange</span>(Year)</span></code></pre></div>
<ul>
<li><p><strong>Centering time:</strong><br />
<code>t = Year - min(Year)</code></p></li>
<li><p><strong>RMSE:</strong><br />
<span class="math inline">\(\text{RMSE} = \sqrt{\text{mean}\big((\text{obs} - \text{pred})^2\big)}\)</span></p></li>
<li><p><strong>OLS reference:</strong><br />
<code>lm(Pop ~ t, data = cod)</code></p></li>
</ul>
<hr />
</div>
<div id="customization-tips" class="section level3 unnumbered hasAnchor">
<h3>Customization tips<a href="workbook-week-3-models-and-growth.html#customization-tips" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Change y-axis label:</strong><br />
Edit <code>labs(y = "Population (units)")</code> in the plot section.</p></li>
<li><p><strong>Adjust slider ranges:</strong><br />
Modify the <code>a_rng</code> and <code>b_rng</code> logic near the top of the script.</p></li>
<li><p><strong>Colors/line styles:</strong><br />
Tweak the <code>geom_line(...)</code> aesthetics in <code>renderPlot</code>.</p></li>
</ul>
<hr />
</div>
<div id="troubleshooting" class="section level3 unnumbered hasAnchor">
<h3>Troubleshooting<a href="workbook-week-3-models-and-growth.html#troubleshooting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Error: “Could not find function ‘read_csv’”</strong><br />
→ Install and load tidyverse:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="workbook-week-3-models-and-growth.html#cb8-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb8-2"><a href="workbook-week-3-models-and-growth.html#cb8-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div></li>
<li><p><strong>Blank app / load errors:</strong></p>
<ul>
<li>Check that <code>data/cod_timeseries.csv</code> exists and has <code>Year,Pop</code> headers.<br />
</li>
<li>If missing, the app uses synthetic demo data.</li>
</ul></li>
<li><p><strong>Unexpected RMSE values:</strong><br />
Check data units and missing values. RMSE is computed with <code>na.rm = TRUE</code>.</p></li>
</ul>
<hr />
</div>
<div id="source-code" class="section level3 unnumbered hasAnchor">
<h3>Source Code<a href="workbook-week-3-models-and-growth.html#source-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="workbook-week-3-models-and-growth.html#cb9-1" tabindex="-1"></a><span class="co"># app.R</span></span>
<span id="cb9-2"><a href="workbook-week-3-models-and-growth.html#cb9-2" tabindex="-1"></a><span class="co"># Interactive linear fit tuner (with best-RMSE reference) for cod population data</span></span>
<span id="cb9-3"><a href="workbook-week-3-models-and-growth.html#cb9-3" tabindex="-1"></a><span class="co"># All displayed values and sliders use 3 significant figures</span></span>
<span id="cb9-4"><a href="workbook-week-3-models-and-growth.html#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="workbook-week-3-models-and-growth.html#cb9-5" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb9-6"><a href="workbook-week-3-models-and-growth.html#cb9-6" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb9-7"><a href="workbook-week-3-models-and-growth.html#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="workbook-week-3-models-and-growth.html#cb9-8" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb9-9"><a href="workbook-week-3-models-and-growth.html#cb9-9" tabindex="-1"></a><span class="co"># Data load (with safe fallback)</span></span>
<span id="cb9-10"><a href="workbook-week-3-models-and-growth.html#cb9-10" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb9-11"><a href="workbook-week-3-models-and-growth.html#cb9-11" tabindex="-1"></a>load_cod_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb9-12"><a href="workbook-week-3-models-and-growth.html#cb9-12" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="st">&quot;data/cod_timeseries.csv&quot;</span></span>
<span id="cb9-13"><a href="workbook-week-3-models-and-growth.html#cb9-13" tabindex="-1"></a>  <span class="fu">read_csv</span>(path, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-14"><a href="workbook-week-3-models-and-growth.html#cb9-14" tabindex="-1"></a>    <span class="fu">select</span>(Year, Pop) <span class="sc">|&gt;</span></span>
<span id="cb9-15"><a href="workbook-week-3-models-and-growth.html#cb9-15" tabindex="-1"></a>    <span class="fu">arrange</span>(Year)</span>
<span id="cb9-16"><a href="workbook-week-3-models-and-growth.html#cb9-16" tabindex="-1"></a></span>
<span id="cb9-17"><a href="workbook-week-3-models-and-growth.html#cb9-17" tabindex="-1"></a>}</span>
<span id="cb9-18"><a href="workbook-week-3-models-and-growth.html#cb9-18" tabindex="-1"></a></span>
<span id="cb9-19"><a href="workbook-week-3-models-and-growth.html#cb9-19" tabindex="-1"></a>cod <span class="ot">&lt;-</span> <span class="fu">load_cod_data</span>() <span class="sc">|&gt;</span></span>
<span id="cb9-20"><a href="workbook-week-3-models-and-growth.html#cb9-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">t =</span> Year <span class="sc">-</span> <span class="fu">min</span>(Year))</span>
<span id="cb9-21"><a href="workbook-week-3-models-and-growth.html#cb9-21" tabindex="-1"></a></span>
<span id="cb9-22"><a href="workbook-week-3-models-and-growth.html#cb9-22" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb9-23"><a href="workbook-week-3-models-and-growth.html#cb9-23" tabindex="-1"></a><span class="co"># Helpers</span></span>
<span id="cb9-24"><a href="workbook-week-3-models-and-growth.html#cb9-24" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb9-25"><a href="workbook-week-3-models-and-growth.html#cb9-25" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(obs, pred) <span class="fu">sqrt</span>(<span class="fu">mean</span>((obs <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb9-26"><a href="workbook-week-3-models-and-growth.html#cb9-26" tabindex="-1"></a></span>
<span id="cb9-27"><a href="workbook-week-3-models-and-growth.html#cb9-27" tabindex="-1"></a><span class="co"># OLS (min-RMSE for linear model)</span></span>
<span id="cb9-28"><a href="workbook-week-3-models-and-growth.html#cb9-28" tabindex="-1"></a>ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(Pop <span class="sc">~</span> t, <span class="at">data =</span> cod)</span>
<span id="cb9-29"><a href="workbook-week-3-models-and-growth.html#cb9-29" tabindex="-1"></a>a_best <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">coef</span>(ols)[<span class="dv">1</span>])</span>
<span id="cb9-30"><a href="workbook-week-3-models-and-growth.html#cb9-30" tabindex="-1"></a>b_best <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">coef</span>(ols)[<span class="dv">2</span>])</span>
<span id="cb9-31"><a href="workbook-week-3-models-and-growth.html#cb9-31" tabindex="-1"></a>best_rmse <span class="ot">&lt;-</span> <span class="fu">rmse</span>(cod<span class="sc">$</span>Pop, <span class="fu">fitted</span>(ols))</span>
<span id="cb9-32"><a href="workbook-week-3-models-and-growth.html#cb9-32" tabindex="-1"></a></span>
<span id="cb9-33"><a href="workbook-week-3-models-and-growth.html#cb9-33" tabindex="-1"></a><span class="co"># Slider ranges (reasonable defaults)</span></span>
<span id="cb9-34"><a href="workbook-week-3-models-and-growth.html#cb9-34" tabindex="-1"></a>t_range <span class="ot">&lt;-</span> <span class="fu">range</span>(cod<span class="sc">$</span>t, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-35"><a href="workbook-week-3-models-and-growth.html#cb9-35" tabindex="-1"></a>pop_rng <span class="ot">&lt;-</span> <span class="fu">range</span>(cod<span class="sc">$</span>Pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-36"><a href="workbook-week-3-models-and-growth.html#cb9-36" tabindex="-1"></a>a_rng   <span class="ot">&lt;-</span> <span class="fu">c</span>(pop_rng[<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">diff</span>(pop_rng),</span>
<span id="cb9-37"><a href="workbook-week-3-models-and-growth.html#cb9-37" tabindex="-1"></a>             pop_rng[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">diff</span>(pop_rng))</span>
<span id="cb9-38"><a href="workbook-week-3-models-and-growth.html#cb9-38" tabindex="-1"></a>b_scale <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">diff</span>(t_range) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">diff</span>(pop_rng) <span class="sc">/</span> <span class="fu">diff</span>(t_range), <span class="dv">1</span>)</span>
<span id="cb9-39"><a href="workbook-week-3-models-and-growth.html#cb9-39" tabindex="-1"></a>b_rng   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>) <span class="sc">*</span> b_scale</span>
<span id="cb9-40"><a href="workbook-week-3-models-and-growth.html#cb9-40" tabindex="-1"></a></span>
<span id="cb9-41"><a href="workbook-week-3-models-and-growth.html#cb9-41" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb9-42"><a href="workbook-week-3-models-and-growth.html#cb9-42" tabindex="-1"></a><span class="co"># UI</span></span>
<span id="cb9-43"><a href="workbook-week-3-models-and-growth.html#cb9-43" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb9-44"><a href="workbook-week-3-models-and-growth.html#cb9-44" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb9-45"><a href="workbook-week-3-models-and-growth.html#cb9-45" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">&quot;Interactive Linear Fit (3 sig figs): Cod Population&quot;</span>),</span>
<span id="cb9-46"><a href="workbook-week-3-models-and-growth.html#cb9-46" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb9-47"><a href="workbook-week-3-models-and-growth.html#cb9-47" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb9-48"><a href="workbook-week-3-models-and-growth.html#cb9-48" tabindex="-1"></a>      <span class="fu">helpText</span>(<span class="st">&quot;Model:  Pop(t) = a + b * t   with  t = Year - min(Year)&quot;</span>),</span>
<span id="cb9-49"><a href="workbook-week-3-models-and-growth.html#cb9-49" tabindex="-1"></a></span>
<span id="cb9-50"><a href="workbook-week-3-models-and-growth.html#cb9-50" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;Intercept (a):&quot;</span>,</span>
<span id="cb9-51"><a href="workbook-week-3-models-and-growth.html#cb9-51" tabindex="-1"></a>                  <span class="at">min =</span> <span class="fu">signif</span>(a_rng[<span class="dv">1</span>], <span class="dv">3</span>), <span class="at">max =</span> <span class="fu">signif</span>(a_rng[<span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb9-52"><a href="workbook-week-3-models-and-growth.html#cb9-52" tabindex="-1"></a>                  <span class="at">value =</span> <span class="fu">signif</span>(a_best, <span class="dv">3</span>),</span>
<span id="cb9-53"><a href="workbook-week-3-models-and-growth.html#cb9-53" tabindex="-1"></a>                  <span class="at">step =</span> <span class="fu">signif</span>(<span class="fu">diff</span>(a_rng) <span class="sc">/</span> <span class="dv">200</span>, <span class="dv">3</span>)),</span>
<span id="cb9-54"><a href="workbook-week-3-models-and-growth.html#cb9-54" tabindex="-1"></a></span>
<span id="cb9-55"><a href="workbook-week-3-models-and-growth.html#cb9-55" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;Slope (b):&quot;</span>,</span>
<span id="cb9-56"><a href="workbook-week-3-models-and-growth.html#cb9-56" tabindex="-1"></a>                  <span class="at">min =</span> <span class="fu">signif</span>(b_rng[<span class="dv">1</span>], <span class="dv">3</span>), <span class="at">max =</span> <span class="fu">signif</span>(b_rng[<span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb9-57"><a href="workbook-week-3-models-and-growth.html#cb9-57" tabindex="-1"></a>                  <span class="at">value =</span> <span class="fu">signif</span>(b_best, <span class="dv">3</span>),</span>
<span id="cb9-58"><a href="workbook-week-3-models-and-growth.html#cb9-58" tabindex="-1"></a>                  <span class="at">step =</span> <span class="fu">signif</span>(<span class="fu">diff</span>(b_rng) <span class="sc">/</span> <span class="dv">200</span>, <span class="dv">3</span>)),</span>
<span id="cb9-59"><a href="workbook-week-3-models-and-growth.html#cb9-59" tabindex="-1"></a></span>
<span id="cb9-60"><a href="workbook-week-3-models-and-growth.html#cb9-60" tabindex="-1"></a>      <span class="fu">actionButton</span>(<span class="st">&quot;snap&quot;</span>, <span class="st">&quot;Snap to OLS (min RMSE)&quot;</span>),</span>
<span id="cb9-61"><a href="workbook-week-3-models-and-growth.html#cb9-61" tabindex="-1"></a>      <span class="fu">hr</span>(),</span>
<span id="cb9-62"><a href="workbook-week-3-models-and-growth.html#cb9-62" tabindex="-1"></a>      <span class="fu">strong</span>(<span class="st">&quot;Your line:&quot;</span>),</span>
<span id="cb9-63"><a href="workbook-week-3-models-and-growth.html#cb9-63" tabindex="-1"></a>      <span class="fu">verbatimTextOutput</span>(<span class="st">&quot;eqn_user&quot;</span>, <span class="at">placeholder =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-64"><a href="workbook-week-3-models-and-growth.html#cb9-64" tabindex="-1"></a>      <span class="fu">div</span>(<span class="st">&quot;RMSE (your line):&quot;</span>),</span>
<span id="cb9-65"><a href="workbook-week-3-models-and-growth.html#cb9-65" tabindex="-1"></a>      <span class="fu">h3</span>(<span class="fu">textOutput</span>(<span class="st">&quot;rmse_user&quot;</span>), <span class="at">style =</span> <span class="st">&quot;margin-top:-8px;&quot;</span>),</span>
<span id="cb9-66"><a href="workbook-week-3-models-and-growth.html#cb9-66" tabindex="-1"></a>      <span class="fu">hr</span>(),</span>
<span id="cb9-67"><a href="workbook-week-3-models-and-growth.html#cb9-67" tabindex="-1"></a>      <span class="fu">strong</span>(<span class="st">&quot;OLS reference (dashed line):&quot;</span>),</span>
<span id="cb9-68"><a href="workbook-week-3-models-and-growth.html#cb9-68" tabindex="-1"></a>      <span class="fu">verbatimTextOutput</span>(<span class="st">&quot;eqn_best&quot;</span>, <span class="at">placeholder =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-69"><a href="workbook-week-3-models-and-growth.html#cb9-69" tabindex="-1"></a>      <span class="fu">div</span>(<span class="st">&quot;RMSE (OLS):&quot;</span>),</span>
<span id="cb9-70"><a href="workbook-week-3-models-and-growth.html#cb9-70" tabindex="-1"></a>      <span class="fu">h4</span>(<span class="fu">textOutput</span>(<span class="st">&quot;rmse_best&quot;</span>), <span class="at">style =</span> <span class="st">&quot;margin-top:-8px;&quot;</span>)</span>
<span id="cb9-71"><a href="workbook-week-3-models-and-growth.html#cb9-71" tabindex="-1"></a>    ),</span>
<span id="cb9-72"><a href="workbook-week-3-models-and-growth.html#cb9-72" tabindex="-1"></a></span>
<span id="cb9-73"><a href="workbook-week-3-models-and-growth.html#cb9-73" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb9-74"><a href="workbook-week-3-models-and-growth.html#cb9-74" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">&quot;fitplot&quot;</span>, <span class="at">height =</span> <span class="dv">480</span>),</span>
<span id="cb9-75"><a href="workbook-week-3-models-and-growth.html#cb9-75" tabindex="-1"></a>      <span class="fu">br</span>(),</span>
<span id="cb9-76"><a href="workbook-week-3-models-and-growth.html#cb9-76" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">small</span>(<span class="fu">em</span>(</span>
<span id="cb9-77"><a href="workbook-week-3-models-and-growth.html#cb9-77" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">&quot;data/cod_timeseries.csv&quot;</span>)) {</span>
<span id="cb9-78"><a href="workbook-week-3-models-and-growth.html#cb9-78" tabindex="-1"></a>          <span class="st">&quot;Loaded data/cod_timeseries.csv&quot;</span></span>
<span id="cb9-79"><a href="workbook-week-3-models-and-growth.html#cb9-79" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb9-80"><a href="workbook-week-3-models-and-growth.html#cb9-80" tabindex="-1"></a>          <span class="st">&quot;No data/cod_timeseries.csv found — using synthetic demo data.&quot;</span></span>
<span id="cb9-81"><a href="workbook-week-3-models-and-growth.html#cb9-81" tabindex="-1"></a>        }</span>
<span id="cb9-82"><a href="workbook-week-3-models-and-growth.html#cb9-82" tabindex="-1"></a>      ))</span>
<span id="cb9-83"><a href="workbook-week-3-models-and-growth.html#cb9-83" tabindex="-1"></a>    )</span>
<span id="cb9-84"><a href="workbook-week-3-models-and-growth.html#cb9-84" tabindex="-1"></a>  )</span>
<span id="cb9-85"><a href="workbook-week-3-models-and-growth.html#cb9-85" tabindex="-1"></a>)</span>
<span id="cb9-86"><a href="workbook-week-3-models-and-growth.html#cb9-86" tabindex="-1"></a></span>
<span id="cb9-87"><a href="workbook-week-3-models-and-growth.html#cb9-87" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb9-88"><a href="workbook-week-3-models-and-growth.html#cb9-88" tabindex="-1"></a><span class="co"># Server</span></span>
<span id="cb9-89"><a href="workbook-week-3-models-and-growth.html#cb9-89" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb9-90"><a href="workbook-week-3-models-and-growth.html#cb9-90" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb9-91"><a href="workbook-week-3-models-and-growth.html#cb9-91" tabindex="-1"></a></span>
<span id="cb9-92"><a href="workbook-week-3-models-and-growth.html#cb9-92" tabindex="-1"></a>  <span class="co"># Snap sliders to OLS on click</span></span>
<span id="cb9-93"><a href="workbook-week-3-models-and-growth.html#cb9-93" tabindex="-1"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>snap, {</span>
<span id="cb9-94"><a href="workbook-week-3-models-and-growth.html#cb9-94" tabindex="-1"></a>    <span class="fu">updateSliderInput</span>(session, <span class="st">&quot;a&quot;</span>, <span class="at">value =</span> <span class="fu">signif</span>(a_best, <span class="dv">3</span>))</span>
<span id="cb9-95"><a href="workbook-week-3-models-and-growth.html#cb9-95" tabindex="-1"></a>    <span class="fu">updateSliderInput</span>(session, <span class="st">&quot;b&quot;</span>, <span class="at">value =</span> <span class="fu">signif</span>(b_best, <span class="dv">3</span>))</span>
<span id="cb9-96"><a href="workbook-week-3-models-and-growth.html#cb9-96" tabindex="-1"></a>  })</span>
<span id="cb9-97"><a href="workbook-week-3-models-and-growth.html#cb9-97" tabindex="-1"></a></span>
<span id="cb9-98"><a href="workbook-week-3-models-and-growth.html#cb9-98" tabindex="-1"></a>  <span class="co"># Predictions for user&#39;s sliders</span></span>
<span id="cb9-99"><a href="workbook-week-3-models-and-growth.html#cb9-99" tabindex="-1"></a>  preds_user <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb9-100"><a href="workbook-week-3-models-and-growth.html#cb9-100" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb9-101"><a href="workbook-week-3-models-and-growth.html#cb9-101" tabindex="-1"></a>      <span class="at">Year =</span> cod<span class="sc">$</span>Year,</span>
<span id="cb9-102"><a href="workbook-week-3-models-and-growth.html#cb9-102" tabindex="-1"></a>      <span class="at">t    =</span> cod<span class="sc">$</span>t,</span>
<span id="cb9-103"><a href="workbook-week-3-models-and-growth.html#cb9-103" tabindex="-1"></a>      <span class="at">Pred =</span> input<span class="sc">$</span>a <span class="sc">+</span> input<span class="sc">$</span>b <span class="sc">*</span> cod<span class="sc">$</span>t</span>
<span id="cb9-104"><a href="workbook-week-3-models-and-growth.html#cb9-104" tabindex="-1"></a>    )</span>
<span id="cb9-105"><a href="workbook-week-3-models-and-growth.html#cb9-105" tabindex="-1"></a>  })</span>
<span id="cb9-106"><a href="workbook-week-3-models-and-growth.html#cb9-106" tabindex="-1"></a></span>
<span id="cb9-107"><a href="workbook-week-3-models-and-growth.html#cb9-107" tabindex="-1"></a>  <span class="co"># Text outputs</span></span>
<span id="cb9-108"><a href="workbook-week-3-models-and-growth.html#cb9-108" tabindex="-1"></a>  output<span class="sc">$</span>eqn_user <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb9-109"><a href="workbook-week-3-models-and-growth.html#cb9-109" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">&quot;Pop(t) = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>a, <span class="dv">3</span>),</span>
<span id="cb9-110"><a href="workbook-week-3-models-and-growth.html#cb9-110" tabindex="-1"></a>           <span class="st">&quot; + &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>b, <span class="dv">3</span>), <span class="st">&quot; * t&quot;</span>)</span>
<span id="cb9-111"><a href="workbook-week-3-models-and-growth.html#cb9-111" tabindex="-1"></a>  })</span>
<span id="cb9-112"><a href="workbook-week-3-models-and-growth.html#cb9-112" tabindex="-1"></a></span>
<span id="cb9-113"><a href="workbook-week-3-models-and-growth.html#cb9-113" tabindex="-1"></a>  output<span class="sc">$</span>rmse_user <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb9-114"><a href="workbook-week-3-models-and-growth.html#cb9-114" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, <span class="fu">rmse</span>(cod<span class="sc">$</span>Pop, <span class="fu">preds_user</span>()<span class="sc">$</span>Pred))</span>
<span id="cb9-115"><a href="workbook-week-3-models-and-growth.html#cb9-115" tabindex="-1"></a>  })</span>
<span id="cb9-116"><a href="workbook-week-3-models-and-growth.html#cb9-116" tabindex="-1"></a></span>
<span id="cb9-117"><a href="workbook-week-3-models-and-growth.html#cb9-117" tabindex="-1"></a>  output<span class="sc">$</span>eqn_best <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb9-118"><a href="workbook-week-3-models-and-growth.html#cb9-118" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">&quot;Pop(t) = &quot;</span>, <span class="fu">signif</span>(a_best, <span class="dv">3</span>),</span>
<span id="cb9-119"><a href="workbook-week-3-models-and-growth.html#cb9-119" tabindex="-1"></a>           <span class="st">&quot; + &quot;</span>, <span class="fu">signif</span>(b_best, <span class="dv">3</span>), <span class="st">&quot; * t&quot;</span>)</span>
<span id="cb9-120"><a href="workbook-week-3-models-and-growth.html#cb9-120" tabindex="-1"></a>  })</span>
<span id="cb9-121"><a href="workbook-week-3-models-and-growth.html#cb9-121" tabindex="-1"></a></span>
<span id="cb9-122"><a href="workbook-week-3-models-and-growth.html#cb9-122" tabindex="-1"></a>  output<span class="sc">$</span>rmse_best <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb9-123"><a href="workbook-week-3-models-and-growth.html#cb9-123" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, best_rmse)</span>
<span id="cb9-124"><a href="workbook-week-3-models-and-growth.html#cb9-124" tabindex="-1"></a>  })</span>
<span id="cb9-125"><a href="workbook-week-3-models-and-growth.html#cb9-125" tabindex="-1"></a></span>
<span id="cb9-126"><a href="workbook-week-3-models-and-growth.html#cb9-126" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb9-127"><a href="workbook-week-3-models-and-growth.html#cb9-127" tabindex="-1"></a>  output<span class="sc">$</span>fitplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb9-128"><a href="workbook-week-3-models-and-growth.html#cb9-128" tabindex="-1"></a>    <span class="co"># Smooth lines for display</span></span>
<span id="cb9-129"><a href="workbook-week-3-models-and-growth.html#cb9-129" tabindex="-1"></a>    grid <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-130"><a href="workbook-week-3-models-and-growth.html#cb9-130" tabindex="-1"></a>      <span class="at">Year =</span> <span class="fu">seq</span>(<span class="fu">min</span>(cod<span class="sc">$</span>Year), <span class="fu">max</span>(cod<span class="sc">$</span>Year), <span class="at">length.out =</span> <span class="dv">400</span>)</span>
<span id="cb9-131"><a href="workbook-week-3-models-and-growth.html#cb9-131" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb9-132"><a href="workbook-week-3-models-and-growth.html#cb9-132" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">t =</span> Year <span class="sc">-</span> <span class="fu">min</span>(cod<span class="sc">$</span>Year),</span>
<span id="cb9-133"><a href="workbook-week-3-models-and-growth.html#cb9-133" tabindex="-1"></a>             <span class="at">Pred_user =</span> input<span class="sc">$</span>a <span class="sc">+</span> input<span class="sc">$</span>b <span class="sc">*</span> t,</span>
<span id="cb9-134"><a href="workbook-week-3-models-and-growth.html#cb9-134" tabindex="-1"></a>             <span class="at">Pred_best =</span> a_best <span class="sc">+</span> b_best <span class="sc">*</span> t)</span>
<span id="cb9-135"><a href="workbook-week-3-models-and-growth.html#cb9-135" tabindex="-1"></a></span>
<span id="cb9-136"><a href="workbook-week-3-models-and-growth.html#cb9-136" tabindex="-1"></a>    <span class="fu">ggplot</span>(cod, <span class="fu">aes</span>(Year, Pop)) <span class="sc">+</span></span>
<span id="cb9-137"><a href="workbook-week-3-models-and-growth.html#cb9-137" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb9-138"><a href="workbook-week-3-models-and-growth.html#cb9-138" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb9-139"><a href="workbook-week-3-models-and-growth.html#cb9-139" tabindex="-1"></a>      <span class="co"># User-selected line</span></span>
<span id="cb9-140"><a href="workbook-week-3-models-and-growth.html#cb9-140" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> grid, <span class="fu">aes</span>(<span class="at">y =</span> Pred_user),</span>
<span id="cb9-141"><a href="workbook-week-3-models-and-growth.html#cb9-141" tabindex="-1"></a>                <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;#0072B2&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-142"><a href="workbook-week-3-models-and-growth.html#cb9-142" tabindex="-1"></a>      <span class="co"># OLS (best fit)</span></span>
<span id="cb9-143"><a href="workbook-week-3-models-and-growth.html#cb9-143" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> grid, <span class="fu">aes</span>(<span class="at">y =</span> Pred_best),</span>
<span id="cb9-144"><a href="workbook-week-3-models-and-growth.html#cb9-144" tabindex="-1"></a>                <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey40&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-145"><a href="workbook-week-3-models-and-growth.html#cb9-145" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb9-146"><a href="workbook-week-3-models-and-growth.html#cb9-146" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Cod Population with Interactive Linear Fit&quot;</span>,</span>
<span id="cb9-147"><a href="workbook-week-3-models-and-growth.html#cb9-147" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb9-148"><a href="workbook-week-3-models-and-growth.html#cb9-148" tabindex="-1"></a>          <span class="st">&quot;a = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>a, <span class="dv">3</span>),</span>
<span id="cb9-149"><a href="workbook-week-3-models-and-growth.html#cb9-149" tabindex="-1"></a>          <span class="st">&quot;, b = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>b, <span class="dv">3</span>),</span>
<span id="cb9-150"><a href="workbook-week-3-models-and-growth.html#cb9-150" tabindex="-1"></a>          <span class="st">&quot; | RMSE (yours) = &quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, <span class="fu">rmse</span>(cod<span class="sc">$</span>Pop, <span class="fu">preds_user</span>()<span class="sc">$</span>Pred)),</span>
<span id="cb9-151"><a href="workbook-week-3-models-and-growth.html#cb9-151" tabindex="-1"></a>          <span class="st">&quot; | RMSE (OLS) = &quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, best_rmse)</span>
<span id="cb9-152"><a href="workbook-week-3-models-and-growth.html#cb9-152" tabindex="-1"></a>        ),</span>
<span id="cb9-153"><a href="workbook-week-3-models-and-growth.html#cb9-153" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Population (units)&quot;</span></span>
<span id="cb9-154"><a href="workbook-week-3-models-and-growth.html#cb9-154" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb9-155"><a href="workbook-week-3-models-and-growth.html#cb9-155" tabindex="-1"></a>      <span class="fu">theme_classic</span>()</span>
<span id="cb9-156"><a href="workbook-week-3-models-and-growth.html#cb9-156" tabindex="-1"></a>  })</span>
<span id="cb9-157"><a href="workbook-week-3-models-and-growth.html#cb9-157" tabindex="-1"></a>}</span>
<span id="cb9-158"><a href="workbook-week-3-models-and-growth.html#cb9-158" tabindex="-1"></a></span>
<span id="cb9-159"><a href="workbook-week-3-models-and-growth.html#cb9-159" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
</div>
</div>
<div id="readme-interactive-logistic-fit-cod-population-shiny" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">D.4</span> Readme: Interactive Logistic Fit — Cod Population (Shiny)<a href="workbook-week-3-models-and-growth.html#readme-interactive-logistic-fit-cod-population-shiny" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section introduces the <strong>Interactive Logistic Model App</strong> designed to explore the <strong>Cod population dataset</strong>.<br />
The accompanying README and source code provide an overview of the app’s structure and highlight the key code components that power its functionality, including data loading, nonlinear model fitting, and visualization.</p>
<p>An interactive Shiny app for tuning a <strong>logistic growth model</strong> by eye and comparing it to the <strong>nonlinear least squares (base R <code>nls</code>)</strong> best fit using <strong>RMSE</strong> as the reference metric.<br />
All sliders and displayed values use <strong>3 significant figures</strong>.</p>
<hr />
<div id="what-this-app-does-1" class="section level3 unnumbered hasAnchor">
<h3>What this app does<a href="workbook-week-3-models-and-growth.html#what-this-app-does-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Loads a cod population time series (<code>Year</code>, <code>Pop</code>) and creates a centered time variable<br />
<span class="math inline">\(t = \text{Year} - \min(\text{Year})\)</span></li>
<li>Lets users interactively adjust a <strong>logistic model</strong>:<br />
<span class="math inline">\(\text{Pop}(t) = \dfrac{K}{1 + A\,e^{-r t}}\)</span></li>
<li>Computes and displays your equation and <strong>RMSE</strong> in real time; overlays the <strong>best-fit (nls) curve</strong> as a dashed reference</li>
<li>Provides a <strong>“Snap to Best Fit (nls)”</strong> button to set sliders to the converged <code>nls</code> parameters (if convergence succeeds)</li>
<li>Notes in the UI if <code>data/cod_timeseries.csv</code> is missing (no synthetic data is auto-generated in this script)</li>
</ul>
<hr />
</div>
<div id="why-this-is-useful-1" class="section level3 unnumbered hasAnchor">
<h3>Why this is useful<a href="workbook-week-3-models-and-growth.html#why-this-is-useful-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Builds intuition for <strong>carrying capacity <span class="math inline">\(K\)</span></strong>, <strong>initial position <span class="math inline">\(A\)</span></strong>, and <strong>growth rate <span class="math inline">\(r\)</span></strong> in logistic dynamics<br />
</li>
<li>Demonstrates practical <strong>nonlinear curve fitting</strong> with base R <code>nls</code> and comparison via <strong>RMSE</strong><br />
</li>
<li>Encourages exploratory model-based reasoning beyond straight lines</li>
</ul>
<hr />
</div>
<div id="requirements-1" class="section level3 unnumbered hasAnchor">
<h3>Requirements<a href="workbook-week-3-models-and-growth.html#requirements-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>R (≥ 4.2 recommended)</li>
<li>Packages: <code>shiny</code>, <code>tidyverse</code> (specifically <code>readr</code>, <code>dplyr</code>, <code>ggplot2</code>)</li>
</ul>
<p>Install once:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="workbook-week-3-models-and-growth.html#cb10-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;shiny&quot;</span>, <span class="st">&quot;tidyverse&quot;</span>))</span></code></pre></div>
<hr />
</div>
<div id="file-structure-1" class="section level3 unnumbered hasAnchor">
<h3>File structure<a href="workbook-week-3-models-and-growth.html#file-structure-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre class="(r,eval=false)"><code>#your-project/
#├─ app.R
#└─ data/
#   └─ cod_timeseries.csv   # Your dataset (optional; app falls back if missing)</code></pre>
<hr />
</div>
<div id="expected-csv-schema-1" class="section level3 unnumbered hasAnchor">
<h3>Expected CSV schema<a href="workbook-week-3-models-and-growth.html#expected-csv-schema-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Required columns:</strong> <code>Year</code>, <code>Pop</code></li>
<li><strong>Example (header + 5 rows):</strong></li>
</ul>
<p><strong>csv</strong></p>
<p>Year,Pop<br />
1960,2.31<br />
1961,2.45<br />
1962,2.38<br />
1963,2.52<br />
1964,2.60<br />
</p>
<blockquote>
<p><strong>Note:</strong> The app internally creates <span class="math inline">\(t = \text{Year} - \min(\text{Year})\)</span>. Years need not start at 0.</p>
</blockquote>
<hr />
</div>
<div id="how-to-run-1" class="section level3 unnumbered hasAnchor">
<h3>How to run<a href="workbook-week-3-models-and-growth.html#how-to-run-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From the project directory:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="workbook-week-3-models-and-growth.html#cb12-1" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runApp</span>(<span class="st">&quot;app_logistic_base.R&quot;</span>)</span></code></pre></div>
<p>Or open <code>app_logistic_base.R</code> in RStudio and click <strong>Run App</strong>.</p>
<hr />
</div>
<div id="app-controls-outputs-1" class="section level3 unnumbered hasAnchor">
<h3>App controls &amp; outputs<a href="workbook-week-3-models-and-growth.html#app-controls-outputs-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Sliders:</strong>
<ul>
<li><strong>K (carrying capacity)</strong> – asymptotic upper bound</li>
<li><strong>A (initial position)</strong> – positions the curve at <span class="math inline">\(t=0\)</span> relative to <span class="math inline">\(K\)</span></li>
<li><strong>r (growth rate)</strong> – controls how quickly the curve rises (sign permits decline if negative)</li>
</ul></li>
<li><strong>Snap to Best Fit (nls)</strong> – sets <code>K</code>, <code>A</code>, <code>r</code> to the <strong>converged</strong> <code>nls</code> solution (if available)</li>
<li><strong>Equation &amp; RMSE (your curve)</strong> – updates as you move sliders</li>
<li><strong>Equation &amp; RMSE (best fit)</strong> – fixed reference from <code>nls</code> (or a message if <code>nls</code> failed to converge)</li>
</ul>
<p><strong>Plot layers:</strong></p>
<ul>
<li>Points → observed data<br />
</li>
<li>Faint line → observed connection over time<br />
</li>
<li>Solid line → your current logistic curve<br />
</li>
<li>Dashed line → best-fit logistic curve (if <code>nls</code> converged)</li>
</ul>
<hr />
</div>
<div id="under-the-hood-key-functions-1" class="section level3 unnumbered hasAnchor">
<h3>Under the hood (key functions)<a href="workbook-week-3-models-and-growth.html#under-the-hood-key-functions-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Data load:</strong></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="workbook-week-3-models-and-growth.html#cb13-1" tabindex="-1"></a>load_cod_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb13-2"><a href="workbook-week-3-models-and-growth.html#cb13-2" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="st">&quot;data/cod_timeseries.csv&quot;</span></span>
<span id="cb13-3"><a href="workbook-week-3-models-and-growth.html#cb13-3" tabindex="-1"></a>  <span class="fu">read_csv</span>(path, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="workbook-week-3-models-and-growth.html#cb13-4" tabindex="-1"></a>    <span class="fu">select</span>(Year, Pop) <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="workbook-week-3-models-and-growth.html#cb13-5" tabindex="-1"></a>    <span class="fu">arrange</span>(Year)</span>
<span id="cb13-6"><a href="workbook-week-3-models-and-growth.html#cb13-6" tabindex="-1"></a>}</span>
<span id="cb13-7"><a href="workbook-week-3-models-and-growth.html#cb13-7" tabindex="-1"></a>cod <span class="ot">&lt;-</span> <span class="fu">load_cod_data</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-8"><a href="workbook-week-3-models-and-growth.html#cb13-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">t =</span> Year <span class="sc">-</span> <span class="fu">min</span>(Year))</span></code></pre></div>
<ul>
<li><strong>Model + RMSE:</strong></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="workbook-week-3-models-and-growth.html#cb14-1" tabindex="-1"></a>logistic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(t, K, A, r) K <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> t))</span>
<span id="cb14-2"><a href="workbook-week-3-models-and-growth.html#cb14-2" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(obs, pred) <span class="fu">sqrt</span>(<span class="fu">mean</span>((obs <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<ul>
<li><strong>Heuristic starts for <code>nls</code>:</strong>
<ul>
<li><span class="math inline">\(K_{\text{start}} = 1.2 \times \max(\text{Pop})\)</span><br />
</li>
<li><span class="math inline">\(A_{\text{start}} = K_{\text{start}} / (P_0 + 10^{-6}) - 1\)</span>, where <span class="math inline">\(P_0\)</span> is Pop at <span class="math inline">\(t=0\)</span> (fallback to min if missing)<br />
</li>
<li><span class="math inline">\(r_{\text{start}} = 0.1\)</span></li>
</ul></li>
<li><strong>Nonlinear fit (base R):</strong></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="workbook-week-3-models-and-growth.html#cb15-1" tabindex="-1"></a>fit_best <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb15-2"><a href="workbook-week-3-models-and-growth.html#cb15-2" tabindex="-1"></a>  <span class="fu">nls</span>(</span>
<span id="cb15-3"><a href="workbook-week-3-models-and-growth.html#cb15-3" tabindex="-1"></a>    Pop <span class="sc">~</span> K <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> t)),</span>
<span id="cb15-4"><a href="workbook-week-3-models-and-growth.html#cb15-4" tabindex="-1"></a>    <span class="at">data =</span> cod,</span>
<span id="cb15-5"><a href="workbook-week-3-models-and-growth.html#cb15-5" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">list</span>(<span class="at">K =</span> K_start, <span class="at">A =</span> A_start, <span class="at">r =</span> r_start),</span>
<span id="cb15-6"><a href="workbook-week-3-models-and-growth.html#cb15-6" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">nls.control</span>(<span class="at">maxiter =</span> <span class="dv">2000</span>, <span class="at">warnOnly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-7"><a href="workbook-week-3-models-and-growth.html#cb15-7" tabindex="-1"></a>  ),</span>
<span id="cb15-8"><a href="workbook-week-3-models-and-growth.html#cb15-8" tabindex="-1"></a>  <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NULL</span></span>
<span id="cb15-9"><a href="workbook-week-3-models-and-growth.html#cb15-9" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li><strong>Slider ranges (rough scale):</strong><br />
<span class="math inline">\(K \in [0.5\max(\text{Pop}), 3\max(\text{Pop})]\)</span>, <span class="math inline">\(A \in [10^{-3}, 20]\)</span>, <span class="math inline">\(r \in [-1, 1]\)</span></li>
</ul>
<hr />
</div>
<div id="customization-tips-1" class="section level3 unnumbered hasAnchor">
<h3>Customization tips<a href="workbook-week-3-models-and-growth.html#customization-tips-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Axis/labels/theme:</strong><br />
Edit the <code>labs(...)</code> and <code>theme_*()</code> calls inside the <code>renderPlot</code> section.</li>
<li><strong>Starting values:</strong><br />
Adjust <code>K_start</code>, <code>A_start</code>, <code>r_start</code> heuristics to better match your dataset.</li>
<li><strong>Convergence behavior:</strong><br />
Tweak <code>nls.control(maxiter = 2000, warnOnly = TRUE)</code> if fits are unstable.</li>
<li><strong>Slider steps &amp; ranges:</strong><br />
Refine <code>step</code> and range calculations for smoother tuning.</li>
</ul>
<hr />
</div>
<div id="troubleshooting-1" class="section level3 unnumbered hasAnchor">
<h3>Troubleshooting<a href="workbook-week-3-models-and-growth.html#troubleshooting-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>File missing error (<code>cod_timeseries.csv</code>)</strong><br />
Place your dataset at <code>data/cod_timeseries.csv</code> with columns <code>Year,Pop</code>.<br />
If you want the app to render without the file, wrap the load in <code>if (file.exists(...))</code> and set a fallback tibble, or mark the example chunk with <code>eval=FALSE</code> in Bookdown.</p></li>
<li><p><strong><code>nls</code> fails to converge</strong></p>
<ul>
<li>Try “Snap to Best Fit” again after nudging sliders toward reasonable values.<br />
</li>
<li>Adjust starting values (<code>K_start</code>, <code>A_start</code>, <code>r_start</code>) to be closer to the data.<br />
</li>
<li>Narrow slider ranges if exploration goes into unrealistic regimes.</li>
</ul></li>
<li><p><strong>Unexpected RMSE values</strong><br />
Check data units, outliers, and missing values (RMSE uses <code>na.rm = TRUE</code>).</p></li>
</ul>
<hr />
</div>
<div id="source-code-1" class="section level3 unnumbered hasAnchor">
<h3>Source Code<a href="workbook-week-3-models-and-growth.html#source-code-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="workbook-week-3-models-and-growth.html#cb16-1" tabindex="-1"></a><span class="co"># app_logistic_base.R</span></span>
<span id="cb16-2"><a href="workbook-week-3-models-and-growth.html#cb16-2" tabindex="-1"></a><span class="co"># Interactive logistic fit (base R nls only) for cod population data</span></span>
<span id="cb16-3"><a href="workbook-week-3-models-and-growth.html#cb16-3" tabindex="-1"></a><span class="co"># Sliders and outputs use 3 significant figures</span></span>
<span id="cb16-4"><a href="workbook-week-3-models-and-growth.html#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="workbook-week-3-models-and-growth.html#cb16-5" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb16-6"><a href="workbook-week-3-models-and-growth.html#cb16-6" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb16-7"><a href="workbook-week-3-models-and-growth.html#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="workbook-week-3-models-and-growth.html#cb16-8" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb16-9"><a href="workbook-week-3-models-and-growth.html#cb16-9" tabindex="-1"></a><span class="co"># Data load (with safe fallback)</span></span>
<span id="cb16-10"><a href="workbook-week-3-models-and-growth.html#cb16-10" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb16-11"><a href="workbook-week-3-models-and-growth.html#cb16-11" tabindex="-1"></a>load_cod_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb16-12"><a href="workbook-week-3-models-and-growth.html#cb16-12" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="st">&quot;data/cod_timeseries.csv&quot;</span></span>
<span id="cb16-13"><a href="workbook-week-3-models-and-growth.html#cb16-13" tabindex="-1"></a>  <span class="fu">read_csv</span>(path, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-14"><a href="workbook-week-3-models-and-growth.html#cb16-14" tabindex="-1"></a>      <span class="fu">select</span>(Year, Pop) <span class="sc">|&gt;</span></span>
<span id="cb16-15"><a href="workbook-week-3-models-and-growth.html#cb16-15" tabindex="-1"></a>      <span class="fu">arrange</span>(Year)</span>
<span id="cb16-16"><a href="workbook-week-3-models-and-growth.html#cb16-16" tabindex="-1"></a></span>
<span id="cb16-17"><a href="workbook-week-3-models-and-growth.html#cb16-17" tabindex="-1"></a>}</span>
<span id="cb16-18"><a href="workbook-week-3-models-and-growth.html#cb16-18" tabindex="-1"></a></span>
<span id="cb16-19"><a href="workbook-week-3-models-and-growth.html#cb16-19" tabindex="-1"></a>cod <span class="ot">&lt;-</span> <span class="fu">load_cod_data</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-20"><a href="workbook-week-3-models-and-growth.html#cb16-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">t =</span> Year <span class="sc">-</span> <span class="fu">min</span>(Year))</span>
<span id="cb16-21"><a href="workbook-week-3-models-and-growth.html#cb16-21" tabindex="-1"></a></span>
<span id="cb16-22"><a href="workbook-week-3-models-and-growth.html#cb16-22" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb16-23"><a href="workbook-week-3-models-and-growth.html#cb16-23" tabindex="-1"></a><span class="co"># Helpers</span></span>
<span id="cb16-24"><a href="workbook-week-3-models-and-growth.html#cb16-24" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb16-25"><a href="workbook-week-3-models-and-growth.html#cb16-25" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(obs, pred) <span class="fu">sqrt</span>(<span class="fu">mean</span>((obs <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb16-26"><a href="workbook-week-3-models-and-growth.html#cb16-26" tabindex="-1"></a>logistic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(t, K, A, r) K <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> t))</span>
<span id="cb16-27"><a href="workbook-week-3-models-and-growth.html#cb16-27" tabindex="-1"></a></span>
<span id="cb16-28"><a href="workbook-week-3-models-and-growth.html#cb16-28" tabindex="-1"></a><span class="co"># Heuristic starting values for nls and slider defaults</span></span>
<span id="cb16-29"><a href="workbook-week-3-models-and-growth.html#cb16-29" tabindex="-1"></a>pop_max <span class="ot">&lt;-</span> <span class="fu">max</span>(cod<span class="sc">$</span>Pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-30"><a href="workbook-week-3-models-and-growth.html#cb16-30" tabindex="-1"></a>pop_min <span class="ot">&lt;-</span> <span class="fu">min</span>(cod<span class="sc">$</span>Pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-31"><a href="workbook-week-3-models-and-growth.html#cb16-31" tabindex="-1"></a>K_start <span class="ot">&lt;-</span> <span class="fl">1.2</span> <span class="sc">*</span> pop_max</span>
<span id="cb16-32"><a href="workbook-week-3-models-and-growth.html#cb16-32" tabindex="-1"></a>r_start <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb16-33"><a href="workbook-week-3-models-and-growth.html#cb16-33" tabindex="-1"></a>P0 <span class="ot">&lt;-</span> cod<span class="sc">$</span>Pop[cod<span class="sc">$</span>t <span class="sc">==</span> <span class="dv">0</span>][<span class="dv">1</span>]</span>
<span id="cb16-34"><a href="workbook-week-3-models-and-growth.html#cb16-34" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">is.na</span>(P0)) P0 <span class="ot">&lt;-</span> pop_min</span>
<span id="cb16-35"><a href="workbook-week-3-models-and-growth.html#cb16-35" tabindex="-1"></a>A_start <span class="ot">&lt;-</span> (K_start <span class="sc">/</span> (P0 <span class="sc">+</span> <span class="fl">1e-6</span>)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb16-36"><a href="workbook-week-3-models-and-growth.html#cb16-36" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(A_start) <span class="sc">||</span> A_start <span class="sc">&lt;=</span> <span class="dv">0</span>) A_start <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-37"><a href="workbook-week-3-models-and-growth.html#cb16-37" tabindex="-1"></a></span>
<span id="cb16-38"><a href="workbook-week-3-models-and-growth.html#cb16-38" tabindex="-1"></a><span class="co"># Fit best logistic model (nls)</span></span>
<span id="cb16-39"><a href="workbook-week-3-models-and-growth.html#cb16-39" tabindex="-1"></a>fit_best <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb16-40"><a href="workbook-week-3-models-and-growth.html#cb16-40" tabindex="-1"></a>  <span class="fu">nls</span>(</span>
<span id="cb16-41"><a href="workbook-week-3-models-and-growth.html#cb16-41" tabindex="-1"></a>    Pop <span class="sc">~</span> K <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> t)),</span>
<span id="cb16-42"><a href="workbook-week-3-models-and-growth.html#cb16-42" tabindex="-1"></a>    <span class="at">data =</span> cod,</span>
<span id="cb16-43"><a href="workbook-week-3-models-and-growth.html#cb16-43" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">list</span>(<span class="at">K =</span> K_start, <span class="at">A =</span> A_start, <span class="at">r =</span> r_start),</span>
<span id="cb16-44"><a href="workbook-week-3-models-and-growth.html#cb16-44" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">nls.control</span>(<span class="at">maxiter =</span> <span class="dv">2000</span>, <span class="at">warnOnly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-45"><a href="workbook-week-3-models-and-growth.html#cb16-45" tabindex="-1"></a>  ),</span>
<span id="cb16-46"><a href="workbook-week-3-models-and-growth.html#cb16-46" tabindex="-1"></a>  <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NULL</span></span>
<span id="cb16-47"><a href="workbook-week-3-models-and-growth.html#cb16-47" tabindex="-1"></a>)</span>
<span id="cb16-48"><a href="workbook-week-3-models-and-growth.html#cb16-48" tabindex="-1"></a></span>
<span id="cb16-49"><a href="workbook-week-3-models-and-growth.html#cb16-49" tabindex="-1"></a>has_best <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.null</span>(fit_best)</span>
<span id="cb16-50"><a href="workbook-week-3-models-and-growth.html#cb16-50" tabindex="-1"></a>best_par <span class="ot">&lt;-</span> <span class="cf">if</span> (has_best) <span class="fu">as.list</span>(<span class="fu">coef</span>(fit_best)) <span class="cf">else</span> <span class="fu">list</span>(<span class="at">K =</span> K_start, <span class="at">A =</span> A_start, <span class="at">r =</span> r_start)</span>
<span id="cb16-51"><a href="workbook-week-3-models-and-growth.html#cb16-51" tabindex="-1"></a>best_rmse <span class="ot">&lt;-</span> <span class="cf">if</span> (has_best) <span class="fu">rmse</span>(cod<span class="sc">$</span>Pop, <span class="fu">fitted</span>(fit_best)) <span class="cf">else</span> <span class="cn">NA_real_</span></span>
<span id="cb16-52"><a href="workbook-week-3-models-and-growth.html#cb16-52" tabindex="-1"></a></span>
<span id="cb16-53"><a href="workbook-week-3-models-and-growth.html#cb16-53" tabindex="-1"></a><span class="co"># Slider ranges (use rough scale spacing)</span></span>
<span id="cb16-54"><a href="workbook-week-3-models-and-growth.html#cb16-54" tabindex="-1"></a>K_rng <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span> <span class="sc">*</span> pop_max, <span class="dv">3</span> <span class="sc">*</span> pop_max)</span>
<span id="cb16-55"><a href="workbook-week-3-models-and-growth.html#cb16-55" tabindex="-1"></a>A_rng <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e-3</span>, <span class="dv">20</span>)</span>
<span id="cb16-56"><a href="workbook-week-3-models-and-growth.html#cb16-56" tabindex="-1"></a>r_rng <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb16-57"><a href="workbook-week-3-models-and-growth.html#cb16-57" tabindex="-1"></a></span>
<span id="cb16-58"><a href="workbook-week-3-models-and-growth.html#cb16-58" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb16-59"><a href="workbook-week-3-models-and-growth.html#cb16-59" tabindex="-1"></a><span class="co"># UI</span></span>
<span id="cb16-60"><a href="workbook-week-3-models-and-growth.html#cb16-60" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb16-61"><a href="workbook-week-3-models-and-growth.html#cb16-61" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb16-62"><a href="workbook-week-3-models-and-growth.html#cb16-62" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">&quot;Interactive Logistic Fit (Base nls): Cod Population&quot;</span>),</span>
<span id="cb16-63"><a href="workbook-week-3-models-and-growth.html#cb16-63" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb16-64"><a href="workbook-week-3-models-and-growth.html#cb16-64" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb16-65"><a href="workbook-week-3-models-and-growth.html#cb16-65" tabindex="-1"></a>      <span class="fu">helpText</span>(<span class="fu">HTML</span>(<span class="st">&quot;Model: &lt;b&gt;Pop(t) = K / (1 + A e&lt;sup&gt;-r t&lt;/sup&gt;)&lt;/b&gt;, with t = Year - min(Year)&quot;</span>)),</span>
<span id="cb16-66"><a href="workbook-week-3-models-and-growth.html#cb16-66" tabindex="-1"></a></span>
<span id="cb16-67"><a href="workbook-week-3-models-and-growth.html#cb16-67" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;K&quot;</span>, <span class="st">&quot;K (carrying capacity):&quot;</span>,</span>
<span id="cb16-68"><a href="workbook-week-3-models-and-growth.html#cb16-68" tabindex="-1"></a>                  <span class="at">min =</span> <span class="fu">signif</span>(K_rng[<span class="dv">1</span>], <span class="dv">3</span>), <span class="at">max =</span> <span class="fu">signif</span>(K_rng[<span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb16-69"><a href="workbook-week-3-models-and-growth.html#cb16-69" tabindex="-1"></a>                  <span class="at">value =</span> <span class="fu">signif</span>(best_par<span class="sc">$</span>K, <span class="dv">3</span>), <span class="at">step =</span> <span class="fu">signif</span>(<span class="fu">diff</span>(K_rng)<span class="sc">/</span><span class="dv">200</span>, <span class="dv">3</span>)),</span>
<span id="cb16-70"><a href="workbook-week-3-models-and-growth.html#cb16-70" tabindex="-1"></a></span>
<span id="cb16-71"><a href="workbook-week-3-models-and-growth.html#cb16-71" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A (initial position):&quot;</span>,</span>
<span id="cb16-72"><a href="workbook-week-3-models-and-growth.html#cb16-72" tabindex="-1"></a>                  <span class="at">min =</span> <span class="fu">signif</span>(A_rng[<span class="dv">1</span>], <span class="dv">3</span>), <span class="at">max =</span> <span class="fu">signif</span>(A_rng[<span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb16-73"><a href="workbook-week-3-models-and-growth.html#cb16-73" tabindex="-1"></a>                  <span class="at">value =</span> <span class="fu">signif</span>(best_par<span class="sc">$</span>A, <span class="dv">3</span>), <span class="at">step =</span> <span class="fl">0.01</span>),</span>
<span id="cb16-74"><a href="workbook-week-3-models-and-growth.html#cb16-74" tabindex="-1"></a></span>
<span id="cb16-75"><a href="workbook-week-3-models-and-growth.html#cb16-75" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;r&quot;</span>, <span class="st">&quot;r (growth rate):&quot;</span>,</span>
<span id="cb16-76"><a href="workbook-week-3-models-and-growth.html#cb16-76" tabindex="-1"></a>                  <span class="at">min =</span> <span class="fu">signif</span>(r_rng[<span class="dv">1</span>], <span class="dv">3</span>), <span class="at">max =</span> <span class="fu">signif</span>(r_rng[<span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb16-77"><a href="workbook-week-3-models-and-growth.html#cb16-77" tabindex="-1"></a>                  <span class="at">value =</span> <span class="fu">signif</span>(best_par<span class="sc">$</span>r, <span class="dv">3</span>), <span class="at">step =</span> <span class="fl">0.001</span>),</span>
<span id="cb16-78"><a href="workbook-week-3-models-and-growth.html#cb16-78" tabindex="-1"></a></span>
<span id="cb16-79"><a href="workbook-week-3-models-and-growth.html#cb16-79" tabindex="-1"></a>      <span class="fu">actionButton</span>(<span class="st">&quot;snap&quot;</span>, <span class="st">&quot;Snap to Best Fit (nls)&quot;</span>),</span>
<span id="cb16-80"><a href="workbook-week-3-models-and-growth.html#cb16-80" tabindex="-1"></a>      <span class="fu">hr</span>(),</span>
<span id="cb16-81"><a href="workbook-week-3-models-and-growth.html#cb16-81" tabindex="-1"></a>      <span class="fu">strong</span>(<span class="st">&quot;Your logistic curve:&quot;</span>),</span>
<span id="cb16-82"><a href="workbook-week-3-models-and-growth.html#cb16-82" tabindex="-1"></a>      <span class="fu">verbatimTextOutput</span>(<span class="st">&quot;eqn_user&quot;</span>, <span class="at">placeholder =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-83"><a href="workbook-week-3-models-and-growth.html#cb16-83" tabindex="-1"></a>      <span class="fu">div</span>(<span class="st">&quot;RMSE (your curve):&quot;</span>),</span>
<span id="cb16-84"><a href="workbook-week-3-models-and-growth.html#cb16-84" tabindex="-1"></a>      <span class="fu">h3</span>(<span class="fu">textOutput</span>(<span class="st">&quot;rmse_user&quot;</span>), <span class="at">style =</span> <span class="st">&quot;margin-top:-8px;&quot;</span>),</span>
<span id="cb16-85"><a href="workbook-week-3-models-and-growth.html#cb16-85" tabindex="-1"></a>      <span class="fu">hr</span>(),</span>
<span id="cb16-86"><a href="workbook-week-3-models-and-growth.html#cb16-86" tabindex="-1"></a>      <span class="fu">strong</span>(<span class="st">&quot;Best fit (dashed line):&quot;</span>),</span>
<span id="cb16-87"><a href="workbook-week-3-models-and-growth.html#cb16-87" tabindex="-1"></a>      <span class="fu">verbatimTextOutput</span>(<span class="st">&quot;eqn_best&quot;</span>, <span class="at">placeholder =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-88"><a href="workbook-week-3-models-and-growth.html#cb16-88" tabindex="-1"></a>      <span class="fu">div</span>(<span class="st">&quot;RMSE (best fit):&quot;</span>),</span>
<span id="cb16-89"><a href="workbook-week-3-models-and-growth.html#cb16-89" tabindex="-1"></a>      <span class="fu">h4</span>(<span class="fu">textOutput</span>(<span class="st">&quot;rmse_best&quot;</span>), <span class="at">style =</span> <span class="st">&quot;margin-top:-8px;&quot;</span>)</span>
<span id="cb16-90"><a href="workbook-week-3-models-and-growth.html#cb16-90" tabindex="-1"></a>    ),</span>
<span id="cb16-91"><a href="workbook-week-3-models-and-growth.html#cb16-91" tabindex="-1"></a></span>
<span id="cb16-92"><a href="workbook-week-3-models-and-growth.html#cb16-92" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb16-93"><a href="workbook-week-3-models-and-growth.html#cb16-93" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">&quot;fitplot&quot;</span>, <span class="at">height =</span> <span class="dv">500</span>),</span>
<span id="cb16-94"><a href="workbook-week-3-models-and-growth.html#cb16-94" tabindex="-1"></a>      <span class="fu">br</span>(),</span>
<span id="cb16-95"><a href="workbook-week-3-models-and-growth.html#cb16-95" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">small</span>(<span class="fu">em</span>(</span>
<span id="cb16-96"><a href="workbook-week-3-models-and-growth.html#cb16-96" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">&quot;data/cod_timeseries.csv&quot;</span>)) {</span>
<span id="cb16-97"><a href="workbook-week-3-models-and-growth.html#cb16-97" tabindex="-1"></a>          <span class="st">&quot;Loaded data/cod_timeseries.csv&quot;</span></span>
<span id="cb16-98"><a href="workbook-week-3-models-and-growth.html#cb16-98" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb16-99"><a href="workbook-week-3-models-and-growth.html#cb16-99" tabindex="-1"></a>          <span class="st">&quot;No data/cod_timeseries.csv found — using synthetic demo data.&quot;</span></span>
<span id="cb16-100"><a href="workbook-week-3-models-and-growth.html#cb16-100" tabindex="-1"></a>        }</span>
<span id="cb16-101"><a href="workbook-week-3-models-and-growth.html#cb16-101" tabindex="-1"></a>      ))</span>
<span id="cb16-102"><a href="workbook-week-3-models-and-growth.html#cb16-102" tabindex="-1"></a>    )</span>
<span id="cb16-103"><a href="workbook-week-3-models-and-growth.html#cb16-103" tabindex="-1"></a>  )</span>
<span id="cb16-104"><a href="workbook-week-3-models-and-growth.html#cb16-104" tabindex="-1"></a>)</span>
<span id="cb16-105"><a href="workbook-week-3-models-and-growth.html#cb16-105" tabindex="-1"></a></span>
<span id="cb16-106"><a href="workbook-week-3-models-and-growth.html#cb16-106" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb16-107"><a href="workbook-week-3-models-and-growth.html#cb16-107" tabindex="-1"></a><span class="co"># Server</span></span>
<span id="cb16-108"><a href="workbook-week-3-models-and-growth.html#cb16-108" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb16-109"><a href="workbook-week-3-models-and-growth.html#cb16-109" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb16-110"><a href="workbook-week-3-models-and-growth.html#cb16-110" tabindex="-1"></a></span>
<span id="cb16-111"><a href="workbook-week-3-models-and-growth.html#cb16-111" tabindex="-1"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>snap, {</span>
<span id="cb16-112"><a href="workbook-week-3-models-and-growth.html#cb16-112" tabindex="-1"></a>    <span class="fu">updateSliderInput</span>(session, <span class="st">&quot;K&quot;</span>, <span class="at">value =</span> <span class="fu">signif</span>(best_par<span class="sc">$</span>K, <span class="dv">3</span>))</span>
<span id="cb16-113"><a href="workbook-week-3-models-and-growth.html#cb16-113" tabindex="-1"></a>    <span class="fu">updateSliderInput</span>(session, <span class="st">&quot;A&quot;</span>, <span class="at">value =</span> <span class="fu">signif</span>(best_par<span class="sc">$</span>A, <span class="dv">3</span>))</span>
<span id="cb16-114"><a href="workbook-week-3-models-and-growth.html#cb16-114" tabindex="-1"></a>    <span class="fu">updateSliderInput</span>(session, <span class="st">&quot;r&quot;</span>, <span class="at">value =</span> <span class="fu">signif</span>(best_par<span class="sc">$</span>r, <span class="dv">3</span>))</span>
<span id="cb16-115"><a href="workbook-week-3-models-and-growth.html#cb16-115" tabindex="-1"></a>  })</span>
<span id="cb16-116"><a href="workbook-week-3-models-and-growth.html#cb16-116" tabindex="-1"></a></span>
<span id="cb16-117"><a href="workbook-week-3-models-and-growth.html#cb16-117" tabindex="-1"></a>  preds_user <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb16-118"><a href="workbook-week-3-models-and-growth.html#cb16-118" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb16-119"><a href="workbook-week-3-models-and-growth.html#cb16-119" tabindex="-1"></a>      <span class="at">Year =</span> cod<span class="sc">$</span>Year,</span>
<span id="cb16-120"><a href="workbook-week-3-models-and-growth.html#cb16-120" tabindex="-1"></a>      <span class="at">t    =</span> cod<span class="sc">$</span>t,</span>
<span id="cb16-121"><a href="workbook-week-3-models-and-growth.html#cb16-121" tabindex="-1"></a>      <span class="at">Pred =</span> <span class="fu">logistic_fun</span>(cod<span class="sc">$</span>t, input<span class="sc">$</span>K, input<span class="sc">$</span>A, input<span class="sc">$</span>r)</span>
<span id="cb16-122"><a href="workbook-week-3-models-and-growth.html#cb16-122" tabindex="-1"></a>    )</span>
<span id="cb16-123"><a href="workbook-week-3-models-and-growth.html#cb16-123" tabindex="-1"></a>  })</span>
<span id="cb16-124"><a href="workbook-week-3-models-and-growth.html#cb16-124" tabindex="-1"></a></span>
<span id="cb16-125"><a href="workbook-week-3-models-and-growth.html#cb16-125" tabindex="-1"></a>  output<span class="sc">$</span>eqn_user <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb16-126"><a href="workbook-week-3-models-and-growth.html#cb16-126" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">&quot;Pop(t) = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>K, <span class="dv">3</span>),</span>
<span id="cb16-127"><a href="workbook-week-3-models-and-growth.html#cb16-127" tabindex="-1"></a>           <span class="st">&quot; / (1 + &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>A, <span class="dv">3</span>),</span>
<span id="cb16-128"><a href="workbook-week-3-models-and-growth.html#cb16-128" tabindex="-1"></a>           <span class="st">&quot; * exp(-&quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>r, <span class="dv">3</span>), <span class="st">&quot; * t))&quot;</span>)</span>
<span id="cb16-129"><a href="workbook-week-3-models-and-growth.html#cb16-129" tabindex="-1"></a>  })</span>
<span id="cb16-130"><a href="workbook-week-3-models-and-growth.html#cb16-130" tabindex="-1"></a></span>
<span id="cb16-131"><a href="workbook-week-3-models-and-growth.html#cb16-131" tabindex="-1"></a>  output<span class="sc">$</span>rmse_user <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb16-132"><a href="workbook-week-3-models-and-growth.html#cb16-132" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, <span class="fu">rmse</span>(cod<span class="sc">$</span>Pop, <span class="fu">preds_user</span>()<span class="sc">$</span>Pred))</span>
<span id="cb16-133"><a href="workbook-week-3-models-and-growth.html#cb16-133" tabindex="-1"></a>  })</span>
<span id="cb16-134"><a href="workbook-week-3-models-and-growth.html#cb16-134" tabindex="-1"></a></span>
<span id="cb16-135"><a href="workbook-week-3-models-and-growth.html#cb16-135" tabindex="-1"></a>  output<span class="sc">$</span>eqn_best <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb16-136"><a href="workbook-week-3-models-and-growth.html#cb16-136" tabindex="-1"></a>    <span class="cf">if</span> (has_best) {</span>
<span id="cb16-137"><a href="workbook-week-3-models-and-growth.html#cb16-137" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">&quot;Pop(t) = &quot;</span>, <span class="fu">signif</span>(best_par<span class="sc">$</span>K, <span class="dv">3</span>),</span>
<span id="cb16-138"><a href="workbook-week-3-models-and-growth.html#cb16-138" tabindex="-1"></a>             <span class="st">&quot; / (1 + &quot;</span>, <span class="fu">signif</span>(best_par<span class="sc">$</span>A, <span class="dv">3</span>),</span>
<span id="cb16-139"><a href="workbook-week-3-models-and-growth.html#cb16-139" tabindex="-1"></a>             <span class="st">&quot; * exp(-&quot;</span>, <span class="fu">signif</span>(best_par<span class="sc">$</span>r, <span class="dv">3</span>), <span class="st">&quot; * t))&quot;</span>)</span>
<span id="cb16-140"><a href="workbook-week-3-models-and-growth.html#cb16-140" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb16-141"><a href="workbook-week-3-models-and-growth.html#cb16-141" tabindex="-1"></a>      <span class="st">&quot;Best fit unavailable (nls did not converge). Try adjusting sliders.&quot;</span></span>
<span id="cb16-142"><a href="workbook-week-3-models-and-growth.html#cb16-142" tabindex="-1"></a>    }</span>
<span id="cb16-143"><a href="workbook-week-3-models-and-growth.html#cb16-143" tabindex="-1"></a>  })</span>
<span id="cb16-144"><a href="workbook-week-3-models-and-growth.html#cb16-144" tabindex="-1"></a></span>
<span id="cb16-145"><a href="workbook-week-3-models-and-growth.html#cb16-145" tabindex="-1"></a>  output<span class="sc">$</span>rmse_best <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb16-146"><a href="workbook-week-3-models-and-growth.html#cb16-146" tabindex="-1"></a>    <span class="cf">if</span> (has_best) <span class="fu">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, best_rmse) <span class="cf">else</span> <span class="st">&quot;—&quot;</span></span>
<span id="cb16-147"><a href="workbook-week-3-models-and-growth.html#cb16-147" tabindex="-1"></a>  })</span>
<span id="cb16-148"><a href="workbook-week-3-models-and-growth.html#cb16-148" tabindex="-1"></a></span>
<span id="cb16-149"><a href="workbook-week-3-models-and-growth.html#cb16-149" tabindex="-1"></a>  output<span class="sc">$</span>fitplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb16-150"><a href="workbook-week-3-models-and-growth.html#cb16-150" tabindex="-1"></a>    grid <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Year =</span> <span class="fu">seq</span>(<span class="fu">min</span>(cod<span class="sc">$</span>Year), <span class="fu">max</span>(cod<span class="sc">$</span>Year), <span class="at">length.out =</span> <span class="dv">400</span>)) <span class="sc">|&gt;</span></span>
<span id="cb16-151"><a href="workbook-week-3-models-and-growth.html#cb16-151" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">t =</span> Year <span class="sc">-</span> <span class="fu">min</span>(cod<span class="sc">$</span>Year),</span>
<span id="cb16-152"><a href="workbook-week-3-models-and-growth.html#cb16-152" tabindex="-1"></a>             <span class="at">Pred_user =</span> <span class="fu">logistic_fun</span>(t, input<span class="sc">$</span>K, input<span class="sc">$</span>A, input<span class="sc">$</span>r),</span>
<span id="cb16-153"><a href="workbook-week-3-models-and-growth.html#cb16-153" tabindex="-1"></a>             <span class="at">Pred_best =</span> <span class="cf">if</span> (has_best)</span>
<span id="cb16-154"><a href="workbook-week-3-models-and-growth.html#cb16-154" tabindex="-1"></a>               <span class="fu">logistic_fun</span>(t, best_par<span class="sc">$</span>K, best_par<span class="sc">$</span>A, best_par<span class="sc">$</span>r) <span class="cf">else</span> <span class="cn">NA_real_</span>)</span>
<span id="cb16-155"><a href="workbook-week-3-models-and-growth.html#cb16-155" tabindex="-1"></a></span>
<span id="cb16-156"><a href="workbook-week-3-models-and-growth.html#cb16-156" tabindex="-1"></a>    <span class="fu">ggplot</span>(cod, <span class="fu">aes</span>(Year, Pop)) <span class="sc">+</span></span>
<span id="cb16-157"><a href="workbook-week-3-models-and-growth.html#cb16-157" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb16-158"><a href="workbook-week-3-models-and-growth.html#cb16-158" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb16-159"><a href="workbook-week-3-models-and-growth.html#cb16-159" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> grid, <span class="fu">aes</span>(<span class="at">y =</span> Pred_user), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;#0072B2&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-160"><a href="workbook-week-3-models-and-growth.html#cb16-160" tabindex="-1"></a>      { <span class="cf">if</span> (has_best) <span class="fu">geom_line</span>(<span class="at">data =</span> grid, <span class="fu">aes</span>(<span class="at">y =</span> Pred_best),</span>
<span id="cb16-161"><a href="workbook-week-3-models-and-growth.html#cb16-161" tabindex="-1"></a>                                <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey40&quot;</span>) } <span class="sc">+</span></span>
<span id="cb16-162"><a href="workbook-week-3-models-and-growth.html#cb16-162" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb16-163"><a href="workbook-week-3-models-and-growth.html#cb16-163" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Cod Population with Interactive Logistic Fit (Base nls)&quot;</span>,</span>
<span id="cb16-164"><a href="workbook-week-3-models-and-growth.html#cb16-164" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb16-165"><a href="workbook-week-3-models-and-growth.html#cb16-165" tabindex="-1"></a>          <span class="st">&quot;K = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>K, <span class="dv">3</span>),</span>
<span id="cb16-166"><a href="workbook-week-3-models-and-growth.html#cb16-166" tabindex="-1"></a>          <span class="st">&quot;, A = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>A, <span class="dv">3</span>),</span>
<span id="cb16-167"><a href="workbook-week-3-models-and-growth.html#cb16-167" tabindex="-1"></a>          <span class="st">&quot;, r = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>r, <span class="dv">3</span>)</span>
<span id="cb16-168"><a href="workbook-week-3-models-and-growth.html#cb16-168" tabindex="-1"></a>        ),</span>
<span id="cb16-169"><a href="workbook-week-3-models-and-growth.html#cb16-169" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Population (units)&quot;</span></span>
<span id="cb16-170"><a href="workbook-week-3-models-and-growth.html#cb16-170" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb16-171"><a href="workbook-week-3-models-and-growth.html#cb16-171" tabindex="-1"></a>      <span class="fu">theme_classic</span>()</span>
<span id="cb16-172"><a href="workbook-week-3-models-and-growth.html#cb16-172" tabindex="-1"></a>  })</span>
<span id="cb16-173"><a href="workbook-week-3-models-and-growth.html#cb16-173" tabindex="-1"></a>}</span>
<span id="cb16-174"><a href="workbook-week-3-models-and-growth.html#cb16-174" tabindex="-1"></a></span>
<span id="cb16-175"><a href="workbook-week-3-models-and-growth.html#cb16-175" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
</div>
</div>
<div id="readme-logistic-growth-with-constant-harvesting-delayed-start-cod-population-shiny" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">D.5</span> Readme: Logistic Growth with Constant Harvesting &amp; Delayed Start — Cod Population (Shiny)<a href="workbook-week-3-models-and-growth.html#readme-logistic-growth-with-constant-harvesting-delayed-start-cod-population-shiny" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section introduces the <strong>Logistic Harvesting App</strong> designed to explore the <strong>Cod population dataset</strong> under a constant harvest rate with an optional <strong>delayed start</strong> to harvesting.<br />
The accompanying README and source code provide an overview of the app’s structure and highlight the key code components that power its functionality, including data loading, baseline logistic fitting (no harvest), dynamic simulation with harvesting, and visualization.</p>
<p>An interactive Shiny app for exploring a <strong>logistic growth model</strong> with <strong>constant harvesting <span class="math inline">\(H\)</span></strong> and a <strong>start delay</strong>. The app:
- Fits a baseline logistic curve with <strong>no harvest</strong> (via base R <code>nls</code>) to estimate <span class="math inline">\(K, A, r\)</span>.
- Simulates population trajectories when a constant harvest <span class="math inline">\(H\)</span> is applied starting at a user-chosen time.
- Reports whether the chosen <span class="math inline">\(H\)</span> is <strong>sustainable</strong> (i.e., <span class="math inline">\(H \le H_{\text{MSY}} = rK/4\)</span>) and shows the corresponding equilibrium when it exists.<br />
All displayed values and sliders use <strong>3 significant figures</strong>.</p>
<hr />
<div id="what-this-app-does-2" class="section level3 unnumbered hasAnchor">
<h3>What this app does<a href="workbook-week-3-models-and-growth.html#what-this-app-does-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Loads a cod population time series (<code>Year</code>, <code>Pop</code>) and creates a centered time variable<br />
<span class="math inline">\(t = \text{Year} - \min(\text{Year})\)</span></li>
<li>Fits a <strong>baseline logistic model</strong> (with <span class="math inline">\(H=0\)</span>) to estimate parameters:<br />
<span class="math display">\[
\text{Pop}(t) = \frac{K}{1 + A\,e^{-r t}}
\]</span></li>
<li>Simulates a <strong>harvested</strong> logistic system using an explicit time-step scheme:<br />
<span class="math display">\[
\frac{dP}{dt} = rP\left(1 - \frac{P}{K}\right) - H,\quad \text{with harvest starting at } t \ge H_{\text{start}}
\]</span></li>
<li>Lets users interactively adjust <strong>harvest rate <span class="math inline">\(H\)</span></strong>, <strong>initial population <span class="math inline">\(P_0\)</span></strong>, <strong>harvest start delay</strong>, and <strong>simulation length</strong><br />
</li>
<li>Displays the <strong>baseline logistic fit</strong> (dashed), the <strong>simulated trajectory</strong> (solid), and an <strong>equilibrium line</strong> if <span class="math inline">\(H \le H_{\text{MSY}}\)</span></li>
</ul>
<hr />
</div>
<div id="why-this-is-useful-2" class="section level3 unnumbered hasAnchor">
<h3>Why this is useful<a href="workbook-week-3-models-and-growth.html#why-this-is-useful-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Builds intuition for <strong>logistic dynamics</strong> under <strong>constant harvesting</strong>, including the concept of <strong>Maximum Sustainable Yield</strong> <span class="math inline">\(H_{\text{MSY}} = rK/4\)</span><br />
</li>
<li>Demonstrates how <strong>start timing</strong> of harvest changes outcomes (e.g., temporary recovery vs. immediate pressure)<br />
</li>
<li>Encourages exploration of <strong>parameter sensitivity</strong> and management trade-offs (e.g., higher <span class="math inline">\(H\)</span> vs. sustainability)</li>
</ul>
<hr />
</div>
<div id="requirements-2" class="section level3 unnumbered hasAnchor">
<h3>Requirements<a href="workbook-week-3-models-and-growth.html#requirements-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>R (≥ 4.2 recommended)</li>
<li>Packages: <code>shiny</code>, <code>tidyverse</code> (specifically <code>readr</code>, <code>dplyr</code>, <code>ggplot2</code>)</li>
</ul>
<p>Install once:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="workbook-week-3-models-and-growth.html#cb17-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;shiny&quot;</span>, <span class="st">&quot;tidyverse&quot;</span>))</span></code></pre></div>
<hr />
</div>
<div id="file-structure-2" class="section level3 unnumbered hasAnchor">
<h3>File structure<a href="workbook-week-3-models-and-growth.html#file-structure-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre class="(r,eval=false)"><code>#your-project/
#├─ app.R
#└─ data/
#   └─ cod_timeseries.csv   # Your dataset (optional; app falls back if missing)</code></pre>
<hr />
</div>
<div id="expected-csv-schema-2" class="section level3 unnumbered hasAnchor">
<h3>Expected CSV schema<a href="workbook-week-3-models-and-growth.html#expected-csv-schema-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Required columns:</strong> <code>Year</code>, <code>Pop</code></li>
<li><strong>Example (header + 5 rows):</strong></li>
</ul>
<p><strong>csv</strong></p>
<p>Year,Pop<br />
1960,2.31<br />
1961,2.45<br />
1962,2.38<br />
1963,2.52<br />
1964,2.60<br />
</p>
<blockquote>
<p><strong>Note:</strong> The app internally creates <span class="math inline">\(t = \text{Year} - \min(\text{Year})\)</span>. Years need not start at 0.</p>
</blockquote>
<hr />
</div>
<div id="how-to-run-2" class="section level3 unnumbered hasAnchor">
<h3>How to run<a href="workbook-week-3-models-and-growth.html#how-to-run-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From the project directory:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="workbook-week-3-models-and-growth.html#cb19-1" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runApp</span>(<span class="st">&quot;app_harvest_P0_delay.R&quot;</span>)</span></code></pre></div>
<p>Or open <code>app_harvest_P0_delay.R</code> in RStudio and click <strong>Run App</strong>.</p>
<hr />
</div>
<div id="app-controls-outputs-2" class="section level3 unnumbered hasAnchor">
<h3>App controls &amp; outputs<a href="workbook-week-3-models-and-growth.html#app-controls-outputs-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Sliders:</strong>
<ul>
<li><strong>H (harvest rate)</strong> – constant removal rate (units/year), applied only when time ≥ <strong>Harvest begins after</strong></li>
<li><strong>Harvest begins after (years)</strong> – delay before harvesting starts (applied on the time axis)</li>
<li><strong>P₀ (initial population)</strong> – starting population at <span class="math inline">\(t=0\)</span> for the simulation</li>
<li><strong>Simulation horizon (years)</strong> – total years to simulate forward from the first observed year</li>
</ul></li>
<li><strong>Fixed model parameters (from H=0 fit):</strong>
<ul>
<li><strong>K, r, A</strong> – parameters estimated by <code>nls</code> on the baseline logistic (no harvest)</li>
<li><strong>P₀ (baseline)</strong> – implied from <span class="math inline">\(K\)</span> and <span class="math inline">\(A\)</span> at <span class="math inline">\(t=0\)</span>, shown for reference</li>
<li><strong>H_MSY = rK/4</strong> – displayed for quick comparison with the chosen <span class="math inline">\(H\)</span></li>
</ul></li>
<li><strong>Outcome text:</strong><br />
Indicates if <span class="math inline">\(H \le H_{\text{MSY}}\)</span> (<strong>Sustainable</strong>) and shows the positive equilibrium value when it exists; otherwise warns of <strong>Unsustainable</strong> harvest (no positive equilibrium)</li>
</ul>
<p><strong>Plot layers:</strong>
- Points/line → observed data<br />
- Dashed line → baseline logistic fit (H = 0)<br />
- Solid line → simulated trajectory under chosen <span class="math inline">\(H\)</span>, <span class="math inline">\(P_0\)</span>, and delay<br />
- Vertical dashed red line → <strong>harvest start time</strong><br />
- Dot-dashed horizontal line → <strong>equilibrium</strong> (if sustainable and after harvest begins)</p>
<hr />
</div>
<div id="under-the-hood-key-functions-2" class="section level3 unnumbered hasAnchor">
<h3>Under the hood (key functions)<a href="workbook-week-3-models-and-growth.html#under-the-hood-key-functions-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Data load:</strong></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="workbook-week-3-models-and-growth.html#cb20-1" tabindex="-1"></a>load_cod_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb20-2"><a href="workbook-week-3-models-and-growth.html#cb20-2" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="st">&quot;data/cod_timeseries.csv&quot;</span></span>
<span id="cb20-3"><a href="workbook-week-3-models-and-growth.html#cb20-3" tabindex="-1"></a>  <span class="fu">read_csv</span>(path, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-4"><a href="workbook-week-3-models-and-growth.html#cb20-4" tabindex="-1"></a>    <span class="fu">select</span>(Year, Pop) <span class="sc">|&gt;</span></span>
<span id="cb20-5"><a href="workbook-week-3-models-and-growth.html#cb20-5" tabindex="-1"></a>    <span class="fu">arrange</span>(Year)</span>
<span id="cb20-6"><a href="workbook-week-3-models-and-growth.html#cb20-6" tabindex="-1"></a>}</span>
<span id="cb20-7"><a href="workbook-week-3-models-and-growth.html#cb20-7" tabindex="-1"></a>cod <span class="ot">&lt;-</span> <span class="fu">load_cod_data</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-8"><a href="workbook-week-3-models-and-growth.html#cb20-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">t =</span> Year <span class="sc">-</span> <span class="fu">min</span>(Year))</span></code></pre></div>
<ul>
<li><strong>Model definitions &amp; helper:</strong></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="workbook-week-3-models-and-growth.html#cb21-1" tabindex="-1"></a>logistic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(t, K, A, r) K <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> t))</span>
<span id="cb21-2"><a href="workbook-week-3-models-and-growth.html#cb21-2" tabindex="-1"></a>dP_dt        <span class="ot">&lt;-</span> <span class="cf">function</span>(P, r, K, H) r <span class="sc">*</span> P <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> P <span class="sc">/</span> K) <span class="sc">-</span> H</span>
<span id="cb21-3"><a href="workbook-week-3-models-and-growth.html#cb21-3" tabindex="-1"></a>rmse         <span class="ot">&lt;-</span> <span class="cf">function</span>(obs, pred) <span class="fu">sqrt</span>(<span class="fu">mean</span>((obs <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<ul>
<li><strong>Simulation with delayed harvest (explicit Euler):</strong></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="workbook-week-3-models-and-growth.html#cb22-1" tabindex="-1"></a>simulate_harvest <span class="ot">&lt;-</span> <span class="cf">function</span>(P0, r, K, H, <span class="at">H_start =</span> <span class="dv">0</span>,</span>
<span id="cb22-2"><a href="workbook-week-3-models-and-growth.html#cb22-2" tabindex="-1"></a>                             <span class="at">years =</span> <span class="dv">40</span>, <span class="at">dt =</span> <span class="fl">0.1</span>, <span class="at">year0 =</span> <span class="dv">0</span>) {</span>
<span id="cb22-3"><a href="workbook-week-3-models-and-growth.html#cb22-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">2</span>, <span class="fu">ceiling</span>(years <span class="sc">/</span> dt) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb22-4"><a href="workbook-week-3-models-and-growth.html#cb22-4" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, years, <span class="at">length.out =</span> n)</span>
<span id="cb22-5"><a href="workbook-week-3-models-and-growth.html#cb22-5" tabindex="-1"></a>  P <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb22-6"><a href="workbook-week-3-models-and-growth.html#cb22-6" tabindex="-1"></a>  P[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, P0)</span>
<span id="cb22-7"><a href="workbook-week-3-models-and-growth.html#cb22-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb22-8"><a href="workbook-week-3-models-and-growth.html#cb22-8" tabindex="-1"></a>    H_eff <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(t[i] <span class="sc">&gt;=</span> H_start, H, <span class="dv">0</span>)</span>
<span id="cb22-9"><a href="workbook-week-3-models-and-growth.html#cb22-9" tabindex="-1"></a>    P[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, P[i] <span class="sc">+</span> dt <span class="sc">*</span> <span class="fu">dP_dt</span>(P[i], r, K, H_eff))</span>
<span id="cb22-10"><a href="workbook-week-3-models-and-growth.html#cb22-10" tabindex="-1"></a>  }</span>
<span id="cb22-11"><a href="workbook-week-3-models-and-growth.html#cb22-11" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">time =</span> t, <span class="at">Year =</span> year0 <span class="sc">+</span> t, <span class="at">Pop =</span> P)</span>
<span id="cb22-12"><a href="workbook-week-3-models-and-growth.html#cb22-12" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li><strong>Baseline fit (H = 0) using base R <code>nls</code>:</strong></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="workbook-week-3-models-and-growth.html#cb23-1" tabindex="-1"></a>fit_logis <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb23-2"><a href="workbook-week-3-models-and-growth.html#cb23-2" tabindex="-1"></a>  <span class="fu">nls</span>(</span>
<span id="cb23-3"><a href="workbook-week-3-models-and-growth.html#cb23-3" tabindex="-1"></a>    Pop <span class="sc">~</span> K <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> t)),</span>
<span id="cb23-4"><a href="workbook-week-3-models-and-growth.html#cb23-4" tabindex="-1"></a>    <span class="at">data =</span> cod,</span>
<span id="cb23-5"><a href="workbook-week-3-models-and-growth.html#cb23-5" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">list</span>(<span class="at">K =</span> K_start, <span class="at">A =</span> A_start, <span class="at">r =</span> r_start),</span>
<span id="cb23-6"><a href="workbook-week-3-models-and-growth.html#cb23-6" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">nls.control</span>(<span class="at">maxiter =</span> <span class="dv">2000</span>, <span class="at">warnOnly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-7"><a href="workbook-week-3-models-and-growth.html#cb23-7" tabindex="-1"></a>  ),</span>
<span id="cb23-8"><a href="workbook-week-3-models-and-growth.html#cb23-8" tabindex="-1"></a>  <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NULL</span></span>
<span id="cb23-9"><a href="workbook-week-3-models-and-growth.html#cb23-9" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li><strong>Key derived quantities:</strong>
<ul>
<li><strong>Implied <span class="math inline">\(P_0\)</span> from baseline fit:</strong> <span class="math inline">\(P_{0,\text{fit}} = \dfrac{K}{1 + A}\)</span><br />
</li>
<li><strong>Maximum Sustainable Yield:</strong> <span class="math inline">\(H_{\text{MSY}} = \dfrac{rK}{4}\)</span><br />
</li>
<li><strong>Positive equilibrium under constant <span class="math inline">\(H\)</span> (when <span class="math inline">\(H \le rK/4\)</span>):</strong><br />
<span class="math display">\[
P^\* = \frac{K}{2}\left(1 + \sqrt{1 - \frac{4H}{rK}}\right)
\]</span>
(the larger, stable equilibrium used in the plot overlay)</li>
</ul></li>
</ul>
<hr />
</div>
<div id="customization-tips-2" class="section level3 unnumbered hasAnchor">
<h3>Customization tips<a href="workbook-week-3-models-and-growth.html#customization-tips-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Time step &amp; stability:</strong><br />
Adjust <code>dt</code> in <code>simulate_harvest()</code> (smaller <code>dt</code> → smoother/safer; larger <code>dt</code> → faster but may overshoot).</li>
<li><strong>Parameter ranges &amp; steps:</strong><br />
Tune slider <code>min/max/step</code> to match your data’s scale and desired precision.</li>
<li><strong>Starting values for baseline fit:</strong><br />
Modify <code>K_start</code>, <code>A_start</code>, <code>r_start</code> heuristics for more robust <code>nls</code> convergence.</li>
<li><strong>Appearance:</strong><br />
Update <code>labs(...)</code>, line types/colors, and <code>theme_*()</code> to match your visual style.</li>
</ul>
<hr />
</div>
<div id="troubleshooting-2" class="section level3 unnumbered hasAnchor">
<h3>Troubleshooting<a href="workbook-week-3-models-and-growth.html#troubleshooting-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>File missing error (<code>cod_timeseries.csv</code>)</strong><br />
Place your dataset at <code>data/cod_timeseries.csv</code> with columns <code>Year,Pop</code>.<br />
If documenting in Bookdown (and not actually running code): mark example chunks with <code>eval=FALSE</code>.<br />
For renders that must continue even without data, wrap loads in <code>if (file.exists(...))</code> or set chunk option <code>error=TRUE</code>.</p></li>
<li><p><strong><code>nls</code> fails to converge (baseline logistic)</strong></p>
<ul>
<li>Nudge slider guesses toward plausible values and hit <strong>Snap to Best Fit</strong> again.<br />
</li>
<li>Adjust starting values; constrain ranges closer to observed <span class="math inline">\(\text{Pop}\)</span>.<br />
</li>
<li>Increase <code>maxiter</code> or provide better-informed initial guesses.</li>
</ul></li>
<li><p><strong>Population collapses immediately under harvest</strong></p>
<ul>
<li>Check if <span class="math inline">\(H &gt; H_{\text{MSY}}\)</span>. If so, no positive equilibrium exists; consider lowering <span class="math inline">\(H\)</span> or delaying start longer.</li>
</ul></li>
<li><p><strong>Jittery simulation curve</strong></p>
<ul>
<li>Decrease <code>dt</code> in <code>simulate_harvest()</code> (e.g., from 0.1 to 0.05) for a smoother trajectory.</li>
</ul></li>
</ul>
<hr />
</div>
<div id="source-code-2" class="section level3 unnumbered hasAnchor">
<h3>Source Code<a href="workbook-week-3-models-and-growth.html#source-code-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="workbook-week-3-models-and-growth.html#cb24-1" tabindex="-1"></a><span class="co"># app_harvest_P0_delay.R</span></span>
<span id="cb24-2"><a href="workbook-week-3-models-and-growth.html#cb24-2" tabindex="-1"></a><span class="co"># Logistic growth with constant harvesting + delayed start (Adjust H, P₀, and start delay)</span></span>
<span id="cb24-3"><a href="workbook-week-3-models-and-growth.html#cb24-3" tabindex="-1"></a><span class="co"># All displayed values use 3 significant figures</span></span>
<span id="cb24-4"><a href="workbook-week-3-models-and-growth.html#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="workbook-week-3-models-and-growth.html#cb24-5" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb24-6"><a href="workbook-week-3-models-and-growth.html#cb24-6" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-7"><a href="workbook-week-3-models-and-growth.html#cb24-7" tabindex="-1"></a></span>
<span id="cb24-8"><a href="workbook-week-3-models-and-growth.html#cb24-8" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb24-9"><a href="workbook-week-3-models-and-growth.html#cb24-9" tabindex="-1"></a><span class="co"># Data load (with safe fallback)</span></span>
<span id="cb24-10"><a href="workbook-week-3-models-and-growth.html#cb24-10" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb24-11"><a href="workbook-week-3-models-and-growth.html#cb24-11" tabindex="-1"></a>load_cod_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb24-12"><a href="workbook-week-3-models-and-growth.html#cb24-12" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="st">&quot;data/cod_timeseries.csv&quot;</span></span>
<span id="cb24-13"><a href="workbook-week-3-models-and-growth.html#cb24-13" tabindex="-1"></a>  <span class="fu">read_csv</span>(path, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-14"><a href="workbook-week-3-models-and-growth.html#cb24-14" tabindex="-1"></a>    <span class="fu">select</span>(Year, Pop) <span class="sc">|&gt;</span></span>
<span id="cb24-15"><a href="workbook-week-3-models-and-growth.html#cb24-15" tabindex="-1"></a>    <span class="fu">arrange</span>(Year)</span>
<span id="cb24-16"><a href="workbook-week-3-models-and-growth.html#cb24-16" tabindex="-1"></a></span>
<span id="cb24-17"><a href="workbook-week-3-models-and-growth.html#cb24-17" tabindex="-1"></a>}</span>
<span id="cb24-18"><a href="workbook-week-3-models-and-growth.html#cb24-18" tabindex="-1"></a></span>
<span id="cb24-19"><a href="workbook-week-3-models-and-growth.html#cb24-19" tabindex="-1"></a>cod <span class="ot">&lt;-</span> <span class="fu">load_cod_data</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-20"><a href="workbook-week-3-models-and-growth.html#cb24-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">t =</span> Year <span class="sc">-</span> <span class="fu">min</span>(Year))</span>
<span id="cb24-21"><a href="workbook-week-3-models-and-growth.html#cb24-21" tabindex="-1"></a></span>
<span id="cb24-22"><a href="workbook-week-3-models-and-growth.html#cb24-22" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb24-23"><a href="workbook-week-3-models-and-growth.html#cb24-23" tabindex="-1"></a><span class="co"># Helpers</span></span>
<span id="cb24-24"><a href="workbook-week-3-models-and-growth.html#cb24-24" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb24-25"><a href="workbook-week-3-models-and-growth.html#cb24-25" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(obs, pred) <span class="fu">sqrt</span>(<span class="fu">mean</span>((obs <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb24-26"><a href="workbook-week-3-models-and-growth.html#cb24-26" tabindex="-1"></a>logistic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(t, K, A, r) K <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> t))</span>
<span id="cb24-27"><a href="workbook-week-3-models-and-growth.html#cb24-27" tabindex="-1"></a>dP_dt <span class="ot">&lt;-</span> <span class="cf">function</span>(P, r, K, H) r <span class="sc">*</span> P <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> P <span class="sc">/</span> K) <span class="sc">-</span> H</span>
<span id="cb24-28"><a href="workbook-week-3-models-and-growth.html#cb24-28" tabindex="-1"></a></span>
<span id="cb24-29"><a href="workbook-week-3-models-and-growth.html#cb24-29" tabindex="-1"></a><span class="co"># Delayed-harvest simulator: harvesting turns on when t &gt;= H_start</span></span>
<span id="cb24-30"><a href="workbook-week-3-models-and-growth.html#cb24-30" tabindex="-1"></a>simulate_harvest <span class="ot">&lt;-</span> <span class="cf">function</span>(P0, r, K, H, <span class="at">H_start =</span> <span class="dv">0</span>,</span>
<span id="cb24-31"><a href="workbook-week-3-models-and-growth.html#cb24-31" tabindex="-1"></a>                             <span class="at">years =</span> <span class="dv">40</span>, <span class="at">dt =</span> <span class="fl">0.1</span>, <span class="at">year0 =</span> <span class="dv">0</span>) {</span>
<span id="cb24-32"><a href="workbook-week-3-models-and-growth.html#cb24-32" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">2</span>, <span class="fu">ceiling</span>(years <span class="sc">/</span> dt) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb24-33"><a href="workbook-week-3-models-and-growth.html#cb24-33" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, years, <span class="at">length.out =</span> n)</span>
<span id="cb24-34"><a href="workbook-week-3-models-and-growth.html#cb24-34" tabindex="-1"></a>  P <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb24-35"><a href="workbook-week-3-models-and-growth.html#cb24-35" tabindex="-1"></a>  P[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, P0)</span>
<span id="cb24-36"><a href="workbook-week-3-models-and-growth.html#cb24-36" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb24-37"><a href="workbook-week-3-models-and-growth.html#cb24-37" tabindex="-1"></a>    H_eff <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(t[i] <span class="sc">&gt;=</span> H_start, H, <span class="dv">0</span>)</span>
<span id="cb24-38"><a href="workbook-week-3-models-and-growth.html#cb24-38" tabindex="-1"></a>    P[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, P[i] <span class="sc">+</span> dt <span class="sc">*</span> <span class="fu">dP_dt</span>(P[i], r, K, H_eff))</span>
<span id="cb24-39"><a href="workbook-week-3-models-and-growth.html#cb24-39" tabindex="-1"></a>  }</span>
<span id="cb24-40"><a href="workbook-week-3-models-and-growth.html#cb24-40" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">time =</span> t, <span class="at">Year =</span> year0 <span class="sc">+</span> t, <span class="at">Pop =</span> P)</span>
<span id="cb24-41"><a href="workbook-week-3-models-and-growth.html#cb24-41" tabindex="-1"></a>}</span>
<span id="cb24-42"><a href="workbook-week-3-models-and-growth.html#cb24-42" tabindex="-1"></a></span>
<span id="cb24-43"><a href="workbook-week-3-models-and-growth.html#cb24-43" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb24-44"><a href="workbook-week-3-models-and-growth.html#cb24-44" tabindex="-1"></a><span class="co"># Fit logistic with H = 0</span></span>
<span id="cb24-45"><a href="workbook-week-3-models-and-growth.html#cb24-45" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb24-46"><a href="workbook-week-3-models-and-growth.html#cb24-46" tabindex="-1"></a>pop_max <span class="ot">&lt;-</span> <span class="fu">max</span>(cod<span class="sc">$</span>Pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-47"><a href="workbook-week-3-models-and-growth.html#cb24-47" tabindex="-1"></a>pop_min <span class="ot">&lt;-</span> <span class="fu">min</span>(cod<span class="sc">$</span>Pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-48"><a href="workbook-week-3-models-and-growth.html#cb24-48" tabindex="-1"></a>K_start <span class="ot">&lt;-</span> <span class="fl">1.2</span> <span class="sc">*</span> pop_max</span>
<span id="cb24-49"><a href="workbook-week-3-models-and-growth.html#cb24-49" tabindex="-1"></a>r_start <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb24-50"><a href="workbook-week-3-models-and-growth.html#cb24-50" tabindex="-1"></a>P0_obs  <span class="ot">&lt;-</span> cod<span class="sc">$</span>Pop[cod<span class="sc">$</span>t <span class="sc">==</span> <span class="dv">0</span>][<span class="dv">1</span>]</span>
<span id="cb24-51"><a href="workbook-week-3-models-and-growth.html#cb24-51" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">is.na</span>(P0_obs)) P0_obs <span class="ot">&lt;-</span> pop_min</span>
<span id="cb24-52"><a href="workbook-week-3-models-and-growth.html#cb24-52" tabindex="-1"></a>A_start <span class="ot">&lt;-</span> (K_start <span class="sc">/</span> (P0_obs <span class="sc">+</span> <span class="fl">1e-6</span>)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb24-53"><a href="workbook-week-3-models-and-growth.html#cb24-53" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(A_start) <span class="sc">||</span> A_start <span class="sc">&lt;=</span> <span class="dv">0</span>) A_start <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-54"><a href="workbook-week-3-models-and-growth.html#cb24-54" tabindex="-1"></a></span>
<span id="cb24-55"><a href="workbook-week-3-models-and-growth.html#cb24-55" tabindex="-1"></a>fit_logis <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb24-56"><a href="workbook-week-3-models-and-growth.html#cb24-56" tabindex="-1"></a>  <span class="fu">nls</span>(</span>
<span id="cb24-57"><a href="workbook-week-3-models-and-growth.html#cb24-57" tabindex="-1"></a>    Pop <span class="sc">~</span> K <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> t)),</span>
<span id="cb24-58"><a href="workbook-week-3-models-and-growth.html#cb24-58" tabindex="-1"></a>    <span class="at">data =</span> cod,</span>
<span id="cb24-59"><a href="workbook-week-3-models-and-growth.html#cb24-59" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">list</span>(<span class="at">K =</span> K_start, <span class="at">A =</span> A_start, <span class="at">r =</span> r_start),</span>
<span id="cb24-60"><a href="workbook-week-3-models-and-growth.html#cb24-60" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">nls.control</span>(<span class="at">maxiter =</span> <span class="dv">2000</span>, <span class="at">warnOnly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-61"><a href="workbook-week-3-models-and-growth.html#cb24-61" tabindex="-1"></a>  ),</span>
<span id="cb24-62"><a href="workbook-week-3-models-and-growth.html#cb24-62" tabindex="-1"></a>  <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NULL</span></span>
<span id="cb24-63"><a href="workbook-week-3-models-and-growth.html#cb24-63" tabindex="-1"></a>)</span>
<span id="cb24-64"><a href="workbook-week-3-models-and-growth.html#cb24-64" tabindex="-1"></a></span>
<span id="cb24-65"><a href="workbook-week-3-models-and-growth.html#cb24-65" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(fit_logis)) {</span>
<span id="cb24-66"><a href="workbook-week-3-models-and-growth.html#cb24-66" tabindex="-1"></a>  pars <span class="ot">&lt;-</span> <span class="fu">as.list</span>(<span class="fu">coef</span>(fit_logis))</span>
<span id="cb24-67"><a href="workbook-week-3-models-and-growth.html#cb24-67" tabindex="-1"></a>  K_fix <span class="ot">&lt;-</span> pars<span class="sc">$</span>K</span>
<span id="cb24-68"><a href="workbook-week-3-models-and-growth.html#cb24-68" tabindex="-1"></a>  A_fix <span class="ot">&lt;-</span> pars<span class="sc">$</span>A</span>
<span id="cb24-69"><a href="workbook-week-3-models-and-growth.html#cb24-69" tabindex="-1"></a>  r_fix <span class="ot">&lt;-</span> pars<span class="sc">$</span>r</span>
<span id="cb24-70"><a href="workbook-week-3-models-and-growth.html#cb24-70" tabindex="-1"></a>  P0_fix <span class="ot">&lt;-</span> K_fix <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A_fix)</span>
<span id="cb24-71"><a href="workbook-week-3-models-and-growth.html#cb24-71" tabindex="-1"></a>  rmse_best <span class="ot">&lt;-</span> <span class="fu">rmse</span>(cod<span class="sc">$</span>Pop, <span class="fu">logistic_fun</span>(cod<span class="sc">$</span>t, K_fix, A_fix, r_fix))</span>
<span id="cb24-72"><a href="workbook-week-3-models-and-growth.html#cb24-72" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb24-73"><a href="workbook-week-3-models-and-growth.html#cb24-73" tabindex="-1"></a>  K_fix <span class="ot">&lt;-</span> K_start; A_fix <span class="ot">&lt;-</span> A_start; r_fix <span class="ot">&lt;-</span> r_start</span>
<span id="cb24-74"><a href="workbook-week-3-models-and-growth.html#cb24-74" tabindex="-1"></a>  P0_fix <span class="ot">&lt;-</span> K_fix <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A_fix)</span>
<span id="cb24-75"><a href="workbook-week-3-models-and-growth.html#cb24-75" tabindex="-1"></a>  rmse_best <span class="ot">&lt;-</span> <span class="cn">NA_real_</span></span>
<span id="cb24-76"><a href="workbook-week-3-models-and-growth.html#cb24-76" tabindex="-1"></a>}</span>
<span id="cb24-77"><a href="workbook-week-3-models-and-growth.html#cb24-77" tabindex="-1"></a></span>
<span id="cb24-78"><a href="workbook-week-3-models-and-growth.html#cb24-78" tabindex="-1"></a>H_MSY_fix <span class="ot">&lt;-</span> r_fix <span class="sc">*</span> K_fix <span class="sc">/</span> <span class="dv">4</span></span>
<span id="cb24-79"><a href="workbook-week-3-models-and-growth.html#cb24-79" tabindex="-1"></a></span>
<span id="cb24-80"><a href="workbook-week-3-models-and-growth.html#cb24-80" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb24-81"><a href="workbook-week-3-models-and-growth.html#cb24-81" tabindex="-1"></a><span class="co"># UI</span></span>
<span id="cb24-82"><a href="workbook-week-3-models-and-growth.html#cb24-82" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb24-83"><a href="workbook-week-3-models-and-growth.html#cb24-83" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb24-84"><a href="workbook-week-3-models-and-growth.html#cb24-84" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">&quot;Logistic Growth with Constant Harvesting (Adjust H, P₀, and Harvest Start)&quot;</span>),</span>
<span id="cb24-85"><a href="workbook-week-3-models-and-growth.html#cb24-85" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb24-86"><a href="workbook-week-3-models-and-growth.html#cb24-86" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb24-87"><a href="workbook-week-3-models-and-growth.html#cb24-87" tabindex="-1"></a>      <span class="fu">helpText</span>(<span class="fu">HTML</span>(</span>
<span id="cb24-88"><a href="workbook-week-3-models-and-growth.html#cb24-88" tabindex="-1"></a>        <span class="st">&quot;Baseline (H=0) fitted logistic model:&lt;br/&gt;&quot;</span>,</span>
<span id="cb24-89"><a href="workbook-week-3-models-and-growth.html#cb24-89" tabindex="-1"></a>        <span class="st">&quot;&lt;b&gt;Pop(t) = K / (1 + A e&lt;sup&gt;-r t&lt;/sup&gt;)&lt;/b&gt;&lt;br/&gt;&quot;</span>,</span>
<span id="cb24-90"><a href="workbook-week-3-models-and-growth.html#cb24-90" tabindex="-1"></a>        <span class="st">&quot;Adjust harvest rate &lt;b&gt;H&lt;/b&gt;, initial population &lt;b&gt;P&lt;sub&gt;0&lt;/sub&gt;&lt;/b&gt;, &quot;</span>,</span>
<span id="cb24-91"><a href="workbook-week-3-models-and-growth.html#cb24-91" tabindex="-1"></a>        <span class="st">&quot;and when harvesting begins.&quot;</span></span>
<span id="cb24-92"><a href="workbook-week-3-models-and-growth.html#cb24-92" tabindex="-1"></a>      )),</span>
<span id="cb24-93"><a href="workbook-week-3-models-and-growth.html#cb24-93" tabindex="-1"></a>      <span class="fu">sliderInput</span>(</span>
<span id="cb24-94"><a href="workbook-week-3-models-and-growth.html#cb24-94" tabindex="-1"></a>        <span class="st">&quot;H&quot;</span>, <span class="st">&quot;Harvest rate H (units/year):&quot;</span>,</span>
<span id="cb24-95"><a href="workbook-week-3-models-and-growth.html#cb24-95" tabindex="-1"></a>        <span class="at">min =</span> <span class="dv">0</span>,</span>
<span id="cb24-96"><a href="workbook-week-3-models-and-growth.html#cb24-96" tabindex="-1"></a>        <span class="at">max =</span> <span class="fu">signif</span>(<span class="fl">1.5</span> <span class="sc">*</span> H_MSY_fix, <span class="dv">3</span>),</span>
<span id="cb24-97"><a href="workbook-week-3-models-and-growth.html#cb24-97" tabindex="-1"></a>        <span class="at">value =</span> <span class="dv">0</span>,</span>
<span id="cb24-98"><a href="workbook-week-3-models-and-growth.html#cb24-98" tabindex="-1"></a>        <span class="at">step =</span> <span class="fu">signif</span>((<span class="fl">1.5</span> <span class="sc">*</span> H_MSY_fix) <span class="sc">/</span> <span class="dv">200</span>, <span class="dv">3</span>)</span>
<span id="cb24-99"><a href="workbook-week-3-models-and-growth.html#cb24-99" tabindex="-1"></a>      ),</span>
<span id="cb24-100"><a href="workbook-week-3-models-and-growth.html#cb24-100" tabindex="-1"></a>      <span class="fu">sliderInput</span>(</span>
<span id="cb24-101"><a href="workbook-week-3-models-and-growth.html#cb24-101" tabindex="-1"></a>        <span class="st">&quot;H_start&quot;</span>, <span class="st">&quot;Harvest begins after (years):&quot;</span>,</span>
<span id="cb24-102"><a href="workbook-week-3-models-and-growth.html#cb24-102" tabindex="-1"></a>        <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">100</span>, <span class="at">value =</span> <span class="dv">0</span>, <span class="at">step =</span> <span class="dv">1</span></span>
<span id="cb24-103"><a href="workbook-week-3-models-and-growth.html#cb24-103" tabindex="-1"></a>      ),</span>
<span id="cb24-104"><a href="workbook-week-3-models-and-growth.html#cb24-104" tabindex="-1"></a>      <span class="fu">sliderInput</span>(</span>
<span id="cb24-105"><a href="workbook-week-3-models-and-growth.html#cb24-105" tabindex="-1"></a>        <span class="st">&quot;P0&quot;</span>, <span class="st">&quot;Initial population P₀:&quot;</span>,</span>
<span id="cb24-106"><a href="workbook-week-3-models-and-growth.html#cb24-106" tabindex="-1"></a>        <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fu">signif</span>(<span class="fl">1.2</span> <span class="sc">*</span> K_fix, <span class="dv">3</span>),</span>
<span id="cb24-107"><a href="workbook-week-3-models-and-growth.html#cb24-107" tabindex="-1"></a>        <span class="at">value =</span> <span class="fu">signif</span>(P0_fix, <span class="dv">3</span>),</span>
<span id="cb24-108"><a href="workbook-week-3-models-and-growth.html#cb24-108" tabindex="-1"></a>        <span class="at">step =</span> <span class="fu">signif</span>((<span class="fl">1.2</span> <span class="sc">*</span> K_fix) <span class="sc">/</span> <span class="dv">200</span>, <span class="dv">3</span>)</span>
<span id="cb24-109"><a href="workbook-week-3-models-and-growth.html#cb24-109" tabindex="-1"></a>      ),</span>
<span id="cb24-110"><a href="workbook-week-3-models-and-growth.html#cb24-110" tabindex="-1"></a>      <span class="fu">sliderInput</span>(</span>
<span id="cb24-111"><a href="workbook-week-3-models-and-growth.html#cb24-111" tabindex="-1"></a>        <span class="st">&quot;years&quot;</span>, <span class="st">&quot;Simulation horizon (years):&quot;</span>,</span>
<span id="cb24-112"><a href="workbook-week-3-models-and-growth.html#cb24-112" tabindex="-1"></a>        <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">100</span>, <span class="at">value =</span> <span class="dv">40</span>, <span class="at">step =</span> <span class="dv">1</span></span>
<span id="cb24-113"><a href="workbook-week-3-models-and-growth.html#cb24-113" tabindex="-1"></a>      ),</span>
<span id="cb24-114"><a href="workbook-week-3-models-and-growth.html#cb24-114" tabindex="-1"></a>      <span class="fu">hr</span>(),</span>
<span id="cb24-115"><a href="workbook-week-3-models-and-growth.html#cb24-115" tabindex="-1"></a>      <span class="fu">strong</span>(<span class="st">&quot;Fixed model parameters (from H=0 fit):&quot;</span>),</span>
<span id="cb24-116"><a href="workbook-week-3-models-and-growth.html#cb24-116" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">div</span>(<span class="fu">HTML</span>(</span>
<span id="cb24-117"><a href="workbook-week-3-models-and-growth.html#cb24-117" tabindex="-1"></a>        <span class="fu">paste0</span>(</span>
<span id="cb24-118"><a href="workbook-week-3-models-and-growth.html#cb24-118" tabindex="-1"></a>          <span class="st">&quot;K = &quot;</span>, <span class="fu">signif</span>(K_fix, <span class="dv">3</span>), <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb24-119"><a href="workbook-week-3-models-and-growth.html#cb24-119" tabindex="-1"></a>          <span class="st">&quot;r = &quot;</span>, <span class="fu">signif</span>(r_fix, <span class="dv">3</span>), <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb24-120"><a href="workbook-week-3-models-and-growth.html#cb24-120" tabindex="-1"></a>          <span class="st">&quot;A = &quot;</span>, <span class="fu">signif</span>(A_fix, <span class="dv">3</span>),</span>
<span id="cb24-121"><a href="workbook-week-3-models-and-growth.html#cb24-121" tabindex="-1"></a>          <span class="st">&quot;  (implies baseline P&lt;sub&gt;0&lt;/sub&gt; = &quot;</span>, <span class="fu">signif</span>(P0_fix, <span class="dv">3</span>), <span class="st">&quot;)&lt;br/&gt;&quot;</span>,</span>
<span id="cb24-122"><a href="workbook-week-3-models-and-growth.html#cb24-122" tabindex="-1"></a>          <span class="st">&quot;H&lt;sub&gt;MSY&lt;/sub&gt; = &quot;</span>, <span class="fu">signif</span>(H_MSY_fix, <span class="dv">3</span>)</span>
<span id="cb24-123"><a href="workbook-week-3-models-and-growth.html#cb24-123" tabindex="-1"></a>        )</span>
<span id="cb24-124"><a href="workbook-week-3-models-and-growth.html#cb24-124" tabindex="-1"></a>      )),</span>
<span id="cb24-125"><a href="workbook-week-3-models-and-growth.html#cb24-125" tabindex="-1"></a>      <span class="fu">hr</span>(),</span>
<span id="cb24-126"><a href="workbook-week-3-models-and-growth.html#cb24-126" tabindex="-1"></a>      <span class="fu">strong</span>(<span class="st">&quot;Outcome:&quot;</span>),</span>
<span id="cb24-127"><a href="workbook-week-3-models-and-growth.html#cb24-127" tabindex="-1"></a>      <span class="fu">textOutput</span>(<span class="st">&quot;outcome_text&quot;</span>)</span>
<span id="cb24-128"><a href="workbook-week-3-models-and-growth.html#cb24-128" tabindex="-1"></a>    ),</span>
<span id="cb24-129"><a href="workbook-week-3-models-and-growth.html#cb24-129" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb24-130"><a href="workbook-week-3-models-and-growth.html#cb24-130" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">&quot;simplot&quot;</span>, <span class="at">height =</span> <span class="dv">520</span>),</span>
<span id="cb24-131"><a href="workbook-week-3-models-and-growth.html#cb24-131" tabindex="-1"></a>      <span class="fu">br</span>(),</span>
<span id="cb24-132"><a href="workbook-week-3-models-and-growth.html#cb24-132" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">small</span>(<span class="fu">em</span>(</span>
<span id="cb24-133"><a href="workbook-week-3-models-and-growth.html#cb24-133" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">&quot;data/cod_timeseries.csv&quot;</span>)) {</span>
<span id="cb24-134"><a href="workbook-week-3-models-and-growth.html#cb24-134" tabindex="-1"></a>          <span class="st">&quot;Loaded data/cod_timeseries.csv (points).&quot;</span></span>
<span id="cb24-135"><a href="workbook-week-3-models-and-growth.html#cb24-135" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb24-136"><a href="workbook-week-3-models-and-growth.html#cb24-136" tabindex="-1"></a>          <span class="st">&quot;No data/cod_timeseries.csv found — using synthetic demo data (points).&quot;</span></span>
<span id="cb24-137"><a href="workbook-week-3-models-and-growth.html#cb24-137" tabindex="-1"></a>        }</span>
<span id="cb24-138"><a href="workbook-week-3-models-and-growth.html#cb24-138" tabindex="-1"></a>      ))</span>
<span id="cb24-139"><a href="workbook-week-3-models-and-growth.html#cb24-139" tabindex="-1"></a>    )</span>
<span id="cb24-140"><a href="workbook-week-3-models-and-growth.html#cb24-140" tabindex="-1"></a>  )</span>
<span id="cb24-141"><a href="workbook-week-3-models-and-growth.html#cb24-141" tabindex="-1"></a>)</span>
<span id="cb24-142"><a href="workbook-week-3-models-and-growth.html#cb24-142" tabindex="-1"></a></span>
<span id="cb24-143"><a href="workbook-week-3-models-and-growth.html#cb24-143" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb24-144"><a href="workbook-week-3-models-and-growth.html#cb24-144" tabindex="-1"></a><span class="co"># Server</span></span>
<span id="cb24-145"><a href="workbook-week-3-models-and-growth.html#cb24-145" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb24-146"><a href="workbook-week-3-models-and-growth.html#cb24-146" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb24-147"><a href="workbook-week-3-models-and-growth.html#cb24-147" tabindex="-1"></a></span>
<span id="cb24-148"><a href="workbook-week-3-models-and-growth.html#cb24-148" tabindex="-1"></a>  msy <span class="ot">&lt;-</span> <span class="fu">reactive</span>({ r_fix <span class="sc">*</span> K_fix <span class="sc">/</span> <span class="dv">4</span> })</span>
<span id="cb24-149"><a href="workbook-week-3-models-and-growth.html#cb24-149" tabindex="-1"></a></span>
<span id="cb24-150"><a href="workbook-week-3-models-and-growth.html#cb24-150" tabindex="-1"></a>  outcome_label <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb24-151"><a href="workbook-week-3-models-and-growth.html#cb24-151" tabindex="-1"></a>    H <span class="ot">&lt;-</span> input<span class="sc">$</span>H</span>
<span id="cb24-152"><a href="workbook-week-3-models-and-growth.html#cb24-152" tabindex="-1"></a>    <span class="cf">if</span> (H <span class="sc">&lt;=</span> <span class="fu">msy</span>()) {</span>
<span id="cb24-153"><a href="workbook-week-3-models-and-growth.html#cb24-153" tabindex="-1"></a>      Pstar <span class="ot">&lt;-</span> (K_fix <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> H <span class="sc">/</span> (r_fix <span class="sc">*</span> K_fix)))</span>
<span id="cb24-154"><a href="workbook-week-3-models-and-growth.html#cb24-154" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">&quot;Sustainable (once harvesting starts): equilibrium ~ &quot;</span>, <span class="fu">signif</span>(Pstar, <span class="dv">3</span>))</span>
<span id="cb24-155"><a href="workbook-week-3-models-and-growth.html#cb24-155" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb24-156"><a href="workbook-week-3-models-and-growth.html#cb24-156" tabindex="-1"></a>      <span class="st">&quot;Unsustainable: no positive equilibrium (collapse likely once harvesting starts)&quot;</span></span>
<span id="cb24-157"><a href="workbook-week-3-models-and-growth.html#cb24-157" tabindex="-1"></a>    }</span>
<span id="cb24-158"><a href="workbook-week-3-models-and-growth.html#cb24-158" tabindex="-1"></a>  })</span>
<span id="cb24-159"><a href="workbook-week-3-models-and-growth.html#cb24-159" tabindex="-1"></a>  output<span class="sc">$</span>outcome_text <span class="ot">&lt;-</span> <span class="fu">renderText</span>(<span class="fu">outcome_label</span>())</span>
<span id="cb24-160"><a href="workbook-week-3-models-and-growth.html#cb24-160" tabindex="-1"></a></span>
<span id="cb24-161"><a href="workbook-week-3-models-and-growth.html#cb24-161" tabindex="-1"></a>  sim <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb24-162"><a href="workbook-week-3-models-and-growth.html#cb24-162" tabindex="-1"></a>    <span class="fu">simulate_harvest</span>(</span>
<span id="cb24-163"><a href="workbook-week-3-models-and-growth.html#cb24-163" tabindex="-1"></a>      <span class="at">P0 =</span> input<span class="sc">$</span>P0, <span class="at">r =</span> r_fix, <span class="at">K =</span> K_fix,</span>
<span id="cb24-164"><a href="workbook-week-3-models-and-growth.html#cb24-164" tabindex="-1"></a>      <span class="at">H =</span> input<span class="sc">$</span>H, <span class="at">H_start =</span> input<span class="sc">$</span>H_start,</span>
<span id="cb24-165"><a href="workbook-week-3-models-and-growth.html#cb24-165" tabindex="-1"></a>      <span class="at">years =</span> input<span class="sc">$</span>years, <span class="at">dt =</span> <span class="fl">0.1</span>,</span>
<span id="cb24-166"><a href="workbook-week-3-models-and-growth.html#cb24-166" tabindex="-1"></a>      <span class="at">year0 =</span> <span class="fu">min</span>(cod<span class="sc">$</span>Year)</span>
<span id="cb24-167"><a href="workbook-week-3-models-and-growth.html#cb24-167" tabindex="-1"></a>    )</span>
<span id="cb24-168"><a href="workbook-week-3-models-and-growth.html#cb24-168" tabindex="-1"></a>  })</span>
<span id="cb24-169"><a href="workbook-week-3-models-and-growth.html#cb24-169" tabindex="-1"></a></span>
<span id="cb24-170"><a href="workbook-week-3-models-and-growth.html#cb24-170" tabindex="-1"></a>  output<span class="sc">$</span>simplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb24-171"><a href="workbook-week-3-models-and-growth.html#cb24-171" tabindex="-1"></a>    df_sim <span class="ot">&lt;-</span> <span class="fu">sim</span>()</span>
<span id="cb24-172"><a href="workbook-week-3-models-and-growth.html#cb24-172" tabindex="-1"></a>    year_min <span class="ot">&lt;-</span> <span class="fu">min</span>(cod<span class="sc">$</span>Year)</span>
<span id="cb24-173"><a href="workbook-week-3-models-and-growth.html#cb24-173" tabindex="-1"></a>    year_max <span class="ot">&lt;-</span> year_min <span class="sc">+</span> input<span class="sc">$</span>years</span>
<span id="cb24-174"><a href="workbook-week-3-models-and-growth.html#cb24-174" tabindex="-1"></a></span>
<span id="cb24-175"><a href="workbook-week-3-models-and-growth.html#cb24-175" tabindex="-1"></a>    grid_fit <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb24-176"><a href="workbook-week-3-models-and-growth.html#cb24-176" tabindex="-1"></a>      <span class="at">Year =</span> <span class="fu">seq</span>(<span class="fu">min</span>(cod<span class="sc">$</span>Year), <span class="fu">max</span>(cod<span class="sc">$</span>Year), <span class="at">length.out =</span> <span class="dv">400</span>)</span>
<span id="cb24-177"><a href="workbook-week-3-models-and-growth.html#cb24-177" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb24-178"><a href="workbook-week-3-models-and-growth.html#cb24-178" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">t =</span> Year <span class="sc">-</span> <span class="fu">min</span>(cod<span class="sc">$</span>Year),</span>
<span id="cb24-179"><a href="workbook-week-3-models-and-growth.html#cb24-179" tabindex="-1"></a>             <span class="at">Pop_fit =</span> <span class="fu">logistic_fun</span>(t, K_fix, A_fix, r_fix))</span>
<span id="cb24-180"><a href="workbook-week-3-models-and-growth.html#cb24-180" tabindex="-1"></a></span>
<span id="cb24-181"><a href="workbook-week-3-models-and-growth.html#cb24-181" tabindex="-1"></a>    <span class="co"># Sustainable equilibrium value (if any) for the chosen H</span></span>
<span id="cb24-182"><a href="workbook-week-3-models-and-growth.html#cb24-182" tabindex="-1"></a>    eq_y <span class="ot">&lt;-</span> <span class="cn">NA_real_</span></span>
<span id="cb24-183"><a href="workbook-week-3-models-and-growth.html#cb24-183" tabindex="-1"></a>    <span class="cf">if</span> (input<span class="sc">$</span>H <span class="sc">&lt;=</span> <span class="fu">msy</span>()) {</span>
<span id="cb24-184"><a href="workbook-week-3-models-and-growth.html#cb24-184" tabindex="-1"></a>      eq_y <span class="ot">&lt;-</span> (K_fix <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> input<span class="sc">$</span>H <span class="sc">/</span> (r_fix <span class="sc">*</span> K_fix)))</span>
<span id="cb24-185"><a href="workbook-week-3-models-and-growth.html#cb24-185" tabindex="-1"></a>    }</span>
<span id="cb24-186"><a href="workbook-week-3-models-and-growth.html#cb24-186" tabindex="-1"></a></span>
<span id="cb24-187"><a href="workbook-week-3-models-and-growth.html#cb24-187" tabindex="-1"></a>    <span class="co"># Build plot</span></span>
<span id="cb24-188"><a href="workbook-week-3-models-and-growth.html#cb24-188" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-189"><a href="workbook-week-3-models-and-growth.html#cb24-189" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">data =</span> cod, <span class="fu">aes</span>(Year, Pop), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb24-190"><a href="workbook-week-3-models-and-growth.html#cb24-190" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> cod, <span class="fu">aes</span>(Year, Pop), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb24-191"><a href="workbook-week-3-models-and-growth.html#cb24-191" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> grid_fit, <span class="fu">aes</span>(Year, Pop_fit),</span>
<span id="cb24-192"><a href="workbook-week-3-models-and-growth.html#cb24-192" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey40&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb24-193"><a href="workbook-week-3-models-and-growth.html#cb24-193" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> df_sim, <span class="fu">aes</span>(Year, Pop),</span>
<span id="cb24-194"><a href="workbook-week-3-models-and-growth.html#cb24-194" tabindex="-1"></a>                <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">&quot;#0072B2&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-195"><a href="workbook-week-3-models-and-growth.html#cb24-195" tabindex="-1"></a>      <span class="co"># Harvest start marker</span></span>
<span id="cb24-196"><a href="workbook-week-3-models-and-growth.html#cb24-196" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> year_min <span class="sc">+</span> input<span class="sc">$</span>H_start,</span>
<span id="cb24-197"><a href="workbook-week-3-models-and-growth.html#cb24-197" tabindex="-1"></a>                 <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb24-198"><a href="workbook-week-3-models-and-growth.html#cb24-198" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb24-199"><a href="workbook-week-3-models-and-growth.html#cb24-199" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Logistic Growth with Constant Harvesting (Delayed Start)&quot;</span>,</span>
<span id="cb24-200"><a href="workbook-week-3-models-and-growth.html#cb24-200" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb24-201"><a href="workbook-week-3-models-and-growth.html#cb24-201" tabindex="-1"></a>          <span class="st">&quot;r = &quot;</span>, <span class="fu">signif</span>(r_fix, <span class="dv">3</span>),</span>
<span id="cb24-202"><a href="workbook-week-3-models-and-growth.html#cb24-202" tabindex="-1"></a>          <span class="st">&quot;, K = &quot;</span>, <span class="fu">signif</span>(K_fix, <span class="dv">3</span>),</span>
<span id="cb24-203"><a href="workbook-week-3-models-and-growth.html#cb24-203" tabindex="-1"></a>          <span class="st">&quot; | H = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>H, <span class="dv">3</span>),</span>
<span id="cb24-204"><a href="workbook-week-3-models-and-growth.html#cb24-204" tabindex="-1"></a>          <span class="st">&quot;, P₀ = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>P0, <span class="dv">3</span>),</span>
<span id="cb24-205"><a href="workbook-week-3-models-and-growth.html#cb24-205" tabindex="-1"></a>          <span class="st">&quot; | H starts at t = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>H_start, <span class="dv">3</span>), <span class="st">&quot; yr&quot;</span>,</span>
<span id="cb24-206"><a href="workbook-week-3-models-and-growth.html#cb24-206" tabindex="-1"></a>          <span class="st">&quot; | H_MSY = &quot;</span>, <span class="fu">signif</span>(<span class="fu">msy</span>(), <span class="dv">3</span>)</span>
<span id="cb24-207"><a href="workbook-week-3-models-and-growth.html#cb24-207" tabindex="-1"></a>        ),</span>
<span id="cb24-208"><a href="workbook-week-3-models-and-growth.html#cb24-208" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Population (units)&quot;</span></span>
<span id="cb24-209"><a href="workbook-week-3-models-and-growth.html#cb24-209" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb24-210"><a href="workbook-week-3-models-and-growth.html#cb24-210" tabindex="-1"></a>      <span class="fu">theme_classic</span>()</span>
<span id="cb24-211"><a href="workbook-week-3-models-and-growth.html#cb24-211" tabindex="-1"></a></span>
<span id="cb24-212"><a href="workbook-week-3-models-and-growth.html#cb24-212" tabindex="-1"></a>    <span class="co"># Add equilibrium segment only after harvesting begins and only if sustainable</span></span>
<span id="cb24-213"><a href="workbook-week-3-models-and-growth.html#cb24-213" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.finite</span>(eq_y)) {</span>
<span id="cb24-214"><a href="workbook-week-3-models-and-growth.html#cb24-214" tabindex="-1"></a>      x0 <span class="ot">&lt;-</span> year_min <span class="sc">+</span> input<span class="sc">$</span>H_start</span>
<span id="cb24-215"><a href="workbook-week-3-models-and-growth.html#cb24-215" tabindex="-1"></a>      x1 <span class="ot">&lt;-</span> year_max</span>
<span id="cb24-216"><a href="workbook-week-3-models-and-growth.html#cb24-216" tabindex="-1"></a>      <span class="cf">if</span> (x1 <span class="sc">&gt;</span> x0) {</span>
<span id="cb24-217"><a href="workbook-week-3-models-and-growth.html#cb24-217" tabindex="-1"></a>        p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="at">x =</span> x0, <span class="at">xend =</span> x1, <span class="at">y =</span> eq_y, <span class="at">yend =</span> eq_y,</span>
<span id="cb24-218"><a href="workbook-week-3-models-and-growth.html#cb24-218" tabindex="-1"></a>                              <span class="at">linetype =</span> <span class="st">&quot;dotdash&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>)</span>
<span id="cb24-219"><a href="workbook-week-3-models-and-growth.html#cb24-219" tabindex="-1"></a>      }</span>
<span id="cb24-220"><a href="workbook-week-3-models-and-growth.html#cb24-220" tabindex="-1"></a>    }</span>
<span id="cb24-221"><a href="workbook-week-3-models-and-growth.html#cb24-221" tabindex="-1"></a></span>
<span id="cb24-222"><a href="workbook-week-3-models-and-growth.html#cb24-222" tabindex="-1"></a>    p</span>
<span id="cb24-223"><a href="workbook-week-3-models-and-growth.html#cb24-223" tabindex="-1"></a>  })</span>
<span id="cb24-224"><a href="workbook-week-3-models-and-growth.html#cb24-224" tabindex="-1"></a>}</span>
<span id="cb24-225"><a href="workbook-week-3-models-and-growth.html#cb24-225" tabindex="-1"></a></span>
<span id="cb24-226"><a href="workbook-week-3-models-and-growth.html#cb24-226" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
</div>
</div>
<div id="readme-logistic-with-harvesting-stochastic-bad-year-shocks-cod-population-shiny" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">D.6</span> Readme: Logistic with Harvesting &amp; Stochastic Bad-Year Shocks — Cod Population (Shiny)<a href="workbook-week-3-models-and-growth.html#readme-logistic-with-harvesting-stochastic-bad-year-shocks-cod-population-shiny" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section introduces the <strong>Logistic Harvesting + Bad-Year App</strong> designed to explore the <strong>Cod population dataset</strong> under a constant harvest rate while incorporating <strong>stochastic “bad-year” shocks</strong> to the intrinsic growth rate <span class="math inline">\(r\)</span>.<br />
The accompanying README and source code provide an overview of the app’s structure and highlight the key code components that power its functionality, including data loading, baseline (no-harvest) logistic fitting, stochastic simulation with year-level shocks, and visualization (population + time-varying <span class="math inline">\(r_{\text{eff}}(t)\)</span>).</p>
<p>An interactive Shiny app for exploring a <strong>logistic growth model</strong> with <strong>constant harvesting <span class="math inline">\(H\)</span></strong> and <strong>random bad-year shocks</strong> that reduce <span class="math inline">\(r\)</span> in certain years. The app:
- Fits a baseline logistic curve with <strong>no harvest</strong> (via base R <code>nls</code>) to estimate <span class="math inline">\(K, A, r\)</span> and the implied <span class="math inline">\(P_0\)</span>.
- Simulates forward with a constant harvest <span class="math inline">\(H\)</span> while randomly designating “bad years” (probability <span class="math inline">\(p\)</span>) in which <span class="math inline">\(r\)</span> is scaled by <code>bad_factor</code> (e.g., 0.5 halves <span class="math inline">\(r\)</span>).<br />
- Plots <strong>population</strong> and the <strong>effective growth rate <span class="math inline">\(r_{\text{eff}}(t)\)</span></strong> in separate panels, and shades bad years for clarity.<br />
All displayed values and sliders use <strong>3 significant figures</strong>.</p>
<hr />
<div id="what-this-app-does-3" class="section level3 unnumbered hasAnchor">
<h3>What this app does<a href="workbook-week-3-models-and-growth.html#what-this-app-does-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Loads a cod population time series (<code>Year</code>, <code>Pop</code>) and creates a centered time variable<br />
<span class="math inline">\(t = \text{Year} - \min(\text{Year})\)</span></li>
<li>Fits a <strong>baseline logistic model</strong> (with <span class="math inline">\(H=0\)</span>) to estimate parameters:
<span class="math display">\[
\text{Pop}(t) = \frac{K}{1 + A\,e^{-r t}}, \quad P_0 = \frac{K}{1 + A}
\]</span></li>
<li>Simulates a harvested logistic with <strong>year-level shocks</strong> to <span class="math inline">\(r\)</span>:
<span class="math display">\[
\frac{dP}{dt} = r_{\text{eff}}(t)\,P\!\left(1 - \frac{P}{K}\right) - H,\quad
r_{\text{eff}}(t)=
\begin{cases}
r \cdot \text{bad\_factor}, &amp; \text{in bad years}\\
r, &amp; \text{otherwise}
\end{cases}
\]</span></li>
<li>Keeps <span class="math inline">\(P_0\)</span> <strong>fixed</strong> from the baseline fit (no slider for <span class="math inline">\(P_0\)</span>)<br />
</li>
<li>Displays two panels: <strong>Population</strong> (with observed data and baseline fit) and <strong><span class="math inline">\(r_{\text{eff}}(t)\)</span></strong> (with bad-year shading)</li>
</ul>
<hr />
</div>
<div id="why-this-is-useful-3" class="section level3 unnumbered hasAnchor">
<h3>Why this is useful<a href="workbook-week-3-models-and-growth.html#why-this-is-useful-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Builds intuition for <strong>environmental variability</strong> and <strong>harvest management</strong> under shocks to population growth<br />
</li>
<li>Illustrates how <strong>bad-year frequency</strong> and <strong>severity</strong> (via <code>bad_factor</code>) can reduce sustainable harvest and long-run abundance<br />
</li>
<li>Encourages exploration of risk (e.g., MSY under baseline vs. “bad-year” conditions)</li>
</ul>
<hr />
</div>
<div id="requirements-3" class="section level3 unnumbered hasAnchor">
<h3>Requirements<a href="workbook-week-3-models-and-growth.html#requirements-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>R (≥ 4.2 recommended)</li>
<li>Packages: <code>shiny</code>, <code>tidyverse</code> (specifically <code>readr</code>, <code>dplyr</code>, <code>ggplot2</code>)</li>
</ul>
<p>Install once:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="workbook-week-3-models-and-growth.html#cb25-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;shiny&quot;</span>, <span class="st">&quot;tidyverse&quot;</span>))</span></code></pre></div>
<hr />
</div>
<div id="file-structure-3" class="section level3 unnumbered hasAnchor">
<h3>File structure<a href="workbook-week-3-models-and-growth.html#file-structure-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre class="(r,eval=false)"><code>#your-project/
#├─ app.R
#└─ data/
#   └─ cod_timeseries.csv   # Your dataset (optional; app falls back if missing)</code></pre>
<hr />
</div>
<div id="expected-csv-schema-3" class="section level3 unnumbered hasAnchor">
<h3>Expected CSV schema<a href="workbook-week-3-models-and-growth.html#expected-csv-schema-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Required columns:</strong> <code>Year</code>, <code>Pop</code></li>
<li><strong>Example (header + 5 rows):</strong></li>
</ul>
<p><strong>csv</strong></p>
<p>Year,Pop<br />
1960,2.31<br />
1961,2.45<br />
1962,2.38<br />
1963,2.52<br />
1964,2.60<br />
</p>
<blockquote>
<p><strong>Note:</strong> The app internally creates <span class="math inline">\(t = \text{Year} - \min(\text{Year})\)</span>. Years need not start at 0.</p>
</blockquote>
<hr />
</div>
<div id="how-to-run-3" class="section level3 unnumbered hasAnchor">
<h3>How to run<a href="workbook-week-3-models-and-growth.html#how-to-run-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From the project directory:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="workbook-week-3-models-and-growth.html#cb27-1" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runApp</span>(<span class="st">&quot;app_logistic_harvest_badyears.R&quot;</span>)</span></code></pre></div>
<p>Or open <code>app_logistic_harvest_badyears.R</code> in RStudio and click <strong>Run App</strong>.</p>
<hr />
</div>
<div id="app-controls-outputs-3" class="section level3 unnumbered hasAnchor">
<h3>App controls &amp; outputs<a href="workbook-week-3-models-and-growth.html#app-controls-outputs-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Sliders &amp; inputs:</strong>
<ul>
<li><strong>H (harvest rate)</strong> – constant removal rate (units/year)</li>
<li><strong>Simulation horizon (years)</strong> – total simulated length from the first observed year</li>
<li><strong>Bad-year probability <span class="math inline">\(p\)</span></strong> – chance that any given year is “bad”</li>
<li><strong>Bad-year multiplier on r (<code>bad_factor</code>)</strong> – scales <span class="math inline">\(r\)</span> during bad years (e.g., 0.5 halves <span class="math inline">\(r\)</span>)</li>
<li><strong>Random seed</strong> – ensures reproducibility of bad-year draws</li>
<li><strong>Resimulate</strong> – redraws with the same settings (and seed)</li>
</ul></li>
<li><strong>Fixed parameters (from H = 0 fit):</strong>
<ul>
<li><strong>K, r, A</strong>, and implied <strong><span class="math inline">\(P_0 = K/(1 + A)\)</span></strong></li>
<li><strong>RMSE(H=0 fit)</strong> for the baseline logistic reference</li>
</ul></li>
<li><strong>Population panel:</strong>
<ul>
<li>Points/line → observed data</li>
<li>Dashed line → baseline logistic fit (H = 0)</li>
<li>Solid line → simulated population under chosen <span class="math inline">\(H\)</span>, <span class="math inline">\(p\)</span>, and <code>bad_factor</code></li>
<li>Light red shading → years drawn as “bad”</li>
</ul></li>
<li><strong><span class="math inline">\(r_{\text{eff}}(t)\)</span> panel:</strong>
<ul>
<li>Step plot of the time-varying effective growth rate</li>
<li>Dashed line at baseline <span class="math inline">\(r\)</span>, dotted line at <span class="math inline">\(r \cdot \text{bad\_factor}\)</span></li>
<li>Same bad-year shading for alignment with the population panel</li>
</ul></li>
</ul>
<hr />
</div>
<div id="under-the-hood-key-functions-3" class="section level3 unnumbered hasAnchor">
<h3>Under the hood (key functions)<a href="workbook-week-3-models-and-growth.html#under-the-hood-key-functions-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Data load &amp; baseline fit (H = 0):</strong></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="workbook-week-3-models-and-growth.html#cb28-1" tabindex="-1"></a>load_cod_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb28-2"><a href="workbook-week-3-models-and-growth.html#cb28-2" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="st">&quot;data/cod_timeseries.csv&quot;</span></span>
<span id="cb28-3"><a href="workbook-week-3-models-and-growth.html#cb28-3" tabindex="-1"></a>  <span class="fu">read_csv</span>(path, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-4"><a href="workbook-week-3-models-and-growth.html#cb28-4" tabindex="-1"></a>    <span class="fu">select</span>(Year, Pop) <span class="sc">|&gt;</span></span>
<span id="cb28-5"><a href="workbook-week-3-models-and-growth.html#cb28-5" tabindex="-1"></a>    <span class="fu">arrange</span>(Year)</span>
<span id="cb28-6"><a href="workbook-week-3-models-and-growth.html#cb28-6" tabindex="-1"></a>}</span>
<span id="cb28-7"><a href="workbook-week-3-models-and-growth.html#cb28-7" tabindex="-1"></a>cod <span class="ot">&lt;-</span> <span class="fu">load_cod_data</span>() <span class="sc">|&gt;</span></span>
<span id="cb28-8"><a href="workbook-week-3-models-and-growth.html#cb28-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">t =</span> Year <span class="sc">-</span> <span class="fu">min</span>(Year))</span>
<span id="cb28-9"><a href="workbook-week-3-models-and-growth.html#cb28-9" tabindex="-1"></a></span>
<span id="cb28-10"><a href="workbook-week-3-models-and-growth.html#cb28-10" tabindex="-1"></a>logistic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(t, K, A, r) K <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> t))</span>
<span id="cb28-11"><a href="workbook-week-3-models-and-growth.html#cb28-11" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(obs, pred) <span class="fu">sqrt</span>(<span class="fu">mean</span>((obs <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb28-12"><a href="workbook-week-3-models-and-growth.html#cb28-12" tabindex="-1"></a></span>
<span id="cb28-13"><a href="workbook-week-3-models-and-growth.html#cb28-13" tabindex="-1"></a><span class="co"># Heuristic starts, then nls to estimate K, A, r and implied P0</span></span></code></pre></div>
<ul>
<li><strong>Bad-year stochastic simulator (explicit Euler):</strong></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="workbook-week-3-models-and-growth.html#cb29-1" tabindex="-1"></a>simulate_badyears <span class="ot">&lt;-</span> <span class="cf">function</span>(P0, r, K, H, years, dt, year0,</span>
<span id="cb29-2"><a href="workbook-week-3-models-and-growth.html#cb29-2" tabindex="-1"></a>                              by_p, bad_factor, <span class="at">seed =</span> <span class="cn">NULL</span>,</span>
<span id="cb29-3"><a href="workbook-week-3-models-and-growth.html#cb29-3" tabindex="-1"></a>                              <span class="at">clip_nonneg =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb29-4"><a href="workbook-week-3-models-and-growth.html#cb29-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(seed)) <span class="fu">set.seed</span>(seed)</span>
<span id="cb29-5"><a href="workbook-week-3-models-and-growth.html#cb29-5" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">2</span>, <span class="fu">ceiling</span>(years <span class="sc">/</span> dt) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb29-6"><a href="workbook-week-3-models-and-growth.html#cb29-6" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, years, <span class="at">length.out =</span> n)</span>
<span id="cb29-7"><a href="workbook-week-3-models-and-growth.html#cb29-7" tabindex="-1"></a>  P <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n); P[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, P0)</span>
<span id="cb29-8"><a href="workbook-week-3-models-and-growth.html#cb29-8" tabindex="-1"></a></span>
<span id="cb29-9"><a href="workbook-week-3-models-and-growth.html#cb29-9" tabindex="-1"></a>  yrs_idx <span class="ot">&lt;-</span> <span class="fu">floor</span>(t)                     <span class="co"># year index from start (0,1,2,...)</span></span>
<span id="cb29-10"><a href="workbook-week-3-models-and-growth.html#cb29-10" tabindex="-1"></a>  unique_years <span class="ot">&lt;-</span> <span class="fu">unique</span>(yrs_idx)</span>
<span id="cb29-11"><a href="workbook-week-3-models-and-growth.html#cb29-11" tabindex="-1"></a>  bad_year_flags <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">length</span>(unique_years), <span class="dv">1</span>, by_p) <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb29-12"><a href="workbook-week-3-models-and-growth.html#cb29-12" tabindex="-1"></a>  <span class="fu">names</span>(bad_year_flags) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(unique_years)</span>
<span id="cb29-13"><a href="workbook-week-3-models-and-growth.html#cb29-13" tabindex="-1"></a></span>
<span id="cb29-14"><a href="workbook-week-3-models-and-growth.html#cb29-14" tabindex="-1"></a>  r_eff_vec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb29-15"><a href="workbook-week-3-models-and-growth.html#cb29-15" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb29-16"><a href="workbook-week-3-models-and-growth.html#cb29-16" tabindex="-1"></a>    yk <span class="ot">&lt;-</span> <span class="fu">as.character</span>(yrs_idx[i])</span>
<span id="cb29-17"><a href="workbook-week-3-models-and-growth.html#cb29-17" tabindex="-1"></a>    r_eff <span class="ot">&lt;-</span> <span class="cf">if</span> (bad_year_flags[yk]) r <span class="sc">*</span> bad_factor <span class="cf">else</span> r</span>
<span id="cb29-18"><a href="workbook-week-3-models-and-growth.html#cb29-18" tabindex="-1"></a>    r_eff_vec[i] <span class="ot">&lt;-</span> r_eff</span>
<span id="cb29-19"><a href="workbook-week-3-models-and-growth.html#cb29-19" tabindex="-1"></a>    dP <span class="ot">&lt;-</span> r_eff <span class="sc">*</span> P[i] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> P[i] <span class="sc">/</span> K) <span class="sc">-</span> H</span>
<span id="cb29-20"><a href="workbook-week-3-models-and-growth.html#cb29-20" tabindex="-1"></a>    P[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cf">if</span> (clip_nonneg) <span class="fu">max</span>(<span class="dv">0</span>, P[i] <span class="sc">+</span> dt <span class="sc">*</span> dP) <span class="cf">else</span> P[i] <span class="sc">+</span> dt <span class="sc">*</span> dP</span>
<span id="cb29-21"><a href="workbook-week-3-models-and-growth.html#cb29-21" tabindex="-1"></a>  }</span>
<span id="cb29-22"><a href="workbook-week-3-models-and-growth.html#cb29-22" tabindex="-1"></a>  <span class="co"># last step r_eff</span></span>
<span id="cb29-23"><a href="workbook-week-3-models-and-growth.html#cb29-23" tabindex="-1"></a>  yk_last <span class="ot">&lt;-</span> <span class="fu">as.character</span>(yrs_idx[n])</span>
<span id="cb29-24"><a href="workbook-week-3-models-and-growth.html#cb29-24" tabindex="-1"></a>  r_eff_vec[n] <span class="ot">&lt;-</span> <span class="cf">if</span> (bad_year_flags[yk_last]) r <span class="sc">*</span> bad_factor <span class="cf">else</span> r</span>
<span id="cb29-25"><a href="workbook-week-3-models-and-growth.html#cb29-25" tabindex="-1"></a></span>
<span id="cb29-26"><a href="workbook-week-3-models-and-growth.html#cb29-26" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb29-27"><a href="workbook-week-3-models-and-growth.html#cb29-27" tabindex="-1"></a>    <span class="at">time     =</span> t,</span>
<span id="cb29-28"><a href="workbook-week-3-models-and-growth.html#cb29-28" tabindex="-1"></a>    <span class="at">Year     =</span> year0 <span class="sc">+</span> t,</span>
<span id="cb29-29"><a href="workbook-week-3-models-and-growth.html#cb29-29" tabindex="-1"></a>    <span class="at">Pop      =</span> P,</span>
<span id="cb29-30"><a href="workbook-week-3-models-and-growth.html#cb29-30" tabindex="-1"></a>    <span class="at">r_eff    =</span> r_eff_vec,</span>
<span id="cb29-31"><a href="workbook-week-3-models-and-growth.html#cb29-31" tabindex="-1"></a>    <span class="at">bad_year =</span> bad_year_flags[<span class="fu">as.character</span>(<span class="fu">floor</span>(t))]</span>
<span id="cb29-32"><a href="workbook-week-3-models-and-growth.html#cb29-32" tabindex="-1"></a>  )</span>
<span id="cb29-33"><a href="workbook-week-3-models-and-growth.html#cb29-33" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li><strong>MSY intuition (not directly enforced):</strong><br />
Baseline <span class="math inline">\(H_{\text{MSY}} = rK/4\)</span>. Under bad years, the <strong>effective</strong> sustainable harvest is typically lower (e.g., <span class="math inline">\(r \cdot \text{bad\_factor}\)</span> suggests a reduced MSY for those years).</li>
</ul>
<hr />
</div>
<div id="customization-tips-3" class="section level3 unnumbered hasAnchor">
<h3>Customization tips<a href="workbook-week-3-models-and-growth.html#customization-tips-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Shock granularity:</strong><br />
Switch from <strong>yearly</strong> shocks (<code>floor(t)</code>) to <strong>seasonal</strong> or <strong>multi-year</strong> by changing how you map <code>t</code> to shock periods.</li>
<li><strong>Intensity &amp; probability:</strong><br />
Adjust <code>bad_factor</code> bounds and <code>by_p</code> slider to match your case study.</li>
<li><strong>Numerics:</strong><br />
Decrease <code>dt</code> for smoother/stabler integration; increase for speed (with caution).</li>
<li><strong>Visualization:</strong><br />
Modify shading color/alpha, line types, and themes to your house style.</li>
</ul>
<hr />
</div>
<div id="troubleshooting-3" class="section level3 unnumbered hasAnchor">
<h3>Troubleshooting<a href="workbook-week-3-models-and-growth.html#troubleshooting-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>File missing error (<code>cod_timeseries.csv</code>)</strong><br />
Place your dataset at <code>data/cod_timeseries.csv</code> with columns <code>Year,Pop</code>.<br />
If documenting in Bookdown (and not executing), mark example chunks with <code>eval=FALSE</code>.<br />
To build despite missing files, check existence and return a placeholder tibble, or set chunk option <code>error=TRUE</code>.</p></li>
<li><p><strong><code>nls</code> fails to converge (baseline fit)</strong></p>
<ul>
<li>Adjust initial guesses <span class="math inline">\(K_{\text{start}}, A_{\text{start}}, r_{\text{start}}\)</span> to match your data scale.<br />
</li>
<li>Constrain ranges/clean outliers; increase <code>maxiter</code>.</li>
</ul></li>
<li><p><strong>Population drops to zero quickly</strong></p>
<ul>
<li>High <span class="math inline">\(H\)</span>, frequent/severe bad years (high <code>by_p</code>, low <code>bad_factor</code>), or both.<br />
</li>
<li>Reduce <span class="math inline">\(H\)</span> and/or bad-year severity/frequency.</li>
</ul></li>
<li><p><strong>Reproducibility of shocks</strong></p>
<ul>
<li>Set the <strong>Random seed</strong> control; click <strong>Resimulate</strong> to refresh with same settings.</li>
</ul></li>
</ul>
<hr />
</div>
<div id="source-code-3" class="section level3 hasAnchor" number="9.6.1">
<h3><span class="header-section-number">D.6.1</span> Source Code<a href="workbook-week-3-models-and-growth.html#source-code-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="workbook-week-3-models-and-growth.html#cb30-1" tabindex="-1"></a><span class="co"># app_logistic_harvest_badyears.R</span></span>
<span id="cb30-2"><a href="workbook-week-3-models-and-growth.html#cb30-2" tabindex="-1"></a><span class="co"># Logistic growth with harvesting and stochastic &quot;bad-year&quot; shocks to r</span></span>
<span id="cb30-3"><a href="workbook-week-3-models-and-growth.html#cb30-3" tabindex="-1"></a><span class="co"># - P0 is fixed from the H = 0 logistic fit (no slider)</span></span>
<span id="cb30-4"><a href="workbook-week-3-models-and-growth.html#cb30-4" tabindex="-1"></a><span class="co"># - Second panel shows r_eff(t) over time</span></span>
<span id="cb30-5"><a href="workbook-week-3-models-and-growth.html#cb30-5" tabindex="-1"></a><span class="co"># - All displayed values use 3 significant figures</span></span>
<span id="cb30-6"><a href="workbook-week-3-models-and-growth.html#cb30-6" tabindex="-1"></a></span>
<span id="cb30-7"><a href="workbook-week-3-models-and-growth.html#cb30-7" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb30-8"><a href="workbook-week-3-models-and-growth.html#cb30-8" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb30-9"><a href="workbook-week-3-models-and-growth.html#cb30-9" tabindex="-1"></a></span>
<span id="cb30-10"><a href="workbook-week-3-models-and-growth.html#cb30-10" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb30-11"><a href="workbook-week-3-models-and-growth.html#cb30-11" tabindex="-1"></a><span class="co"># Data load (with safe fallback)</span></span>
<span id="cb30-12"><a href="workbook-week-3-models-and-growth.html#cb30-12" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb30-13"><a href="workbook-week-3-models-and-growth.html#cb30-13" tabindex="-1"></a>load_cod_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb30-14"><a href="workbook-week-3-models-and-growth.html#cb30-14" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="st">&quot;data/cod_timeseries.csv&quot;</span></span>
<span id="cb30-15"><a href="workbook-week-3-models-and-growth.html#cb30-15" tabindex="-1"></a>  <span class="fu">read_csv</span>(path, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-16"><a href="workbook-week-3-models-and-growth.html#cb30-16" tabindex="-1"></a>    <span class="fu">select</span>(Year, Pop) <span class="sc">|&gt;</span></span>
<span id="cb30-17"><a href="workbook-week-3-models-and-growth.html#cb30-17" tabindex="-1"></a>    <span class="fu">arrange</span>(Year)</span>
<span id="cb30-18"><a href="workbook-week-3-models-and-growth.html#cb30-18" tabindex="-1"></a></span>
<span id="cb30-19"><a href="workbook-week-3-models-and-growth.html#cb30-19" tabindex="-1"></a>}</span>
<span id="cb30-20"><a href="workbook-week-3-models-and-growth.html#cb30-20" tabindex="-1"></a></span>
<span id="cb30-21"><a href="workbook-week-3-models-and-growth.html#cb30-21" tabindex="-1"></a>cod <span class="ot">&lt;-</span> <span class="fu">load_cod_data</span>() <span class="sc">|&gt;</span></span>
<span id="cb30-22"><a href="workbook-week-3-models-and-growth.html#cb30-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">t =</span> Year <span class="sc">-</span> <span class="fu">min</span>(Year))  <span class="co"># centered time for fitting</span></span>
<span id="cb30-23"><a href="workbook-week-3-models-and-growth.html#cb30-23" tabindex="-1"></a></span>
<span id="cb30-24"><a href="workbook-week-3-models-and-growth.html#cb30-24" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb30-25"><a href="workbook-week-3-models-and-growth.html#cb30-25" tabindex="-1"></a><span class="co"># Helpers</span></span>
<span id="cb30-26"><a href="workbook-week-3-models-and-growth.html#cb30-26" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb30-27"><a href="workbook-week-3-models-and-growth.html#cb30-27" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(obs, pred) <span class="fu">sqrt</span>(<span class="fu">mean</span>((obs <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb30-28"><a href="workbook-week-3-models-and-growth.html#cb30-28" tabindex="-1"></a>logistic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(t, K, A, r) K <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> t))</span>
<span id="cb30-29"><a href="workbook-week-3-models-and-growth.html#cb30-29" tabindex="-1"></a></span>
<span id="cb30-30"><a href="workbook-week-3-models-and-growth.html#cb30-30" tabindex="-1"></a><span class="co"># Euler integration of dP/dt = r_eff(t)*P*(1 - P/K) - H</span></span>
<span id="cb30-31"><a href="workbook-week-3-models-and-growth.html#cb30-31" tabindex="-1"></a><span class="co"># Returns full series including r_eff(t) and bad_year flag</span></span>
<span id="cb30-32"><a href="workbook-week-3-models-and-growth.html#cb30-32" tabindex="-1"></a>simulate_badyears <span class="ot">&lt;-</span> <span class="cf">function</span>(P0, r, K, H, years, dt, year0,</span>
<span id="cb30-33"><a href="workbook-week-3-models-and-growth.html#cb30-33" tabindex="-1"></a>                              by_p, bad_factor, <span class="at">seed =</span> <span class="cn">NULL</span>,</span>
<span id="cb30-34"><a href="workbook-week-3-models-and-growth.html#cb30-34" tabindex="-1"></a>                              <span class="at">clip_nonneg =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb30-35"><a href="workbook-week-3-models-and-growth.html#cb30-35" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(seed)) <span class="fu">set.seed</span>(seed)</span>
<span id="cb30-36"><a href="workbook-week-3-models-and-growth.html#cb30-36" tabindex="-1"></a></span>
<span id="cb30-37"><a href="workbook-week-3-models-and-growth.html#cb30-37" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">2</span>, <span class="fu">ceiling</span>(years <span class="sc">/</span> dt) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb30-38"><a href="workbook-week-3-models-and-growth.html#cb30-38" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, years, <span class="at">length.out =</span> n)</span>
<span id="cb30-39"><a href="workbook-week-3-models-and-growth.html#cb30-39" tabindex="-1"></a>  P <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb30-40"><a href="workbook-week-3-models-and-growth.html#cb30-40" tabindex="-1"></a>  P[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, P0)</span>
<span id="cb30-41"><a href="workbook-week-3-models-and-growth.html#cb30-41" tabindex="-1"></a></span>
<span id="cb30-42"><a href="workbook-week-3-models-and-growth.html#cb30-42" tabindex="-1"></a>  <span class="co"># Year indices (0,1,2,...) from start; draw bad years once per whole year</span></span>
<span id="cb30-43"><a href="workbook-week-3-models-and-growth.html#cb30-43" tabindex="-1"></a>  yrs_idx <span class="ot">&lt;-</span> <span class="fu">floor</span>(t)</span>
<span id="cb30-44"><a href="workbook-week-3-models-and-growth.html#cb30-44" tabindex="-1"></a>  unique_years <span class="ot">&lt;-</span> <span class="fu">unique</span>(yrs_idx)</span>
<span id="cb30-45"><a href="workbook-week-3-models-and-growth.html#cb30-45" tabindex="-1"></a>  bad_year_flags <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">length</span>(unique_years), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> by_p) <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb30-46"><a href="workbook-week-3-models-and-growth.html#cb30-46" tabindex="-1"></a>  <span class="fu">names</span>(bad_year_flags) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(unique_years)</span>
<span id="cb30-47"><a href="workbook-week-3-models-and-growth.html#cb30-47" tabindex="-1"></a></span>
<span id="cb30-48"><a href="workbook-week-3-models-and-growth.html#cb30-48" tabindex="-1"></a>  r_eff_vec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb30-49"><a href="workbook-week-3-models-and-growth.html#cb30-49" tabindex="-1"></a></span>
<span id="cb30-50"><a href="workbook-week-3-models-and-growth.html#cb30-50" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb30-51"><a href="workbook-week-3-models-and-growth.html#cb30-51" tabindex="-1"></a>    yk <span class="ot">&lt;-</span> <span class="fu">as.character</span>(yrs_idx[i])</span>
<span id="cb30-52"><a href="workbook-week-3-models-and-growth.html#cb30-52" tabindex="-1"></a>    r_eff <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(bad_year_flags[yk]) <span class="sc">&amp;&amp;</span> bad_year_flags[yk]) r <span class="sc">*</span> bad_factor <span class="cf">else</span> r</span>
<span id="cb30-53"><a href="workbook-week-3-models-and-growth.html#cb30-53" tabindex="-1"></a>    r_eff_vec[i] <span class="ot">&lt;-</span> r_eff</span>
<span id="cb30-54"><a href="workbook-week-3-models-and-growth.html#cb30-54" tabindex="-1"></a>    dP <span class="ot">&lt;-</span> r_eff <span class="sc">*</span> P[i] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> P[i] <span class="sc">/</span> K) <span class="sc">-</span> H</span>
<span id="cb30-55"><a href="workbook-week-3-models-and-growth.html#cb30-55" tabindex="-1"></a>    P[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> P[i] <span class="sc">+</span> dt <span class="sc">*</span> dP</span>
<span id="cb30-56"><a href="workbook-week-3-models-and-growth.html#cb30-56" tabindex="-1"></a>    <span class="cf">if</span> (clip_nonneg) P[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, P[i <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb30-57"><a href="workbook-week-3-models-and-growth.html#cb30-57" tabindex="-1"></a>  }</span>
<span id="cb30-58"><a href="workbook-week-3-models-and-growth.html#cb30-58" tabindex="-1"></a>  <span class="co"># last step r_eff</span></span>
<span id="cb30-59"><a href="workbook-week-3-models-and-growth.html#cb30-59" tabindex="-1"></a>  yk_last <span class="ot">&lt;-</span> <span class="fu">as.character</span>(yrs_idx[n])</span>
<span id="cb30-60"><a href="workbook-week-3-models-and-growth.html#cb30-60" tabindex="-1"></a>  r_eff_vec[n] <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(bad_year_flags[yk_last]) <span class="sc">&amp;&amp;</span> bad_year_flags[yk_last]) r <span class="sc">*</span> bad_factor <span class="cf">else</span> r</span>
<span id="cb30-61"><a href="workbook-week-3-models-and-growth.html#cb30-61" tabindex="-1"></a></span>
<span id="cb30-62"><a href="workbook-week-3-models-and-growth.html#cb30-62" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb30-63"><a href="workbook-week-3-models-and-growth.html#cb30-63" tabindex="-1"></a>    <span class="at">time     =</span> t,</span>
<span id="cb30-64"><a href="workbook-week-3-models-and-growth.html#cb30-64" tabindex="-1"></a>    <span class="at">Year     =</span> year0 <span class="sc">+</span> t,</span>
<span id="cb30-65"><a href="workbook-week-3-models-and-growth.html#cb30-65" tabindex="-1"></a>    <span class="at">Pop      =</span> P,</span>
<span id="cb30-66"><a href="workbook-week-3-models-and-growth.html#cb30-66" tabindex="-1"></a>    <span class="at">r_eff    =</span> r_eff_vec,</span>
<span id="cb30-67"><a href="workbook-week-3-models-and-growth.html#cb30-67" tabindex="-1"></a>    <span class="at">bad_year =</span> bad_year_flags[<span class="fu">as.character</span>(<span class="fu">floor</span>(t))]</span>
<span id="cb30-68"><a href="workbook-week-3-models-and-growth.html#cb30-68" tabindex="-1"></a>  )</span>
<span id="cb30-69"><a href="workbook-week-3-models-and-growth.html#cb30-69" tabindex="-1"></a>}</span>
<span id="cb30-70"><a href="workbook-week-3-models-and-growth.html#cb30-70" tabindex="-1"></a></span>
<span id="cb30-71"><a href="workbook-week-3-models-and-growth.html#cb30-71" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb30-72"><a href="workbook-week-3-models-and-growth.html#cb30-72" tabindex="-1"></a><span class="co"># Fit baseline (H = 0) logistic for defaults (K, r, A, implied P0)</span></span>
<span id="cb30-73"><a href="workbook-week-3-models-and-growth.html#cb30-73" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb30-74"><a href="workbook-week-3-models-and-growth.html#cb30-74" tabindex="-1"></a>pop_max <span class="ot">&lt;-</span> <span class="fu">max</span>(cod<span class="sc">$</span>Pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-75"><a href="workbook-week-3-models-and-growth.html#cb30-75" tabindex="-1"></a>pop_min <span class="ot">&lt;-</span> <span class="fu">min</span>(cod<span class="sc">$</span>Pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-76"><a href="workbook-week-3-models-and-growth.html#cb30-76" tabindex="-1"></a>K_start <span class="ot">&lt;-</span> <span class="fl">1.2</span> <span class="sc">*</span> pop_max</span>
<span id="cb30-77"><a href="workbook-week-3-models-and-growth.html#cb30-77" tabindex="-1"></a>r_start <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb30-78"><a href="workbook-week-3-models-and-growth.html#cb30-78" tabindex="-1"></a>P0_obs  <span class="ot">&lt;-</span> cod<span class="sc">$</span>Pop[cod<span class="sc">$</span>t <span class="sc">==</span> <span class="dv">0</span>][<span class="dv">1</span>]</span>
<span id="cb30-79"><a href="workbook-week-3-models-and-growth.html#cb30-79" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">is.na</span>(P0_obs)) P0_obs <span class="ot">&lt;-</span> pop_min</span>
<span id="cb30-80"><a href="workbook-week-3-models-and-growth.html#cb30-80" tabindex="-1"></a>A_start <span class="ot">&lt;-</span> (K_start <span class="sc">/</span> (P0_obs <span class="sc">+</span> <span class="fl">1e-6</span>)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb30-81"><a href="workbook-week-3-models-and-growth.html#cb30-81" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(A_start) <span class="sc">||</span> A_start <span class="sc">&lt;=</span> <span class="dv">0</span>) A_start <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-82"><a href="workbook-week-3-models-and-growth.html#cb30-82" tabindex="-1"></a></span>
<span id="cb30-83"><a href="workbook-week-3-models-and-growth.html#cb30-83" tabindex="-1"></a>fit_logis <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb30-84"><a href="workbook-week-3-models-and-growth.html#cb30-84" tabindex="-1"></a>  <span class="fu">nls</span>(</span>
<span id="cb30-85"><a href="workbook-week-3-models-and-growth.html#cb30-85" tabindex="-1"></a>    Pop <span class="sc">~</span> K <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> t)),</span>
<span id="cb30-86"><a href="workbook-week-3-models-and-growth.html#cb30-86" tabindex="-1"></a>    <span class="at">data =</span> cod,</span>
<span id="cb30-87"><a href="workbook-week-3-models-and-growth.html#cb30-87" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">list</span>(<span class="at">K =</span> K_start, <span class="at">A =</span> A_start, <span class="at">r =</span> r_start),</span>
<span id="cb30-88"><a href="workbook-week-3-models-and-growth.html#cb30-88" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">nls.control</span>(<span class="at">maxiter =</span> <span class="dv">2000</span>, <span class="at">warnOnly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-89"><a href="workbook-week-3-models-and-growth.html#cb30-89" tabindex="-1"></a>  ),</span>
<span id="cb30-90"><a href="workbook-week-3-models-and-growth.html#cb30-90" tabindex="-1"></a>  <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NULL</span></span>
<span id="cb30-91"><a href="workbook-week-3-models-and-growth.html#cb30-91" tabindex="-1"></a>)</span>
<span id="cb30-92"><a href="workbook-week-3-models-and-growth.html#cb30-92" tabindex="-1"></a></span>
<span id="cb30-93"><a href="workbook-week-3-models-and-growth.html#cb30-93" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(fit_logis)) {</span>
<span id="cb30-94"><a href="workbook-week-3-models-and-growth.html#cb30-94" tabindex="-1"></a>  pars <span class="ot">&lt;-</span> <span class="fu">as.list</span>(<span class="fu">coef</span>(fit_logis))</span>
<span id="cb30-95"><a href="workbook-week-3-models-and-growth.html#cb30-95" tabindex="-1"></a>  K_fix <span class="ot">&lt;-</span> pars<span class="sc">$</span>K</span>
<span id="cb30-96"><a href="workbook-week-3-models-and-growth.html#cb30-96" tabindex="-1"></a>  A_fix <span class="ot">&lt;-</span> pars<span class="sc">$</span>A</span>
<span id="cb30-97"><a href="workbook-week-3-models-and-growth.html#cb30-97" tabindex="-1"></a>  r_fix <span class="ot">&lt;-</span> pars<span class="sc">$</span>r</span>
<span id="cb30-98"><a href="workbook-week-3-models-and-growth.html#cb30-98" tabindex="-1"></a>  P0_fix <span class="ot">&lt;-</span> K_fix <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A_fix) <span class="co"># implied initial pop at t=0 (H=0 fit)</span></span>
<span id="cb30-99"><a href="workbook-week-3-models-and-growth.html#cb30-99" tabindex="-1"></a>  rmse_best <span class="ot">&lt;-</span> <span class="fu">rmse</span>(cod<span class="sc">$</span>Pop, <span class="fu">logistic_fun</span>(cod<span class="sc">$</span>t, K_fix, A_fix, r_fix))</span>
<span id="cb30-100"><a href="workbook-week-3-models-and-growth.html#cb30-100" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb30-101"><a href="workbook-week-3-models-and-growth.html#cb30-101" tabindex="-1"></a>  K_fix <span class="ot">&lt;-</span> K_start; A_fix <span class="ot">&lt;-</span> A_start; r_fix <span class="ot">&lt;-</span> r_start</span>
<span id="cb30-102"><a href="workbook-week-3-models-and-growth.html#cb30-102" tabindex="-1"></a>  P0_fix <span class="ot">&lt;-</span> K_fix <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> A_fix)</span>
<span id="cb30-103"><a href="workbook-week-3-models-and-growth.html#cb30-103" tabindex="-1"></a>  rmse_best <span class="ot">&lt;-</span> <span class="cn">NA_real_</span></span>
<span id="cb30-104"><a href="workbook-week-3-models-and-growth.html#cb30-104" tabindex="-1"></a>}</span>
<span id="cb30-105"><a href="workbook-week-3-models-and-growth.html#cb30-105" tabindex="-1"></a></span>
<span id="cb30-106"><a href="workbook-week-3-models-and-growth.html#cb30-106" tabindex="-1"></a>H_MSY_baseline <span class="ot">&lt;-</span> r_fix <span class="sc">*</span> K_fix <span class="sc">/</span> <span class="dv">4</span>  <span class="co"># for slider scaling</span></span>
<span id="cb30-107"><a href="workbook-week-3-models-and-growth.html#cb30-107" tabindex="-1"></a></span>
<span id="cb30-108"><a href="workbook-week-3-models-and-growth.html#cb30-108" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb30-109"><a href="workbook-week-3-models-and-growth.html#cb30-109" tabindex="-1"></a><span class="co"># UI</span></span>
<span id="cb30-110"><a href="workbook-week-3-models-and-growth.html#cb30-110" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb30-111"><a href="workbook-week-3-models-and-growth.html#cb30-111" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb30-112"><a href="workbook-week-3-models-and-growth.html#cb30-112" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">&quot;Logistic with Harvesting and Random Bad-Year Shocks to r (P₀ fixed)&quot;</span>),</span>
<span id="cb30-113"><a href="workbook-week-3-models-and-growth.html#cb30-113" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb30-114"><a href="workbook-week-3-models-and-growth.html#cb30-114" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb30-115"><a href="workbook-week-3-models-and-growth.html#cb30-115" tabindex="-1"></a>      <span class="fu">helpText</span>(<span class="fu">HTML</span>(</span>
<span id="cb30-116"><a href="workbook-week-3-models-and-growth.html#cb30-116" tabindex="-1"></a>        <span class="st">&quot;Model: &lt;b&gt;dP/dt = r_eff(t) P (1 - P/K) - H&lt;/b&gt;&lt;br/&gt;&quot;</span>,</span>
<span id="cb30-117"><a href="workbook-week-3-models-and-growth.html#cb30-117" tabindex="-1"></a>        <span class="st">&quot;Baseline &lt;i&gt;r&lt;/i&gt;, &lt;i&gt;K&lt;/i&gt;, and &lt;i&gt;P&lt;sub&gt;0&lt;/sub&gt;&lt;/i&gt; from the H=0 logistic fit.&lt;br/&gt;&quot;</span>,</span>
<span id="cb30-118"><a href="workbook-week-3-models-and-growth.html#cb30-118" tabindex="-1"></a>        <span class="st">&quot;Each year is &#39;bad&#39; with probability &lt;i&gt;p&lt;/i&gt;; then &lt;i&gt;r&lt;/i&gt; is scaled by &lt;i&gt;bad_factor&lt;/i&gt;.&quot;</span></span>
<span id="cb30-119"><a href="workbook-week-3-models-and-growth.html#cb30-119" tabindex="-1"></a>      )),</span>
<span id="cb30-120"><a href="workbook-week-3-models-and-growth.html#cb30-120" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;H&quot;</span>, <span class="st">&quot;Harvest rate H (units/year):&quot;</span>,</span>
<span id="cb30-121"><a href="workbook-week-3-models-and-growth.html#cb30-121" tabindex="-1"></a>                  <span class="at">min =</span> <span class="dv">0</span>,</span>
<span id="cb30-122"><a href="workbook-week-3-models-and-growth.html#cb30-122" tabindex="-1"></a>                  <span class="at">max =</span> <span class="fu">signif</span>(<span class="fl">1.5</span> <span class="sc">*</span> H_MSY_baseline, <span class="dv">3</span>),</span>
<span id="cb30-123"><a href="workbook-week-3-models-and-growth.html#cb30-123" tabindex="-1"></a>                  <span class="at">value =</span> <span class="fu">signif</span>(<span class="fl">0.5</span> <span class="sc">*</span> H_MSY_baseline, <span class="dv">3</span>),</span>
<span id="cb30-124"><a href="workbook-week-3-models-and-growth.html#cb30-124" tabindex="-1"></a>                  <span class="at">step =</span> <span class="fu">signif</span>((<span class="fl">1.5</span> <span class="sc">*</span> H_MSY_baseline) <span class="sc">/</span> <span class="dv">200</span>, <span class="dv">3</span>)),</span>
<span id="cb30-125"><a href="workbook-week-3-models-and-growth.html#cb30-125" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;years&quot;</span>, <span class="st">&quot;Simulation horizon (years):&quot;</span>,</span>
<span id="cb30-126"><a href="workbook-week-3-models-and-growth.html#cb30-126" tabindex="-1"></a>                  <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">100</span>, <span class="at">value =</span> <span class="dv">40</span>, <span class="at">step =</span> <span class="dv">1</span>),</span>
<span id="cb30-127"><a href="workbook-week-3-models-and-growth.html#cb30-127" tabindex="-1"></a>      <span class="fu">hr</span>(),</span>
<span id="cb30-128"><a href="workbook-week-3-models-and-growth.html#cb30-128" tabindex="-1"></a>      <span class="fu">strong</span>(<span class="st">&quot;Bad-year process on r:&quot;</span>),</span>
<span id="cb30-129"><a href="workbook-week-3-models-and-growth.html#cb30-129" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;by_p&quot;</span>, <span class="st">&quot;Bad-year probability p (per year):&quot;</span>,</span>
<span id="cb30-130"><a href="workbook-week-3-models-and-growth.html#cb30-130" tabindex="-1"></a>                  <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fl">0.7</span>, <span class="at">value =</span> <span class="fl">0.25</span>, <span class="at">step =</span> <span class="fl">0.01</span>),</span>
<span id="cb30-131"><a href="workbook-week-3-models-and-growth.html#cb30-131" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;bad_factor&quot;</span>, <span class="st">&quot;Bad-year multiplier on r (e.g., 0.5 halves r):&quot;</span>,</span>
<span id="cb30-132"><a href="workbook-week-3-models-and-growth.html#cb30-132" tabindex="-1"></a>                  <span class="at">min =</span> <span class="fl">0.05</span>, <span class="at">max =</span> <span class="fl">1.0</span>, <span class="at">value =</span> <span class="fl">0.5</span>, <span class="at">step =</span> <span class="fl">0.01</span>),</span>
<span id="cb30-133"><a href="workbook-week-3-models-and-growth.html#cb30-133" tabindex="-1"></a>      <span class="fu">numericInput</span>(<span class="st">&quot;seed&quot;</span>, <span class="st">&quot;Random seed&quot;</span>, <span class="at">value =</span> <span class="dv">123</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">step =</span> <span class="dv">1</span>),</span>
<span id="cb30-134"><a href="workbook-week-3-models-and-growth.html#cb30-134" tabindex="-1"></a>      <span class="fu">actionButton</span>(<span class="st">&quot;resim&quot;</span>, <span class="st">&quot;Resimulate&quot;</span>),</span>
<span id="cb30-135"><a href="workbook-week-3-models-and-growth.html#cb30-135" tabindex="-1"></a>      <span class="fu">hr</span>(),</span>
<span id="cb30-136"><a href="workbook-week-3-models-and-growth.html#cb30-136" tabindex="-1"></a>      <span class="fu">strong</span>(<span class="st">&quot;Fixed parameters (from H = 0 fit):&quot;</span>),</span>
<span id="cb30-137"><a href="workbook-week-3-models-and-growth.html#cb30-137" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">div</span>(<span class="fu">HTML</span>(</span>
<span id="cb30-138"><a href="workbook-week-3-models-and-growth.html#cb30-138" tabindex="-1"></a>        <span class="fu">paste0</span>(</span>
<span id="cb30-139"><a href="workbook-week-3-models-and-growth.html#cb30-139" tabindex="-1"></a>          <span class="st">&quot;K = &quot;</span>, <span class="fu">signif</span>(K_fix, <span class="dv">3</span>), <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb30-140"><a href="workbook-week-3-models-and-growth.html#cb30-140" tabindex="-1"></a>          <span class="st">&quot;r = &quot;</span>, <span class="fu">signif</span>(r_fix, <span class="dv">3</span>), <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb30-141"><a href="workbook-week-3-models-and-growth.html#cb30-141" tabindex="-1"></a>          <span class="st">&quot;A = &quot;</span>, <span class="fu">signif</span>(A_fix, <span class="dv">3</span>),</span>
<span id="cb30-142"><a href="workbook-week-3-models-and-growth.html#cb30-142" tabindex="-1"></a>          <span class="st">&quot;  ⇒ P&lt;sub&gt;0&lt;/sub&gt; (fixed) = &quot;</span>, <span class="fu">signif</span>(P0_fix, <span class="dv">3</span>), <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb30-143"><a href="workbook-week-3-models-and-growth.html#cb30-143" tabindex="-1"></a>          <span class="st">&quot;RMSE(H=0 fit) = &quot;</span>, <span class="fu">ifelse</span>(<span class="fu">is.na</span>(rmse_best), <span class="st">&quot;—&quot;</span>, <span class="fu">sprintf</span>(<span class="st">&#39;%.3f&#39;</span>, rmse_best))</span>
<span id="cb30-144"><a href="workbook-week-3-models-and-growth.html#cb30-144" tabindex="-1"></a>        )</span>
<span id="cb30-145"><a href="workbook-week-3-models-and-growth.html#cb30-145" tabindex="-1"></a>      ))</span>
<span id="cb30-146"><a href="workbook-week-3-models-and-growth.html#cb30-146" tabindex="-1"></a>    ),</span>
<span id="cb30-147"><a href="workbook-week-3-models-and-growth.html#cb30-147" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb30-148"><a href="workbook-week-3-models-and-growth.html#cb30-148" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">&quot;popplot&quot;</span>, <span class="at">height =</span> <span class="dv">420</span>),</span>
<span id="cb30-149"><a href="workbook-week-3-models-and-growth.html#cb30-149" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">&quot;rplot&quot;</span>,  <span class="at">height =</span> <span class="dv">200</span>),</span>
<span id="cb30-150"><a href="workbook-week-3-models-and-growth.html#cb30-150" tabindex="-1"></a>      <span class="fu">br</span>(),</span>
<span id="cb30-151"><a href="workbook-week-3-models-and-growth.html#cb30-151" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">small</span>(<span class="fu">em</span>(</span>
<span id="cb30-152"><a href="workbook-week-3-models-and-growth.html#cb30-152" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">&quot;data/cod_timeseries.csv&quot;</span>)) {</span>
<span id="cb30-153"><a href="workbook-week-3-models-and-growth.html#cb30-153" tabindex="-1"></a>          <span class="st">&quot;Loaded data/cod_timeseries.csv (points).&quot;</span></span>
<span id="cb30-154"><a href="workbook-week-3-models-and-growth.html#cb30-154" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb30-155"><a href="workbook-week-3-models-and-growth.html#cb30-155" tabindex="-1"></a>          <span class="st">&quot;No data/cod_timeseries.csv found — using synthetic demo data.&quot;</span></span>
<span id="cb30-156"><a href="workbook-week-3-models-and-growth.html#cb30-156" tabindex="-1"></a>        }</span>
<span id="cb30-157"><a href="workbook-week-3-models-and-growth.html#cb30-157" tabindex="-1"></a>      ))</span>
<span id="cb30-158"><a href="workbook-week-3-models-and-growth.html#cb30-158" tabindex="-1"></a>    )</span>
<span id="cb30-159"><a href="workbook-week-3-models-and-growth.html#cb30-159" tabindex="-1"></a>  )</span>
<span id="cb30-160"><a href="workbook-week-3-models-and-growth.html#cb30-160" tabindex="-1"></a>)</span>
<span id="cb30-161"><a href="workbook-week-3-models-and-growth.html#cb30-161" tabindex="-1"></a></span>
<span id="cb30-162"><a href="workbook-week-3-models-and-growth.html#cb30-162" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb30-163"><a href="workbook-week-3-models-and-growth.html#cb30-163" tabindex="-1"></a><span class="co"># Server</span></span>
<span id="cb30-164"><a href="workbook-week-3-models-and-growth.html#cb30-164" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb30-165"><a href="workbook-week-3-models-and-growth.html#cb30-165" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb30-166"><a href="workbook-week-3-models-and-growth.html#cb30-166" tabindex="-1"></a></span>
<span id="cb30-167"><a href="workbook-week-3-models-and-growth.html#cb30-167" tabindex="-1"></a>  <span class="co"># Resimulation trigger to redraw with same settings</span></span>
<span id="cb30-168"><a href="workbook-week-3-models-and-growth.html#cb30-168" tabindex="-1"></a>  bump <span class="ot">&lt;-</span> <span class="fu">reactiveVal</span>(<span class="dv">0</span>)</span>
<span id="cb30-169"><a href="workbook-week-3-models-and-growth.html#cb30-169" tabindex="-1"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>resim, { <span class="fu">bump</span>(<span class="fu">isolate</span>(<span class="fu">bump</span>()) <span class="sc">+</span> <span class="dv">1</span>) })</span>
<span id="cb30-170"><a href="workbook-week-3-models-and-growth.html#cb30-170" tabindex="-1"></a></span>
<span id="cb30-171"><a href="workbook-week-3-models-and-growth.html#cb30-171" tabindex="-1"></a>  <span class="co"># Simulate with bad-year shocks (P0 fixed)</span></span>
<span id="cb30-172"><a href="workbook-week-3-models-and-growth.html#cb30-172" tabindex="-1"></a>  sim_df <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb30-173"><a href="workbook-week-3-models-and-growth.html#cb30-173" tabindex="-1"></a>    <span class="fu">bump</span>()</span>
<span id="cb30-174"><a href="workbook-week-3-models-and-growth.html#cb30-174" tabindex="-1"></a>    <span class="fu">simulate_badyears</span>(</span>
<span id="cb30-175"><a href="workbook-week-3-models-and-growth.html#cb30-175" tabindex="-1"></a>      <span class="at">P0 =</span> P0_fix,            <span class="co"># &lt;-- P0 fixed here</span></span>
<span id="cb30-176"><a href="workbook-week-3-models-and-growth.html#cb30-176" tabindex="-1"></a>      <span class="at">r  =</span> r_fix,</span>
<span id="cb30-177"><a href="workbook-week-3-models-and-growth.html#cb30-177" tabindex="-1"></a>      <span class="at">K  =</span> K_fix,</span>
<span id="cb30-178"><a href="workbook-week-3-models-and-growth.html#cb30-178" tabindex="-1"></a>      <span class="at">H  =</span> input<span class="sc">$</span>H,</span>
<span id="cb30-179"><a href="workbook-week-3-models-and-growth.html#cb30-179" tabindex="-1"></a>      <span class="at">years =</span> input<span class="sc">$</span>years,</span>
<span id="cb30-180"><a href="workbook-week-3-models-and-growth.html#cb30-180" tabindex="-1"></a>      <span class="at">dt =</span> <span class="fl">0.1</span>,</span>
<span id="cb30-181"><a href="workbook-week-3-models-and-growth.html#cb30-181" tabindex="-1"></a>      <span class="at">year0 =</span> <span class="fu">min</span>(cod<span class="sc">$</span>Year),</span>
<span id="cb30-182"><a href="workbook-week-3-models-and-growth.html#cb30-182" tabindex="-1"></a>      <span class="at">by_p =</span> input<span class="sc">$</span>by_p,</span>
<span id="cb30-183"><a href="workbook-week-3-models-and-growth.html#cb30-183" tabindex="-1"></a>      <span class="at">bad_factor =</span> input<span class="sc">$</span>bad_factor,</span>
<span id="cb30-184"><a href="workbook-week-3-models-and-growth.html#cb30-184" tabindex="-1"></a>      <span class="at">seed =</span> input<span class="sc">$</span>seed,</span>
<span id="cb30-185"><a href="workbook-week-3-models-and-growth.html#cb30-185" tabindex="-1"></a>      <span class="at">clip_nonneg =</span> <span class="cn">TRUE</span></span>
<span id="cb30-186"><a href="workbook-week-3-models-and-growth.html#cb30-186" tabindex="-1"></a>    )</span>
<span id="cb30-187"><a href="workbook-week-3-models-and-growth.html#cb30-187" tabindex="-1"></a>  })</span>
<span id="cb30-188"><a href="workbook-week-3-models-and-growth.html#cb30-188" tabindex="-1"></a></span>
<span id="cb30-189"><a href="workbook-week-3-models-and-growth.html#cb30-189" tabindex="-1"></a>  output<span class="sc">$</span>popplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb30-190"><a href="workbook-week-3-models-and-growth.html#cb30-190" tabindex="-1"></a>    df_sim <span class="ot">&lt;-</span> <span class="fu">sim_df</span>()</span>
<span id="cb30-191"><a href="workbook-week-3-models-and-growth.html#cb30-191" tabindex="-1"></a></span>
<span id="cb30-192"><a href="workbook-week-3-models-and-growth.html#cb30-192" tabindex="-1"></a>    <span class="co"># Baseline (H=0) best-fit over observed years (for reference)</span></span>
<span id="cb30-193"><a href="workbook-week-3-models-and-growth.html#cb30-193" tabindex="-1"></a>    grid_fit <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Year =</span> <span class="fu">seq</span>(<span class="fu">min</span>(cod<span class="sc">$</span>Year), <span class="fu">max</span>(cod<span class="sc">$</span>Year), <span class="at">length.out =</span> <span class="dv">400</span>)) <span class="sc">|&gt;</span></span>
<span id="cb30-194"><a href="workbook-week-3-models-and-growth.html#cb30-194" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">t =</span> Year <span class="sc">-</span> <span class="fu">min</span>(cod<span class="sc">$</span>Year),</span>
<span id="cb30-195"><a href="workbook-week-3-models-and-growth.html#cb30-195" tabindex="-1"></a>             <span class="at">Pop_fit =</span> <span class="fu">logistic_fun</span>(t, K_fix, A_fix, r_fix))</span>
<span id="cb30-196"><a href="workbook-week-3-models-and-growth.html#cb30-196" tabindex="-1"></a></span>
<span id="cb30-197"><a href="workbook-week-3-models-and-growth.html#cb30-197" tabindex="-1"></a>    <span class="co"># MSY numbers for subtitle</span></span>
<span id="cb30-198"><a href="workbook-week-3-models-and-growth.html#cb30-198" tabindex="-1"></a>    Hmsy_base <span class="ot">&lt;-</span> r_fix <span class="sc">*</span> K_fix <span class="sc">/</span> <span class="dv">4</span></span>
<span id="cb30-199"><a href="workbook-week-3-models-and-growth.html#cb30-199" tabindex="-1"></a>    Hmsy_bad  <span class="ot">&lt;-</span> input<span class="sc">$</span>bad_factor <span class="sc">*</span> r_fix <span class="sc">*</span> K_fix <span class="sc">/</span> <span class="dv">4</span></span>
<span id="cb30-200"><a href="workbook-week-3-models-and-growth.html#cb30-200" tabindex="-1"></a></span>
<span id="cb30-201"><a href="workbook-week-3-models-and-growth.html#cb30-201" tabindex="-1"></a>    <span class="co"># Rectangles marking bad years in the simulation</span></span>
<span id="cb30-202"><a href="workbook-week-3-models-and-growth.html#cb30-202" tabindex="-1"></a>    bad_years <span class="ot">&lt;-</span> df_sim <span class="sc">|&gt;</span></span>
<span id="cb30-203"><a href="workbook-week-3-models-and-growth.html#cb30-203" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">y0 =</span> <span class="fu">floor</span>(time)) <span class="sc">|&gt;</span></span>
<span id="cb30-204"><a href="workbook-week-3-models-and-growth.html#cb30-204" tabindex="-1"></a>      <span class="fu">group_by</span>(y0) <span class="sc">|&gt;</span></span>
<span id="cb30-205"><a href="workbook-week-3-models-and-growth.html#cb30-205" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">is_bad =</span> <span class="fu">any</span>(bad_year), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-206"><a href="workbook-week-3-models-and-growth.html#cb30-206" tabindex="-1"></a>      <span class="fu">filter</span>(is_bad) <span class="sc">|&gt;</span></span>
<span id="cb30-207"><a href="workbook-week-3-models-and-growth.html#cb30-207" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">xmin =</span> <span class="fu">min</span>(cod<span class="sc">$</span>Year) <span class="sc">+</span> y0,</span>
<span id="cb30-208"><a href="workbook-week-3-models-and-growth.html#cb30-208" tabindex="-1"></a>             <span class="at">xmax =</span> xmin <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb30-209"><a href="workbook-week-3-models-and-growth.html#cb30-209" tabindex="-1"></a></span>
<span id="cb30-210"><a href="workbook-week-3-models-and-growth.html#cb30-210" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-211"><a href="workbook-week-3-models-and-growth.html#cb30-211" tabindex="-1"></a>      { <span class="cf">if</span> (<span class="fu">nrow</span>(bad_years) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb30-212"><a href="workbook-week-3-models-and-growth.html#cb30-212" tabindex="-1"></a>        <span class="fu">geom_rect</span>(<span class="at">data =</span> bad_years,</span>
<span id="cb30-213"><a href="workbook-week-3-models-and-growth.html#cb30-213" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>),</span>
<span id="cb30-214"><a href="workbook-week-3-models-and-growth.html#cb30-214" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.08</span>) } <span class="sc">+</span></span>
<span id="cb30-215"><a href="workbook-week-3-models-and-growth.html#cb30-215" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">data =</span> cod, <span class="fu">aes</span>(Year, Pop), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb30-216"><a href="workbook-week-3-models-and-growth.html#cb30-216" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> cod, <span class="fu">aes</span>(Year, Pop), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb30-217"><a href="workbook-week-3-models-and-growth.html#cb30-217" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> grid_fit, <span class="fu">aes</span>(Year, Pop_fit),</span>
<span id="cb30-218"><a href="workbook-week-3-models-and-growth.html#cb30-218" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey40&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-219"><a href="workbook-week-3-models-and-growth.html#cb30-219" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> df_sim, <span class="fu">aes</span>(Year, Pop),</span>
<span id="cb30-220"><a href="workbook-week-3-models-and-growth.html#cb30-220" tabindex="-1"></a>                <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">&quot;#0072B2&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-221"><a href="workbook-week-3-models-and-growth.html#cb30-221" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb30-222"><a href="workbook-week-3-models-and-growth.html#cb30-222" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Logistic Growth with Harvesting and Bad-Year Shocks to r (P₀ fixed)&quot;</span>,</span>
<span id="cb30-223"><a href="workbook-week-3-models-and-growth.html#cb30-223" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb30-224"><a href="workbook-week-3-models-and-growth.html#cb30-224" tabindex="-1"></a>          <span class="st">&quot;H = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>H, <span class="dv">3</span>),</span>
<span id="cb30-225"><a href="workbook-week-3-models-and-growth.html#cb30-225" tabindex="-1"></a>          <span class="st">&quot; | MSY baseline = &quot;</span>, <span class="fu">signif</span>(Hmsy_base, <span class="dv">3</span>),</span>
<span id="cb30-226"><a href="workbook-week-3-models-and-growth.html#cb30-226" tabindex="-1"></a>          <span class="st">&quot;, MSY in bad year = &quot;</span>, <span class="fu">signif</span>(Hmsy_bad, <span class="dv">3</span>),</span>
<span id="cb30-227"><a href="workbook-week-3-models-and-growth.html#cb30-227" tabindex="-1"></a>          <span class="st">&quot; | p(bad year) = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>by_p, <span class="dv">3</span>),</span>
<span id="cb30-228"><a href="workbook-week-3-models-and-growth.html#cb30-228" tabindex="-1"></a>          <span class="st">&quot;, factor = &quot;</span>, <span class="fu">signif</span>(input<span class="sc">$</span>bad_factor, <span class="dv">3</span>)</span>
<span id="cb30-229"><a href="workbook-week-3-models-and-growth.html#cb30-229" tabindex="-1"></a>        ),</span>
<span id="cb30-230"><a href="workbook-week-3-models-and-growth.html#cb30-230" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Population (units)&quot;</span></span>
<span id="cb30-231"><a href="workbook-week-3-models-and-growth.html#cb30-231" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb30-232"><a href="workbook-week-3-models-and-growth.html#cb30-232" tabindex="-1"></a>      <span class="fu">theme_classic</span>()</span>
<span id="cb30-233"><a href="workbook-week-3-models-and-growth.html#cb30-233" tabindex="-1"></a>  })</span>
<span id="cb30-234"><a href="workbook-week-3-models-and-growth.html#cb30-234" tabindex="-1"></a></span>
<span id="cb30-235"><a href="workbook-week-3-models-and-growth.html#cb30-235" tabindex="-1"></a>  output<span class="sc">$</span>rplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb30-236"><a href="workbook-week-3-models-and-growth.html#cb30-236" tabindex="-1"></a>    df_sim <span class="ot">&lt;-</span> <span class="fu">sim_df</span>()</span>
<span id="cb30-237"><a href="workbook-week-3-models-and-growth.html#cb30-237" tabindex="-1"></a></span>
<span id="cb30-238"><a href="workbook-week-3-models-and-growth.html#cb30-238" tabindex="-1"></a>    <span class="co"># Build yearly shading again for alignment</span></span>
<span id="cb30-239"><a href="workbook-week-3-models-and-growth.html#cb30-239" tabindex="-1"></a>    bad_years <span class="ot">&lt;-</span> df_sim <span class="sc">|&gt;</span></span>
<span id="cb30-240"><a href="workbook-week-3-models-and-growth.html#cb30-240" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">y0 =</span> <span class="fu">floor</span>(time)) <span class="sc">|&gt;</span></span>
<span id="cb30-241"><a href="workbook-week-3-models-and-growth.html#cb30-241" tabindex="-1"></a>      <span class="fu">group_by</span>(y0) <span class="sc">|&gt;</span></span>
<span id="cb30-242"><a href="workbook-week-3-models-and-growth.html#cb30-242" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">is_bad =</span> <span class="fu">any</span>(bad_year), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-243"><a href="workbook-week-3-models-and-growth.html#cb30-243" tabindex="-1"></a>      <span class="fu">filter</span>(is_bad) <span class="sc">|&gt;</span></span>
<span id="cb30-244"><a href="workbook-week-3-models-and-growth.html#cb30-244" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">xmin =</span> <span class="fu">min</span>(cod<span class="sc">$</span>Year) <span class="sc">+</span> y0,</span>
<span id="cb30-245"><a href="workbook-week-3-models-and-growth.html#cb30-245" tabindex="-1"></a>             <span class="at">xmax =</span> xmin <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb30-246"><a href="workbook-week-3-models-and-growth.html#cb30-246" tabindex="-1"></a></span>
<span id="cb30-247"><a href="workbook-week-3-models-and-growth.html#cb30-247" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-248"><a href="workbook-week-3-models-and-growth.html#cb30-248" tabindex="-1"></a>      { <span class="cf">if</span> (<span class="fu">nrow</span>(bad_years) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb30-249"><a href="workbook-week-3-models-and-growth.html#cb30-249" tabindex="-1"></a>        <span class="fu">geom_rect</span>(<span class="at">data =</span> bad_years,</span>
<span id="cb30-250"><a href="workbook-week-3-models-and-growth.html#cb30-250" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>),</span>
<span id="cb30-251"><a href="workbook-week-3-models-and-growth.html#cb30-251" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.08</span>) } <span class="sc">+</span></span>
<span id="cb30-252"><a href="workbook-week-3-models-and-growth.html#cb30-252" tabindex="-1"></a>      <span class="fu">geom_step</span>(<span class="at">data =</span> df_sim, <span class="fu">aes</span>(Year, r_eff), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-253"><a href="workbook-week-3-models-and-growth.html#cb30-253" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> r_fix, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey40&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-254"><a href="workbook-week-3-models-and-growth.html#cb30-254" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> r_fix <span class="sc">*</span> input<span class="sc">$</span>bad_factor,</span>
<span id="cb30-255"><a href="workbook-week-3-models-and-growth.html#cb30-255" tabindex="-1"></a>                 <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-256"><a href="workbook-week-3-models-and-growth.html#cb30-256" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb30-257"><a href="workbook-week-3-models-and-growth.html#cb30-257" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Effective Growth Rate r_eff(t) (bad years scale r)&quot;</span>,</span>
<span id="cb30-258"><a href="workbook-week-3-models-and-growth.html#cb30-258" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb30-259"><a href="workbook-week-3-models-and-growth.html#cb30-259" tabindex="-1"></a>          <span class="st">&quot;Baseline r = &quot;</span>, <span class="fu">signif</span>(r_fix, <span class="dv">3</span>),</span>
<span id="cb30-260"><a href="workbook-week-3-models-and-growth.html#cb30-260" tabindex="-1"></a>          <span class="st">&quot; | Bad-year r = &quot;</span>, <span class="fu">signif</span>(r_fix <span class="sc">*</span> input<span class="sc">$</span>bad_factor, <span class="dv">3</span>)</span>
<span id="cb30-261"><a href="workbook-week-3-models-and-growth.html#cb30-261" tabindex="-1"></a>        ),</span>
<span id="cb30-262"><a href="workbook-week-3-models-and-growth.html#cb30-262" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;r_eff(t)&quot;</span></span>
<span id="cb30-263"><a href="workbook-week-3-models-and-growth.html#cb30-263" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb30-264"><a href="workbook-week-3-models-and-growth.html#cb30-264" tabindex="-1"></a>      <span class="fu">theme_classic</span>()</span>
<span id="cb30-265"><a href="workbook-week-3-models-and-growth.html#cb30-265" tabindex="-1"></a>  })</span>
<span id="cb30-266"><a href="workbook-week-3-models-and-growth.html#cb30-266" tabindex="-1"></a>}</span>
<span id="cb30-267"><a href="workbook-week-3-models-and-growth.html#cb30-267" tabindex="-1"></a></span>
<span id="cb30-268"><a href="workbook-week-3-models-and-growth.html#cb30-268" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
</div>
</div>
<div id="understanding-the-central-limit-theorem" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">D.7</span> Understanding the Central Limit Theorem<a href="workbook-week-3-models-and-growth.html#understanding-the-central-limit-theorem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="why-we-care" class="section level3 hasAnchor" number="9.7.1">
<h3><span class="header-section-number">D.7.1</span> Why We Care<a href="workbook-week-3-models-and-growth.html#why-we-care" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we collect data from nature, every measurement comes with randomness — rainfall changes day to day, fish populations fluctuate, and even repeated measurements of the same thing vary slightly.<br />
Yet when we look at <em>averages</em> of these random events, a remarkable pattern emerges: those averages tend to form a <strong>bell-shaped (normal) distribution</strong>.</p>
<p>This is the essence of the <strong>Central Limit Theorem (CLT)</strong> — one of the most important results in statistics.</p>
<hr />
</div>
<div id="start-with-a-simple-example" class="section level3 hasAnchor" number="9.7.2">
<h3><span class="header-section-number">D.7.2</span> Start with a Simple Example<a href="workbook-week-3-models-and-growth.html#start-with-a-simple-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the <strong>coin-flip app</strong>, you flipped coins and recorded the proportion of Heads in each experiment.</p>
<ul>
<li>Each individual flip is <strong>unpredictable</strong> — 50% chance of Heads, 50% chance of Tails.<br />
</li>
<li>But when you flip <strong>many coins at once</strong> and record the proportion of Heads, those proportions cluster near 0.5.<br />
</li>
<li>When you repeat that whole experiment many times, and make a histogram of those proportions, the shape looks surprisingly smooth and <strong>bell-like</strong>.</li>
</ul>
<p>That bell shape <strong>isn’t built into the coin</strong> — it comes from the <em>averaging process itself.</em></p>
<hr />
</div>
<div id="the-central-limit-theorem-plain-language-version" class="section level3 hasAnchor" number="9.7.3">
<h3><span class="header-section-number">D.7.3</span> The Central Limit Theorem (Plain-Language Version)<a href="workbook-week-3-models-and-growth.html#the-central-limit-theorem-plain-language-version" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>When we take many random samples from any population and compute the <strong>mean</strong> (or <strong>proportion</strong>) for each sample,<br />
the <strong>distribution of those sample means</strong> will approximate a <strong>normal distribution</strong>,<br />
as long as our samples are large enough.</p>
</blockquote>
<p>In symbols:
<span class="math display">\[
\bar{X} = \frac{1}{n}\sum_{i=1}^{n} X_i \quad \text{is approximately } N\left(\mu, \frac{\sigma^2}{n}\right)
\]</span>
where:</p>
<ul>
<li><span class="math inline">\(\mu\)</span> = population mean<br />
</li>
<li><span class="math inline">\(\sigma^2\)</span> = population variance<br />
</li>
<li><span class="math inline">\(n\)</span> = sample size</li>
</ul>
<hr />
</div>
<div id="why-it-happens" class="section level3 hasAnchor" number="9.7.4">
<h3><span class="header-section-number">D.7.4</span> Why It Happens<a href="workbook-week-3-models-and-growth.html#why-it-happens" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Each sample mean is like an average of many small random influences:</p>
<ul>
<li>Some pushes are high, some are low.</li>
<li>When you add them up, <strong>extremes cancel out</strong>.</li>
<li>What remains is the overall trend — most results fall near the middle.</li>
</ul>
<p>This “balancing of randomness” is what makes the sampling distribution of averages look normal, even when the original data aren’t.</p>
<hr />
</div>
<div id="what-you-saw-in-the-app" class="section level3 hasAnchor" number="9.7.5">
<h3><span class="header-section-number">D.7.5</span> What You Saw in the App<a href="workbook-week-3-models-and-growth.html#what-you-saw-in-the-app" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<thead>
<tr class="header">
<th>Sample Size (n)</th>
<th>Shape of Sampling Distribution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Still two spikes: Heads vs. Tails</td>
</tr>
<tr class="even">
<td>5</td>
<td>Somewhat bumpy, but already more centered</td>
</tr>
<tr class="odd">
<td>30</td>
<td>Nearly a perfect bell curve</td>
</tr>
</tbody>
</table>
<p>Notice two things:</p>
<ol style="list-style-type: decimal">
<li><strong>The mean stays around 0.5</strong>, no matter how many coins you flip.<br />
</li>
<li><strong>The spread gets smaller</strong> as <span class="math inline">\(n\)</span> increases — large samples give more stable averages.</li>
</ol>
<p>That shrinking spread follows the rule:
<span class="math display">\[
\text{Spread of sample mean} = \frac{\text{Population spread}}{\sqrt{n}}
\]</span>
so each time you multiply <span class="math inline">\(n\)</span> by 4, the variation in your averages is cut in half.</p>
<hr />
</div>
<div id="real-world-meaning" class="section level3 hasAnchor" number="9.7.6">
<h3><span class="header-section-number">D.7.6</span> Real-World Meaning<a href="workbook-week-3-models-and-growth.html#real-world-meaning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The CLT explains why we can trust statistics based on averages — like:</p>
<ul>
<li>Mean temperature across many days<br />
</li>
<li>Average fish biomass in repeated surveys<br />
</li>
<li>Mean exam score across students</li>
</ul>
<p>Even if individual observations are noisy, <strong>averages behave predictably</strong>.</p>
<p>That’s why the normal distribution shows up everywhere in science: height, rainfall, errors, growth rates, and countless other measurements are all the result of <strong>many small, random effects</strong> added together.</p>
<hr />
</div>
<div id="key-takeaways" class="section level3 hasAnchor" number="9.7.7">
<h3><span class="header-section-number">D.7.7</span> Key Takeaways<a href="workbook-week-3-models-and-growth.html#key-takeaways" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Individual outcomes can be messy; averages are stable.<br />
</li>
<li>The CLT connects <em>randomness</em> to <em>predictability</em>.<br />
</li>
<li>As sample size increases:
<ul>
<li>The distribution of sample means becomes more normal.</li>
<li>The spread of sample means becomes narrower.</li>
</ul></li>
<li>This is why the normal curve is the foundation of statistical inference.</li>
</ul>
<hr />
</div>
<div id="quick-reflection" class="section level3 hasAnchor" number="9.7.8">
<h3><span class="header-section-number">D.7.8</span> Quick Reflection<a href="workbook-week-3-models-and-growth.html#quick-reflection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Try answering these after exploring the app:</p>
<ol style="list-style-type: decimal">
<li>What changed when you increased the sample size in your simulation?<br />
</li>
<li>Why does the histogram of sample proportions become smoother as <span class="math inline">\(n\)</span> grows?<br />
</li>
<li>Can you think of an environmental process where we rely on averages to make predictions?</li>
</ol>
<hr />
</div>
<div id="in-a-sentence" class="section level3 hasAnchor" number="9.7.9">
<h3><span class="header-section-number">D.7.9</span> 🧠 In a Sentence<a href="#in-a-sentence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>The Central Limit Theorem is the reason that when we collect enough data — even from a chaotic world — the averages we compute begin to look beautifully predictable.</p>
</blockquote>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="workbook-week-2-llms.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="prob-workbook.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/rstudio/bookdown-demo/edit/master/103wb-Pop_dyn.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
